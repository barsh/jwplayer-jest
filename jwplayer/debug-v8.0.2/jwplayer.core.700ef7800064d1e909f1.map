{"version":3,"sources":["webpack:///./src/js/controller/controller.js","webpack:///./src/js/utils/ui.js","webpack:///./src/js/parsers/captions/srt.js","webpack:///./src/js/events/change-state-event.js","webpack:///./src/js/controller/model.js","webpack:///./src/js/utils/request-animation-frame.js","webpack:///./src/js/view/utils/breakpoint.js","webpack:///./node_modules/css-loader/lib/css-base.js","webpack:///./src/js/utils/cancelable.js","webpack:///./src/js/utils/active-tab.js","webpack:///./src/js/controller/tracks-loader.js","webpack:///./src/js/controller/tracks-helper.js","webpack:///./src/js/parsers/captions/vttcue.js","webpack:///./src/js/parsers/captions/dfxp.js","webpack:///./src/js/api/set-config.js","webpack:///./src/js/controller/instream-adapter.js","webpack:///./src/js/controller/instream-html5.js","webpack:///./src/js/controller/qoe.js","webpack:///./src/js/controller/instream-flash.js","webpack:///./src/js/controller/captions.js","webpack:///./src/js/view/view.js","webpack:///./src/templates/player.js","webpack:///./src/js/view/utils/audio-mode.js","webpack:///./src/js/view/utils/views-manager.js","webpack:///./src/js/view/utils/visibility.js","webpack:///./src/js/view/utils/skin.js","webpack:///./src/js/view/utils/request-fullscreen-helper.js","webpack:///./src/js/view/utils/flag-no-focus.js","webpack:///./src/js/view/utils/clickhandler.js","webpack:///./src/js/view/captionsrenderer.js","webpack:///./src/js/view/logo.js","webpack:///./src/templates/logo.js","webpack:///./src/js/view/preview.js","webpack:///./src/js/view/title.js","webpack:///./src/css/jwplayer.less?586a","webpack:///./src/css/jwplayer.less","webpack:///./src/js/controller/events-middleware.js","webpack:///./src/js/providers/utils/stream-type.js"],"names":["normalizeState","newstate","Controller","prototype","setup","config","_api","originalContainer","eventListeners","commandQueue","_this","_model","_view","_captions","_preplay","_actionOnAttach","_stopPlaylist","_interruptPlay","checkAutoStartCancelable","_checkAutoStart","updatePlaylistCancelable","currentContainer","_events","_eventQueuedUntilReady","on","_triggerAfterReady","mediaController","then","_completeHandler","triggerError","model","isBlocked","set","undefined","throttled","get","errorEvent","message","trigger","duration","minDvrWindow","type","setStreamType","evt","bool","fullscreen","vol","volume","mute","rate","playbackRate","position","state","_pause","_play","reason","captionsList","triggerAfterReady","tracks","track","mediaModel","change","_video","getVideo","e","triggerControls","enable","controls","viewSetup","element","playerReady","related","getPlugin","nextUp","once","_playerReadyNotify","init","_updateViewable","setupTime","playlist","length","eventData","feedData","eventFeedData","playlistItem","index","item","i","event","args","viewableChange","_checkPlayOnViewable","off","visibility","isUndefined","Math","round","apiQueue","mobile","_autoStart","flush","viewable","preloadVideo","pause","push","_load","_stop","cancel","_primeMediaElementForPlayback","loadPromise","loadPlaylistPromise","_loadPlaylist","catch","error","data","_updatePlaylist","async","_setItem","reject","toLoad","resolve","loader","load","_getAdState","_instreamAdapter","getState","_getState","adState","isString","meta","playReason","_getReason","pauseAd","playVideo","_inInteraction","window","test","mediaElement","src","internal","empty","fromApi","provider","stopVideo","pauseReason","_isIdle","_seek","pos","seek","_item","setItemIndex","_prev","_next","idx","iOS","_setFullscreen","triggerAdvanceEvent","_setCurrentQuality","parseInt","setCurrentQuality","_getCurrentQuality","getCurrentQuality","_getConfig","getConfiguration","_getVisualQuality","qualityLevels","_getQualityLevels","levelIndex","level","mode","getQualityLevels","_setCurrentAudioTrack","setCurrentAudioTrack","_getCurrentAudioTrack","getCurrentAudioTrack","_getAudioTracks","getAudioTracks","_setCurrentCaptions","persistVideoSubtitleTrack","_getCaptionsList","_getCurrentCaptions","getCurrentIndex","getCaptionsList","_detachMedia","detachMedia","_attachMedia","attachMedia","isBoolean","_adModel","_nextUp","next","cb","ui","target","itemsShown","play","stop","playlistNext","playlistPrev","setCurrentCaptions","setFullscreen","getCurrentCaptions","getVisualQuality","getConfig","setConfig","newConfig","setVolume","bind","setMute","setPlaybackRate","getProvider","getWidth","getHeight","getItemQoe","_qoeItem","isBeforeComplete","checkComplete","addButton","img","tooltip","callback","id","btnClass","customButtons","added","newButton","reduce","buttons","button","unshift","removeButton","filter","call","resize","getSafeRegion","setCues","addCues","setCaptions","checkBeforePlay","setControls","playerDestroy","destroy","instreamDestroy","isBeforePlay","createInstream","skipAd","queue","apply","property","getContainer","getMute","_supportsPointerEvents","android","_supportsTouchEvents","_useMouseEvents","_isOSXFirefox","firefox","mac","getCoord","c","originalEvent","changedTouches","isRightClick","MouseEvent","which","isEnterKey","KeyboardEvent","keyCode","stopPropagation","normalizeUIEvent","srcEvent","source","touches","sourceEvent","currentTarget","pageX","pageY","preventDefault","TouchEvent","preventManipulation","UI","elem","options","_elem","_hasMoved","_startX","_startY","_lastClickTime","_doubleClickDelay","_touchListenerTarget","_pointerId","addEventListener","interactStartHandler","useHover","overHandler","outHandler","useMove","moveHandler","keyHandler","useFocus","pointerType","triggerEvent","contains","document","elementFromPoint","x","y","setEventListener","eventName","removeEventListener","isPrimary","preventScrolling","pointerId","setPointerCapture","interactDragHandler","interactEndHandler","nodeName","toLowerCase","movementThreshold","endX","endY","moveX","moveY","isPointerEvent","releasePointerCapture","directSelect","indexOf","self","enableDoubleTap","doubleType","getPointerType","PointerEvent","Srt","list","split","entry","_entry","text","array","line","begin","substr","end","slice","join","ChangeStateEvent","normalizeApiState","oldstate","eventType","replace","Model","_providers","_provider","_beforecompleted","_attached","thenPlayPromise","providerPromise","MediaModel","attributes","updateProviders","setAutoStart","clone","_videoEventHandler","mediaType","srcReset","previousState","bufferPercent","isNumber","isNaN","metadata","getName","setQualityLevel","currentQuality","levels","persistQualityLevel","playbackComplete","currentTrack","quality","currentLevel","label","onMediaContainer","container","setContainer","changeVideoProvider","Provider","remove","instreamMode","resetProvider","name","isAndroidSdk","autoStartOnMobile","getPlaybackRate","renderNatively","setState","_destroyed","chooseProvider","choose","setActiveItem","resetItem","setProvider","starttime","mediaModelState","sources","Error","replaceMediaElement","mediaModelContext","syncPlayerWithMediaModel","lastMediaElement","muted","getProviders","max","streamType","min","loadAndPlay","playWithProvider","providerSetupPromise","playAttempt","playPromise","itemContext","videoTagUnpaused","video","paused","videoTagPaused","mediaState","preload","persistCaptionsTrack","setVideoSubtitleTrack","trackIndex","setSubtitlesTrack","_autoStartSupportedIOS","version","major","platformCanAutostart","autostartAdsIsEnabled","autoplayadsmuted","iosBrowserIsSupported","safari","chrome","facebook","androidBrowserIsSupported","mobileBrowserIsSupported","autoStart","started","preloaded","visualQuality","requestAnimationFrame","setTimeout","cancelAnimationFrame","clearTimeout","getBreakpoint","setBreakpoint","width","breakpoint","playerElement","breakpointNumber","breakpointClass","cancelable","cancelled","arguments","hidden","webkitHidden","loadFile","cancelXhr","convertToVTTCues","successHandler","errorHandler","xhr","ajax","file","xhrSuccess","forEach","onload","onreadystatechange","onerror","abort","cues","map","cue","xmlRoot","responseXML","firstChild","vttCues","nextSibling","nodeType","COMMENT_NODE","responseText","loadVttParser","parser","VTTParser","oncue","onflush","parse","require","default","createId","createLabel","tracksCount","trackId","prefix","kind","defaulttrack","_id","unknownCount","language","VTTCue","findDirectionSetting","value","directionSetting","lr","rl","dir","findAlignSetting","alignSetting","start","middle","left","right","align","autoKeyword","startTime","endTime","hasBeenReset","_pauseOnExit","_startTime","_endTime","_text","_region","_vertical","_snapToLines","_line","_lineAlign","_position","_size","_align","Object","defineProperty","enumerable","TypeError","setting","SyntaxError","displayState","getCueAsHTML","WebVTT","convertCueToDOMTree","Dfxp","xmlDoc","validate","paragraphs","getElementsByTagName","frameRate","tt","parsedFrameRate","parseFloat","getAttribute","p","breaks","j","b","parentNode","replaceChild","createTextNode","rawText","innerHTML","textContent","dur","parseError","object","supportedFields","controller","size","newValue","field","chooseInstreamMethod","providerName","_defaultOptions","skipoffset","tag","InstreamAdapter","_controller","InstreamMethod","_instream","_array","_arrayOptions","_arrayIndex","_options","_oldpos","_olditem","_skipAd","_instreamItemNext","_clickHandler","hasControls","instreamPlay","instreamPause","_doubleClickHandler","sharedVideoTag","_instreamForward","_instreamTime","_instreamItemComplete","defaultPlaybackRate","setupInstream","clickHandler","setAlternateClickHandlers","noop","setText","loadingAd","_loadNextItem","loadItem","minor","isArray","adModel","addClickHandler","setupSkipButton","customNext","skipMessage","skipText","applyProviderListeners","metaHandler","skipAdType","height","resizeMedia","replacePlaylistItem","revertAlternateClickHandlers","destroyInstream","setAltText","hide","InstreamHtml5","_currentProvider","playerAttributes","edition","mediaContext","mediaSrc","autostartMuted","autostart","advertising","sdkplatform","skipButton","_nativeFullscreenHandler","_checkProvider","srcChanged","pseudoProvider","isVpaidProvider","adMediaModelContext","changeAdModel","stateHandler","jwstate","TAB_HIDDEN","TAB_VISIBLE","onTimeIncreasesGenerator","lastVal","unbindFirstFrameEvents","_onPlayAttempt","_triggerFirstFrame","_onTime","_onTabVisible","trackFirstFrame","qoeItem","tick","time","getFirstFrame","loadTime","modelChanged","activeTab","initQoe","initialModel","onMediaModel","oldMediaModel","between","timeActive","changeMediaModel","InstreamFlash","swf","querySelector","_throttleTimeout","_throttlePaused","triggerFlash","Captions","_itemHandler","_captionsIndexHandler","_itemReadyHandler","_subtitlesTracksHandler","_addTrack","_tracks","keys","_tracksById","captionsMenu","_captionsMenu","_selectDefaultIndex","setCaptionsList","_unknownCount","len","_kindSupported","_addVTTCuesToTrack","captionsMenuIndex","labelInfo","autoselect","_setCurrentIndex","ControlsLoader","ControlsModule","_isMobile","_isIE","ie","View","isSetup","api","containerWidth","containerHeight","mediaContainer","inDom","iFrame","intersectionRatio","audioMode","touchMode","altText","castClicked","scrubbing","logoWidth","_playerElement","player","_videoLayer","_preview","_title","_captionsRenderer","_logo","_playerState","_lastWidth","_lastHeight","_instreamModel","_resizeMediaTimeout","_resizeContainerRequestId","_stateClassRequestId","displayClickHandler","fullscreenHelpers","focusHelper","_breakpoint","_controls","reasonInteraction","updateBounds","inDOM","body","rect","_responsiveListener","observe","updateStyles","updateContainerStyles","_resizeMedia","checkResized","_responsiveUpdate","smallPlayer","_logoClickHandler","insertBefore","clickHandlerHelper","_fullscreenChangeHandler","_errorHandler","val","_onMediaTypeChange","onStretchChange","onFlashBlockedChange","_resizePlayer","onAspectRatioChange","skin","skinColors","iframe","add","updateVisibility","_fullscreen","redraw","_stateHandler","changeControls","setMediaTitleAttribute","module","Controls","addControls","removeControls","videotag","dummyDiv","createElement","title","setAttribute","lastVisibility","videoLayer","click","settingsMenuVisible","settingsMenu","close","playToggle","tap","renderCues","showing","userActive","userInactive","doubleClick","move","over","newVal","aspectratio","aspectRatioContainer","paddingTop","link","open","linktarget","_onChangeControls","_setLiveMode","addActiveListeners","logoContainer","overlaysElement","_userActivityCallback","removeActiveListeners","disable","overlay","unmuteAutoplay","supportsDomFullscreen","requestFullscreen","exitFullscreen","_toggleDOMFullscreen","playerWidth","playerHeight","resetAspectMode","widthSet","heightSet","playerStyle","transformScale","_isNativeFullscreen","fsElement","fullscreenElement","getFullScreen","modelState","newState","fullscreenState","overflowY","live","isAudioFile","isFlash","el","errorContainer","cloneIcon","appendChild","oldState","instreamStateUpdate","removeChild","_stateUpdate","instreamState","setPosterImage","show","setImage","image","visible","instreamModel","controlsContainer","excludeControlbar","safeRegion","controlbarHeight","captionsStyle","clear","unobserve","ariaLabel","CONTROLBAR_ONLY_HEIGHT","isAudioMode","verticalPixels","NaN","views","observed","intersectionObserver","responsiveRepaintRequestId","lazyInitIntersectionObserver","IntersectionObserver","entries","view","threshold","scheduleResponsiveRedraw","responsiveRepaint","onVisibilityChange","splice","getIntersectionObserver","getVisibility","computeVisibility","html","documentElement","rootRect","top","clientWidth","bottom","clientHeight","getComputedStyle","display","targetRect","getBoundingClientRect","intersectionRect","parent","atRoot","parentRect","overflow","computeRectIntersection","targetArea","intersectionArea","rect1","rect2","normalizeSkin","handleColorOverrides","skinConfig","active","inactive","background","colors","controlbar","getControlBar","timeslider","getTimeSlider","menus","getMenus","tooltips","getTooltips","controlBarConfig","iconsActive","icons","timesliderConfig","progress","rail","menusConfig","textActive","tooltipsConfig","playerId","addStyle","elements","attr","extendParent","o","styleControlbar","styleTimeslider","styleMenus","styleTooltips","insertGlobalColorClasses","activeColorSet","color","borderColor","stroke","inactiveColorSet","elementContext","documentContext","changeCallback","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen","webkitExitFullscreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen","DOCUMENT_FULLSCREEN_EVENTS","events","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement","_focusFromClick","onBlur","onMouseDown","onFocus","ClickHandler","domElement","defaultOptions","alternateDoubleClickHandler","out","alternateClickHandler","doubleClickHandler","_WebVTT","_defaults","back","backgroundOpacity","edgeStyle","fontSize","fontOpacity","fontScale","preprocessor","identity","windowOpacity","CaptionsRenderer","_captionsTrack","_currentCues","_timeEvent","_display","_captionsWindow","_textContainer","_fontScale","_windowStyle","className","populate","captions","selectCues","_setFontSize","updateBoxPosition","processCues","timeEvent","getAlignmentPosition","getCurrentCues","updateCurrentCues","allCues","difference","playerElementId","_setFontScale","windowColor","textStyle","_addTextStyle","backgroundColor","_addEdgeStyle","_setupCaptionStyles","isFinite","_setShadowDOMFontSize","_styleNativeCaptions","_stylePlayerCaptions","bgColor","bgOpacity","fontFamily","fontStyle","fontWeight","textDecoration","option","styles","textShadow","_timeChange","_captionsListHandler","loadWebVttPolyfill","captionsTrack","Logo","LogoDefaults","margin","_settings","_img","Image","toString","backgroundImage","positions","exec","maxHeight","maxWidth","logoAR","videoAR","logoInteractHandler","jwhide","Preview","validState","stretching","playerAspectRatio","backgroundSize","imageAspectRatio","abs","Title","titleEl","arr","description","update","titleStyle","logo","padding","paddingLeft","paddingRight","updateText","middleware","currentState","isDvr","_minDvrWindow","Infinity"],"mappings":"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","file":"jwplayer.core.js","sourcesContent":["import instances from 'api/players';\r\nimport { showView } from 'api/core-shim';\r\nimport setConfig from 'api/set-config';\r\nimport setPlaylist from 'api/set-playlist';\r\nimport ApiQueueDecorator from 'api/api-queue';\r\nimport PlaylistLoader from 'playlist/loader';\r\nimport Playlist from 'playlist/playlist';\r\nimport InstreamAdapter from 'controller/instream-adapter';\r\nimport Captions from 'controller/captions';\r\nimport Model from 'controller/model';\r\nimport View from 'view/view';\r\nimport changeStateEvent from 'events/change-state-event';\r\nimport eventsMiddleware from 'controller/events-middleware';\r\nimport Events from 'utils/backbone.events';\r\nimport { OS } from 'environment/environment';\r\nimport { streamType } from 'providers/utils/stream-type';\r\nimport Promise, { resolved } from 'polyfills/promise';\r\nimport cancelable from 'utils/cancelable';\r\nimport _ from 'utils/underscore';\r\nimport { PLAYER_STATE, STATE_BUFFERING, STATE_IDLE, STATE_COMPLETE, STATE_PAUSED, STATE_PLAYING, STATE_ERROR, STATE_LOADING,\r\n    STATE_STALLED, MEDIA_BEFOREPLAY, PLAYLIST_LOADED, ERROR, PLAYLIST_COMPLETE, CAPTIONS_CHANGED, READY,\r\n    MEDIA_ERROR, MEDIA_COMPLETE, CAST_SESSION, FULLSCREEN, PLAYLIST_ITEM, MEDIA_VOLUME, MEDIA_MUTE, PLAYBACK_RATE_CHANGED,\r\n    CAPTIONS_LIST, CONTROLS, RESIZE } from 'events/events';\r\n\r\n// The model stores a different state than the provider\r\nfunction normalizeState(newstate) {\r\n    if (newstate === STATE_LOADING || newstate === STATE_STALLED) {\r\n        return STATE_BUFFERING;\r\n    }\r\n    return newstate;\r\n}\r\n\r\nconst Controller = function() {};\r\n\r\nObject.assign(Controller.prototype, {\r\n    setup(config, _api, originalContainer, eventListeners, commandQueue) {\r\n        const _this = this;\r\n        const _model = _this._model = new Model();\r\n\r\n        let _view;\r\n        let _captions;\r\n        let _preplay = false;\r\n        let _actionOnAttach;\r\n        let _stopPlaylist = false;\r\n        let _interruptPlay;\r\n        let checkAutoStartCancelable = cancelable(_checkAutoStart);\r\n        let updatePlaylistCancelable = cancelable(function() {});\r\n\r\n        _this.originalContainer = _this.currentContainer = originalContainer;\r\n        _this._events = eventListeners;\r\n\r\n        const _eventQueuedUntilReady = [];\r\n\r\n        _model.setup(config);\r\n        _view = this._view = new View(_api, _model);\r\n        _view.on('all', _triggerAfterReady, _this);\r\n\r\n        _model.mediaController.on('all', _triggerAfterReady, _this);\r\n        _model.mediaController.on(MEDIA_COMPLETE, () => {\r\n            // Insert a small delay here so that other complete handlers can execute\r\n            resolved.then(_completeHandler);\r\n        });\r\n        _model.mediaController.on(MEDIA_ERROR, _this.triggerError, _this);\r\n        _model.on(ERROR, _this.triggerError, _this);\r\n\r\n        // If we attempt to load flash, assume it is blocked if we don't hear back within a second\r\n        _model.on('change:flashBlocked', function(model, isBlocked) {\r\n            if (!isBlocked) {\r\n                this._model.set('errorEvent', undefined);\r\n                return;\r\n            }\r\n            // flashThrottle indicates whether this is a throttled event or plugin blocked event\r\n            const throttled = !!model.get('flashThrottle');\r\n            const errorEvent = {\r\n                message: throttled ? 'Click to run Flash' : 'Flash plugin failed to load'\r\n            };\r\n            // Only dispatch an error for Flash blocked, not throttled events\r\n            if (!throttled) {\r\n                this.trigger(ERROR, errorEvent);\r\n            }\r\n            this._model.set('errorEvent', errorEvent);\r\n        }, this);\r\n\r\n        _model.on('change:state', changeStateEvent, this);\r\n\r\n        _model.on('change:duration', function(model, duration) {\r\n            const minDvrWindow = model.get('minDvrWindow');\r\n            const type = streamType(duration, minDvrWindow);\r\n            model.setStreamType(type);\r\n        });\r\n\r\n        _model.on('change:castState', function(model, evt) {\r\n            _this.trigger(CAST_SESSION, evt);\r\n        });\r\n        _model.on('change:fullscreen', function(model, bool) {\r\n            _this.trigger(FULLSCREEN, {\r\n                fullscreen: bool\r\n            });\r\n            if (bool) {\r\n                // Stop autoplay behavior when the player enters fullscreen\r\n                model.set('playOnViewable', false);\r\n            }\r\n        });\r\n        _model.on('change:volume', function(model, vol) {\r\n            _this.trigger(MEDIA_VOLUME, {\r\n                volume: vol\r\n            });\r\n        });\r\n        _model.on('change:mute', function(model, mute) {\r\n            _this.trigger(MEDIA_MUTE, {\r\n                mute: mute\r\n            });\r\n        });\r\n\r\n        _model.on('change:playbackRate', function(model, rate) {\r\n            _this.trigger(PLAYBACK_RATE_CHANGED, {\r\n                playbackRate: rate,\r\n                position: model.get('position')\r\n            });\r\n        });\r\n\r\n        _model.on('change:scrubbing', function(model, state) {\r\n            if (state) {\r\n                _pause();\r\n            } else {\r\n                _play({ reason: 'interaction' });\r\n            }\r\n        });\r\n\r\n        // For onCaptionsList and onCaptionsChange\r\n        _model.on('change:captionsList', function(model, captionsList) {\r\n            _this.triggerAfterReady(CAPTIONS_LIST, {\r\n                tracks: captionsList,\r\n                track: _model.get('captionsIndex') || 0\r\n            });\r\n        });\r\n\r\n        _model.on('change:mediaModel', function(model) {\r\n            model.set('errorEvent', undefined);\r\n            model.mediaModel.change(PLAYER_STATE, function(mediaModel, state) {\r\n                if (!model.get('errorEvent')) {\r\n                    model.set(PLAYER_STATE, normalizeState(state));\r\n                }\r\n            });\r\n        });\r\n\r\n        // Ensure captionsList event is raised after playlistItem\r\n        _captions = new Captions(_model);\r\n        _captions.on('all', _triggerAfterReady);\r\n\r\n        function _video() {\r\n            return _model.getVideo();\r\n        }\r\n\r\n        function _triggerAfterReady(type, e) {\r\n            _this.triggerAfterReady(type, e);\r\n        }\r\n\r\n        function triggerControls(model, enable) {\r\n            _this.trigger(CONTROLS, {\r\n                controls: enable\r\n            });\r\n        }\r\n\r\n        _model.on('change:viewSetup', function(model, viewSetup) {\r\n            if (viewSetup) {\r\n                showView(this, _view.element());\r\n            }\r\n        }, this);\r\n\r\n        this.playerReady = function() {\r\n            const related = _api.getPlugin('related');\r\n            if (related) {\r\n                related.on('nextUp', (nextUp) => {\r\n                    _model.set('nextUp', nextUp);\r\n                });\r\n            }\r\n\r\n            // Fire 'ready' once the view has resized so that player width and height are available\r\n            // (requires the container to be in the DOM)\r\n            _view.once(RESIZE, _playerReadyNotify);\r\n\r\n            _view.init();\r\n        };\r\n\r\n        function _playerReadyNotify() {\r\n            _model.change('visibility', _updateViewable);\r\n            _model.on('change:controls', triggerControls);\r\n\r\n            // Tell the api that we are loaded\r\n            _this.trigger(READY, {\r\n                // this will be updated by Api\r\n                setupTime: 0\r\n            });\r\n\r\n            _model.change('playlist', function(model, playlist) {\r\n                if (playlist.length) {\r\n                    const eventData = {\r\n                        playlist: playlist\r\n                    };\r\n                    const feedData = _model.get('feedData');\r\n                    if (feedData) {\r\n                        const eventFeedData = Object.assign({}, feedData);\r\n                        delete eventFeedData.playlist;\r\n                        eventData.feedData = eventFeedData;\r\n                    }\r\n                    _this.trigger(PLAYLIST_LOADED, eventData);\r\n                }\r\n            });\r\n\r\n            _model.change('playlistItem', function(model, playlistItem) {\r\n                if (playlistItem) {\r\n                    _this.trigger(PLAYLIST_ITEM, {\r\n                        index: _model.get('item'),\r\n                        item: playlistItem\r\n                    });\r\n                }\r\n            });\r\n\r\n            // Stop queueing certain events\r\n            _this.triggerAfterReady = _this.trigger;\r\n\r\n            // Send queued events\r\n            for (let i = 0; i < _eventQueuedUntilReady.length; i++) {\r\n                const event = _eventQueuedUntilReady[i];\r\n                _preplay = (event.type === MEDIA_BEFOREPLAY);\r\n                _this.trigger(event.type, event.args);\r\n                _preplay = false;\r\n            }\r\n\r\n            _model.change('viewable', viewableChange);\r\n            _model.change('viewable', _checkPlayOnViewable);\r\n            _model.once('change:autostartFailed change:autostartMuted change:mute', function(model) {\r\n                model.off('change:viewable', _checkPlayOnViewable);\r\n            });\r\n\r\n            // Run _checkAutoStart() last\r\n            // 'viewable' changes can result in preload() being called on the initial provider instance\r\n            _checkAutoStart();\r\n        }\r\n\r\n        function _updateViewable(model, visibility) {\r\n            if (!_.isUndefined(visibility)) {\r\n                _model.set('viewable', Math.round(visibility));\r\n            }\r\n        }\r\n\r\n        function _checkAutoStart() {\r\n            if (!apiQueue) {\r\n                // this player has been destroyed\r\n                return;\r\n            }\r\n            if (!OS.mobile && _model.get('autostart') === true) {\r\n                // Autostart immediately if we're not mobile and not waiting for the player to become viewable first\r\n                _autoStart();\r\n            }\r\n            apiQueue.flush();\r\n        }\r\n\r\n        function viewableChange(model, viewable) {\r\n            _this.trigger('viewable', {\r\n                viewable: viewable\r\n            });\r\n\r\n\r\n            // Only attempt to preload if this is the first player on the page or viewable\r\n            if (instances[0] === _api || viewable === 1) {\r\n                model.preloadVideo();\r\n            }\r\n        }\r\n\r\n        function _checkPlayOnViewable(model, viewable) {\r\n            if (model.get('playOnViewable')) {\r\n                if (viewable) {\r\n                    _autoStart();\r\n                } else if (OS.mobile) {\r\n                    _this.pause({ reason: 'autostart' });\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerAfterReady = function(type, args) {\r\n            _eventQueuedUntilReady.push({\r\n                type: type,\r\n                args: args\r\n            });\r\n        };\r\n\r\n        function _load(item, feedData) {\r\n\r\n            _this.trigger('destroyPlugin', {});\r\n            _stop(true);\r\n\r\n            checkAutoStartCancelable.cancel();\r\n            checkAutoStartCancelable = cancelable(_checkAutoStart);\r\n            updatePlaylistCancelable.cancel();\r\n\r\n            _primeMediaElementForPlayback();\r\n\r\n            let loadPromise;\r\n\r\n            switch (typeof item) {\r\n                case 'string': {\r\n                    const loadPlaylistPromise = _loadPlaylist(item).catch(error => {\r\n                        _this.triggerError({\r\n                            message: `Error loading playlist: ${error.message}`\r\n                        });\r\n                    });\r\n                    updatePlaylistCancelable = cancelable((data) => {\r\n                        if (data) {\r\n                            return _updatePlaylist(data.playlist, data);\r\n                        }\r\n                    });\r\n                    loadPromise = loadPlaylistPromise.then(updatePlaylistCancelable.async);\r\n                    break;\r\n                }\r\n                case 'object':\r\n                    loadPromise = _updatePlaylist(item, feedData);\r\n                    break;\r\n                case 'number':\r\n                    loadPromise = _setItem(item);\r\n                    break;\r\n                default:\r\n                    return;\r\n            }\r\n            loadPromise.catch(error => {\r\n                _this.triggerError({\r\n                    message: `Playlist error: ${error.message}`\r\n                });\r\n            });\r\n\r\n            loadPromise.then(checkAutoStartCancelable.async).catch(function() {});\r\n        }\r\n\r\n        function _updatePlaylist(data, feedData) {\r\n            const playlist = Playlist(data);\r\n            try {\r\n                setPlaylist(_model, playlist, feedData);\r\n            } catch (error) {\r\n                _model.set('item', 0);\r\n                _model.set('playlistItem', null);\r\n                return Promise.reject(error);\r\n            }\r\n            return _setItem(0);\r\n        }\r\n\r\n        function _loadPlaylist(toLoad) {\r\n            return new Promise((resolve, reject) => {\r\n                const loader = new PlaylistLoader();\r\n                loader.on(PLAYLIST_LOADED, function(data) {\r\n                    resolve(data);\r\n                });\r\n                loader.on(ERROR, function(error) {\r\n                    _model.set('feedData', {\r\n                        error: error\r\n                    });\r\n                    reject(error);\r\n                }, this);\r\n                loader.load(toLoad);\r\n            });\r\n        }\r\n\r\n        function _getAdState() {\r\n            return _this._instreamAdapter && _this._instreamAdapter.getState();\r\n        }\r\n\r\n        function _getState() {\r\n            const adState = _getAdState();\r\n            if (_.isString(adState)) {\r\n                return adState;\r\n            }\r\n            return _model.get('state');\r\n        }\r\n\r\n        function _play(meta) {\r\n            checkAutoStartCancelable.cancel();\r\n\r\n            if (_model.get('state') === STATE_ERROR) {\r\n                return resolved;\r\n            }\r\n\r\n            const playReason = _getReason(meta);\r\n            _model.set('playReason', playReason);\r\n\r\n            const adState = _getAdState();\r\n            if (_.isString(adState)) {\r\n                // this will resume the ad. _api.playAd would load a new ad\r\n                _api.pauseAd(false);\r\n                return resolved;\r\n            }\r\n\r\n            if (_model.get('state') === STATE_COMPLETE) {\r\n                _stop(true);\r\n                _setItem(0);\r\n            }\r\n\r\n            if (!_preplay) {\r\n                _preplay = true;\r\n                _this.triggerAfterReady(MEDIA_BEFOREPLAY, { playReason: playReason });\r\n                _preplay = false;\r\n                if (_interruptPlay) {\r\n                    _interruptPlay = false;\r\n                    _actionOnAttach = null;\r\n                    _primeMediaElementForPlayback();\r\n                    return resolved;\r\n                }\r\n            }\r\n\r\n            return _model.playVideo(playReason);\r\n        }\r\n\r\n        function _getReason(meta) {\r\n            if (meta && meta.reason) {\r\n                return meta.reason;\r\n            }\r\n            if (_inInteraction(window.event)) {\r\n                return 'interaction';\r\n            }\r\n            return 'external';\r\n        }\r\n\r\n        function _inInteraction(event) {\r\n            return event && /^(?:mouse|pointer|touch|gesture|click|key)/.test(event.type);\r\n        }\r\n\r\n        function _primeMediaElementForPlayback() {\r\n            // If we're in a user-gesture event call load() on video to allow async playback\r\n            if (_inInteraction(window.event)) {\r\n                const mediaElement = _model.get('mediaElement');\r\n                if (!mediaElement.src) {\r\n                    mediaElement.load();\r\n                }\r\n            }\r\n        }\r\n\r\n        function _autoStart() {\r\n            const state = _model.get('state');\r\n            if (state === STATE_IDLE || state === STATE_PAUSED) {\r\n                _play({ reason: 'autostart' }).catch(() => {\r\n                    if (!_this._instreamAdapter) {\r\n                        _model.set('autostartFailed', true);\r\n                    }\r\n                    _actionOnAttach = null;\r\n                });\r\n            }\r\n        }\r\n\r\n        function _stop(internal) {\r\n            checkAutoStartCancelable.cancel();\r\n            apiQueue.empty();\r\n\r\n            const adState = _getAdState();\r\n            if (_.isString(adState)) {\r\n                return;\r\n            }\r\n\r\n            const fromApi = !internal;\r\n\r\n            _actionOnAttach = null;\r\n\r\n            if (fromApi) {\r\n                _stopPlaylist = true;\r\n            }\r\n\r\n            if (_preplay) {\r\n                _interruptPlay = true;\r\n            }\r\n\r\n            _model.set('errorEvent', undefined);\r\n\r\n            const provider = _model.getVideo();\r\n            _model.stopVideo();\r\n            if (!provider) {\r\n                _model.set('state', STATE_IDLE);\r\n            }\r\n        }\r\n\r\n        function _pause(meta) {\r\n            _actionOnAttach = null;\r\n            checkAutoStartCancelable.cancel();\r\n\r\n            const pauseReason = _getReason(meta);\r\n            _model.set('pauseReason', pauseReason);\r\n            // Stop autoplay behavior if the video is paused by the user or an api call\r\n            if (pauseReason === 'interaction' || pauseReason === 'external') {\r\n                _model.set('playOnViewable', false);\r\n            }\r\n\r\n            const adState = _getAdState();\r\n            if (_.isString(adState)) {\r\n                _api.pauseAd(true);\r\n                return;\r\n            }\r\n\r\n            switch (_model.get('state')) {\r\n                case STATE_ERROR:\r\n                    return;\r\n                case STATE_PLAYING:\r\n                case STATE_BUFFERING: {\r\n\r\n                    _video().pause();\r\n                    break;\r\n                }\r\n                default:\r\n                    if (_preplay) {\r\n                        _interruptPlay = true;\r\n                    }\r\n            }\r\n        }\r\n\r\n        function _isIdle() {\r\n            const state = _model.get('state');\r\n            return (state === STATE_IDLE || state === STATE_COMPLETE || state === STATE_ERROR);\r\n        }\r\n\r\n        function _seek(pos, meta) {\r\n            if (_model.get('state') === STATE_ERROR) {\r\n                return;\r\n            }\r\n            if (!_model.get('scrubbing') && _model.get('state') !== STATE_PLAYING) {\r\n                _play(meta);\r\n            }\r\n            _video().seek(pos);\r\n        }\r\n\r\n        function _item(index, meta) {\r\n            _stop(true);\r\n            _setItem(index);\r\n            _play(meta);\r\n        }\r\n\r\n        function _setItem(index) {\r\n            return _model.setItemIndex(index);\r\n        }\r\n\r\n        function _prev(meta) {\r\n            _item(_model.get('item') - 1, meta);\r\n        }\r\n\r\n        function _next(meta) {\r\n            _item(_model.get('item') + 1, meta);\r\n        }\r\n\r\n        function _completeHandler() {\r\n            if (!_isIdle()) {\r\n                // Something has made an API call before the complete handler has fired.\r\n                return;\r\n            } else if (_stopPlaylist) {\r\n                // Stop called in onComplete event listener\r\n                _stopPlaylist = false;\r\n                return;\r\n            }\r\n\r\n            _actionOnAttach = _completeHandler;\r\n\r\n            const idx = _model.get('item');\r\n            if (idx === _model.get('playlist').length - 1) {\r\n                // If it's the last item in the playlist\r\n                if (_model.get('repeat')) {\r\n                    _next({ reason: 'repeat' });\r\n                } else {\r\n                    // Exit fullscreen on IOS so that our overlays show to the user\r\n                    if (OS.iOS) {\r\n                        _setFullscreen(false);\r\n                    }\r\n                    // Autoplay/pause no longer needed since there's no more media to play\r\n                    // This prevents media from replaying when a completed video scrolls into view\r\n                    _model.set('playOnViewable', false);\r\n                    _model.set('state', STATE_COMPLETE);\r\n                    _this.trigger(PLAYLIST_COMPLETE, {});\r\n                }\r\n                return;\r\n            }\r\n\r\n            // It wasn't the last item in the playlist,\r\n            //  so go to the next one and trigger an autoadvance event\r\n            const related = _api.getPlugin('related');\r\n            triggerAdvanceEvent(related, 'nextAutoAdvance');\r\n            _next({ reason: 'playlist' });\r\n        }\r\n\r\n        function _setCurrentQuality(index) {\r\n            if (_video()) {\r\n                index = parseInt(index, 10) || 0;\r\n                _video().setCurrentQuality(index);\r\n            }\r\n        }\r\n\r\n        function _getCurrentQuality() {\r\n            if (_video()) {\r\n                return _video().getCurrentQuality();\r\n            }\r\n            return -1;\r\n        }\r\n\r\n        function _getConfig() {\r\n            return this._model ? this._model.getConfiguration() : undefined;\r\n        }\r\n\r\n        function _getVisualQuality() {\r\n            if (this._model.mediaModel) {\r\n                return this._model.mediaModel.get('visualQuality');\r\n            }\r\n            // if quality is not implemented in the provider,\r\n            // return quality info based on current level\r\n            const qualityLevels = _getQualityLevels();\r\n            if (qualityLevels) {\r\n                const levelIndex = _getCurrentQuality();\r\n                const level = qualityLevels[levelIndex];\r\n                if (level) {\r\n                    return {\r\n                        level: Object.assign({\r\n                            index: levelIndex\r\n                        }, level),\r\n                        mode: '',\r\n                        reason: ''\r\n                    };\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n\r\n        function _getQualityLevels() {\r\n            if (_video()) {\r\n                return _video().getQualityLevels();\r\n            }\r\n            return null;\r\n        }\r\n\r\n        function _setCurrentAudioTrack(index) {\r\n            if (_video()) {\r\n                index = parseInt(index, 10) || 0;\r\n                _video().setCurrentAudioTrack(index);\r\n            }\r\n        }\r\n\r\n        function _getCurrentAudioTrack() {\r\n            if (_video()) {\r\n                return _video().getCurrentAudioTrack();\r\n            }\r\n            return -1;\r\n        }\r\n\r\n        function _getAudioTracks() {\r\n            if (_video()) {\r\n                return _video().getAudioTracks();\r\n            }\r\n            return null;\r\n        }\r\n\r\n        function _setCurrentCaptions(index) {\r\n            index = parseInt(index, 10) || 0;\r\n\r\n            // update provider subtitle track\r\n            _model.persistVideoSubtitleTrack(index);\r\n\r\n            _this.trigger(CAPTIONS_CHANGED, {\r\n                tracks: _getCaptionsList(),\r\n                track: index\r\n            });\r\n        }\r\n\r\n        function _getCurrentCaptions() {\r\n            return _captions.getCurrentIndex();\r\n        }\r\n\r\n        function _getCaptionsList() {\r\n            return _captions.getCaptionsList();\r\n        }\r\n\r\n        /** Used for the InStream API **/\r\n        function _detachMedia() {\r\n            if (_preplay) {\r\n                _interruptPlay = true;\r\n            }\r\n            return _model.detachMedia();\r\n        }\r\n\r\n        function _attachMedia() {\r\n            // Called after instream ends\r\n            _model.attachMedia();\r\n\r\n            if (typeof _actionOnAttach === 'function') {\r\n                _actionOnAttach();\r\n            }\r\n        }\r\n\r\n        function _setFullscreen(state) {\r\n            if (!_.isBoolean(state)) {\r\n                state = !_model.get('fullscreen');\r\n            }\r\n\r\n            _model.set('fullscreen', state);\r\n            if (_this._instreamAdapter && _this._instreamAdapter._adModel) {\r\n                _this._instreamAdapter._adModel.set('fullscreen', state);\r\n            }\r\n        }\r\n\r\n        function _nextUp() {\r\n            const related = _api.getPlugin('related');\r\n            triggerAdvanceEvent(related, 'nextClick', () => related.next());\r\n        }\r\n\r\n        function triggerAdvanceEvent(related, evt, cb) {\r\n            if (!related) {\r\n                return;\r\n            }\r\n            const nextUp = _model.get('nextUp');\r\n            if (nextUp) {\r\n                _this.trigger(evt, {\r\n                    mode: nextUp.mode,\r\n                    ui: 'nextup',\r\n                    target: nextUp,\r\n                    itemsShown: [ nextUp ],\r\n                    feedData: nextUp.feedData,\r\n                });\r\n            }\r\n            if (typeof cb === 'function') {\r\n                cb();\r\n            }\r\n        }\r\n\r\n        /** Controller API / public methods **/\r\n        this.load = _load;\r\n        this.play = _play;\r\n        this.pause = _pause;\r\n        this.seek = _seek;\r\n        this.stop = _stop;\r\n        this.playlistItem = _item;\r\n        this.playlistNext = _next;\r\n        this.playlistPrev = _prev;\r\n        this.setCurrentCaptions = _setCurrentCaptions;\r\n        this.setCurrentQuality = _setCurrentQuality;\r\n        this.setFullscreen = _setFullscreen;\r\n        this.detachMedia = _detachMedia;\r\n        this.attachMedia = _attachMedia;\r\n        this.getCurrentQuality = _getCurrentQuality;\r\n        this.getQualityLevels = _getQualityLevels;\r\n        this.setCurrentAudioTrack = _setCurrentAudioTrack;\r\n        this.getCurrentAudioTrack = _getCurrentAudioTrack;\r\n        this.getAudioTracks = _getAudioTracks;\r\n        this.getCurrentCaptions = _getCurrentCaptions;\r\n        this.getCaptionsList = _getCaptionsList;\r\n        this.getVisualQuality = _getVisualQuality;\r\n        this.getConfig = _getConfig;\r\n        this.getState = _getState;\r\n        this.next = _nextUp;\r\n        this.setConfig = (newConfig) => setConfig(_this, newConfig);\r\n\r\n        // Model passthroughs\r\n        this.setVolume = _model.setVolume.bind(_model);\r\n        this.setMute = _model.setMute.bind(_model);\r\n        this.setPlaybackRate = _model.setPlaybackRate.bind(_model);\r\n        this.getProvider = function() {\r\n            return _model.get('provider');\r\n        };\r\n        this.getWidth = function() {\r\n            return _model.get('containerWidth');\r\n        };\r\n        this.getHeight = function() {\r\n            return _model.get('containerHeight');\r\n        };\r\n        this.getItemQoe = function() {\r\n            return _model._qoeItem;\r\n        };\r\n        this.isBeforeComplete = function () {\r\n            return _model.checkComplete();\r\n        };\r\n        this.addButton = function(img, tooltip, callback, id, btnClass) {\r\n            let customButtons = _model.get('customButtons') || [];\r\n            let added = false;\r\n            const newButton = {\r\n                img: img,\r\n                tooltip: tooltip,\r\n                callback: callback,\r\n                id: id,\r\n                btnClass: btnClass\r\n            };\r\n\r\n            customButtons = customButtons.reduce(function(buttons, button) {\r\n                if (button.id === newButton.id) {\r\n                    added = true;\r\n                    buttons.push(newButton);\r\n                } else {\r\n                    buttons.push(button);\r\n                }\r\n                return buttons;\r\n            }, []);\r\n\r\n            if (!added) {\r\n                customButtons.unshift(newButton);\r\n            }\r\n\r\n            _model.set('customButtons', customButtons);\r\n        };\r\n        this.removeButton = function(id) {\r\n            const customButtons = _.filter(\r\n                _model.get('customButtons'),\r\n                (button) => button.id !== id\r\n            );\r\n\r\n            _model.set('customButtons', customButtons);\r\n        };\r\n        // Delegate trigger so we can run a middleware function before any event is bubbled through the API\r\n        this.trigger = function (type, args) {\r\n            const data = eventsMiddleware(_model, type, args);\r\n            return Events.trigger.call(this, type, data);\r\n        };\r\n\r\n        // View passthroughs\r\n        this.resize = _view.resize;\r\n        this.getSafeRegion = _view.getSafeRegion;\r\n        this.setCues = _view.addCues;\r\n        this.setCaptions = _view.setCaptions;\r\n\r\n        this.checkBeforePlay = function() {\r\n            return _preplay;\r\n        };\r\n\r\n        this.setControls = function (mode) {\r\n            if (!_.isBoolean(mode)) {\r\n                mode = !_model.get('controls');\r\n            }\r\n            _model.set('controls', mode);\r\n\r\n            const provider = _model.getVideo();\r\n            if (provider) {\r\n                provider.setControls(mode);\r\n            }\r\n        };\r\n\r\n        this.playerDestroy = function () {\r\n            this.trigger('destroyPlugin', {});\r\n            this.off();\r\n            this.stop();\r\n            showView(this, this.originalContainer);\r\n            if (_view) {\r\n                _view.destroy();\r\n            }\r\n            if (_model) {\r\n                _model.destroy();\r\n            }\r\n            if (apiQueue) {\r\n                apiQueue.destroy();\r\n            }\r\n            if (_captions) {\r\n                _captions.destroy();\r\n                _captions = null;\r\n            }\r\n            this.instreamDestroy();\r\n        };\r\n\r\n        this.isBeforePlay = this.checkBeforePlay;\r\n\r\n        this.createInstream = function() {\r\n            this.instreamDestroy();\r\n            this._instreamAdapter = new InstreamAdapter(this, _model, _view);\r\n            return this._instreamAdapter;\r\n        };\r\n\r\n        this.skipAd = function() {\r\n            if (this._instreamAdapter) {\r\n                this._instreamAdapter.skipAd();\r\n            }\r\n        };\r\n\r\n        this.instreamDestroy = function() {\r\n            if (_this._instreamAdapter) {\r\n                _this._instreamAdapter.destroy();\r\n                _this._instreamAdapter = null;\r\n            }\r\n        };\r\n\r\n        // Setup ApiQueueDecorator after instance methods have been assigned\r\n        const apiQueue = new ApiQueueDecorator(this, [\r\n            'play',\r\n            'pause',\r\n            'seek',\r\n            'setCurrentAudioTrack',\r\n            'setCurrentCaptions',\r\n            'setCurrentQuality',\r\n            'setFullscreen',\r\n        ], () => !_model.getVideo());\r\n        // Add commands from CoreLoader to queue\r\n        apiQueue.queue.push.apply(apiQueue.queue, commandQueue);\r\n\r\n        _view.setup();\r\n    },\r\n    get(property) {\r\n        return this._model.get(property);\r\n    },\r\n    getContainer() {\r\n        return this.currentContainer || this.originalContainer;\r\n    },\r\n    getMute() {\r\n        return this._model.getMute();\r\n    },\r\n    triggerError(evt) {\r\n        this._model.set('errorEvent', evt);\r\n        this._model.set('state', STATE_ERROR);\r\n        this._model.once('change:state', function() {\r\n            this._model.set('errorEvent', undefined);\r\n        }, this);\r\n\r\n        this.trigger(ERROR, evt);\r\n    }\r\n});\r\n\r\nexport default Controller;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/controller/controller.js","import { Browser, OS } from 'environment/environment';\r\nimport { DRAG, DRAG_START, DRAG_END, CLICK, DOUBLE_CLICK, MOVE, OUT, TAP, DOUBLE_TAP, OVER, ENTER } from 'events/events';\r\nimport Events from 'utils/backbone.events';\r\nimport { now } from 'utils/date';\r\n\r\nconst _supportsPointerEvents = ('PointerEvent' in window) && !OS.android;\r\nconst _supportsTouchEvents = ('ontouchstart' in window);\r\nconst _useMouseEvents = !_supportsPointerEvents && !(_supportsTouchEvents && OS.mobile);\r\nconst _isOSXFirefox = Browser.firefox && OS.mac;\r\n\r\nfunction getCoord(e, c) {\r\n    return /touch/.test(e.type) ? (e.originalEvent || e).changedTouches[0]['page' + c] : e['page' + c];\r\n}\r\n\r\nfunction isRightClick(evt) {\r\n    const e = evt || window.event;\r\n\r\n    if (!(evt instanceof MouseEvent)) {\r\n        return false;\r\n    }\r\n\r\n    if ('which' in e) {\r\n        // Gecko (Firefox), WebKit (Safari/Chrome) & Opera\r\n        return (e.which === 3);\r\n    } else if ('button' in e) {\r\n        // IE and Opera\r\n        return (e.button === 2);\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nfunction isEnterKey(evt) {\r\n    const e = evt || window.event;\r\n\r\n    if ((e instanceof KeyboardEvent) && e.keyCode === 13) {\r\n        evt.stopPropagation();\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nfunction normalizeUIEvent(type, srcEvent, target) {\r\n    let source;\r\n\r\n    if (srcEvent instanceof MouseEvent || (!srcEvent.touches && !srcEvent.changedTouches)) {\r\n        source = srcEvent;\r\n    } else if (srcEvent.touches && srcEvent.touches.length) {\r\n        source = srcEvent.touches[0];\r\n    } else {\r\n        source = srcEvent.changedTouches[0];\r\n    }\r\n\r\n    return {\r\n        type: type,\r\n        sourceEvent: srcEvent,\r\n        target: srcEvent.target,\r\n        currentTarget: target,\r\n        pageX: source.pageX,\r\n        pageY: source.pageY\r\n    };\r\n}\r\n\r\n// Preventdefault to prevent click events\r\nfunction preventDefault(evt) {\r\n    // Because sendEvent from utils.eventdispatcher clones evt objects instead of passing them\r\n    //  we cannot call evt.preventDefault() on them\r\n    if (!(evt instanceof MouseEvent) && !(evt instanceof window.TouchEvent)) {\r\n        return;\r\n    }\r\n    if (evt.preventManipulation) {\r\n        evt.preventManipulation();\r\n    }\r\n    // prevent scrolling\r\n    if (evt.preventDefault) {\r\n        evt.preventDefault();\r\n    }\r\n}\r\n\r\nconst UI = function (elem, options) {\r\n    const _elem = elem;\r\n    let _hasMoved = false;\r\n    let _startX = 0;\r\n    let _startY = 0;\r\n    let _lastClickTime = 0;\r\n    let _doubleClickDelay = 300;\r\n    let _touchListenerTarget;\r\n    let _pointerId;\r\n\r\n    options = options || {};\r\n\r\n    // If its not mobile, add mouse listener.  Add touch listeners so touch devices that aren't Android or iOS\r\n    // (windows phones) still get listeners just in case they want to use them.\r\n    if (_supportsPointerEvents) {\r\n        elem.addEventListener('pointerdown', interactStartHandler);\r\n        if (options.useHover) {\r\n            elem.addEventListener('pointerover', overHandler);\r\n            elem.addEventListener('pointerout', outHandler);\r\n        }\r\n        if (options.useMove) {\r\n            elem.addEventListener('pointermove', moveHandler);\r\n        }\r\n    } else {\r\n        if (_useMouseEvents) {\r\n            elem.addEventListener('mousedown', interactStartHandler);\r\n            if (options.useHover) {\r\n                elem.addEventListener('mouseover', overHandler);\r\n                elem.addEventListener('mouseout', outHandler);\r\n            }\r\n            if (options.useMove) {\r\n                elem.addEventListener('mousemove', moveHandler);\r\n            }\r\n        }\r\n\r\n        // Always add this, in case we don't properly identify the device as mobile\r\n        elem.addEventListener('touchstart', interactStartHandler);\r\n    }\r\n\r\n    elem.addEventListener('keydown', keyHandler);\r\n    if (options.useFocus) {\r\n        elem.addEventListener('focus', overHandler);\r\n        elem.addEventListener('blur', outHandler);\r\n    }\r\n\r\n    // overHandler and outHandler not assigned in touch situations\r\n    function overHandler(evt) {\r\n        if (evt.pointerType !== 'touch') {\r\n            triggerEvent(OVER, evt);\r\n        }\r\n    }\r\n\r\n    function moveHandler(evt) {\r\n        if (evt.pointerType !== 'touch') {\r\n            triggerEvent(MOVE, evt);\r\n        }\r\n    }\r\n\r\n    function outHandler(evt) {\r\n        // elementFromPoint to handle an issue where setPointerCapture is causing a pointerout event\r\n        if (_useMouseEvents || (_supportsPointerEvents && evt.pointerType !== 'touch' &&\r\n            !elem.contains(document.elementFromPoint(evt.x, evt.y)))) {\r\n            triggerEvent(OUT, evt);\r\n        }\r\n    }\r\n\r\n    function keyHandler(evt) {\r\n        if (isEnterKey(evt)) {\r\n            triggerEvent(ENTER, evt);\r\n        }\r\n    }\r\n\r\n    function setEventListener(element, eventName, callback) {\r\n        element.removeEventListener(eventName, callback);\r\n        element.addEventListener(eventName, callback);\r\n    }\r\n\r\n    function interactStartHandler(evt) {\r\n        _touchListenerTarget = evt.target;\r\n        _startX = getCoord(evt, 'X');\r\n        _startY = getCoord(evt, 'Y');\r\n\r\n        if (!isRightClick(evt)) {\r\n\r\n            if (evt.type === 'pointerdown' && evt.isPrimary) {\r\n                if (options.preventScrolling) {\r\n                    _pointerId = evt.pointerId;\r\n                    elem.setPointerCapture(_pointerId);\r\n                }\r\n                setEventListener(elem, 'pointermove', interactDragHandler);\r\n                setEventListener(elem, 'pointercancel', interactEndHandler);\r\n\r\n                // Listen for mouseup after mouse pointer down because pointerup doesn't fire on swf objects\r\n                if (evt.pointerType === 'mouse' && _touchListenerTarget.nodeName === 'OBJECT') {\r\n                    setEventListener(document, 'mouseup', interactEndHandler);\r\n                } else {\r\n                    setEventListener(elem, 'pointerup', interactEndHandler);\r\n                }\r\n            } else if (evt.type === 'mousedown') {\r\n                setEventListener(document, 'mousemove', interactDragHandler);\r\n\r\n                // Handle clicks in OSX Firefox over Flash 'object'\r\n                if (_isOSXFirefox && evt.target.nodeName.toLowerCase() === 'object') {\r\n                    setEventListener(elem, 'click', interactEndHandler);\r\n                } else {\r\n                    setEventListener(document, 'mouseup', interactEndHandler);\r\n                }\r\n            } else if (evt.type === 'touchstart') {\r\n                setEventListener(_touchListenerTarget, 'touchmove', interactDragHandler);\r\n                setEventListener(_touchListenerTarget, 'touchcancel', interactEndHandler);\r\n                setEventListener(_touchListenerTarget, 'touchend', interactEndHandler);\r\n            }\r\n\r\n            // Prevent scrolling the screen dragging while dragging on mobile.\r\n            if (options.preventScrolling) {\r\n                preventDefault(evt);\r\n            }\r\n        }\r\n    }\r\n\r\n    function interactDragHandler(evt) {\r\n        const movementThreshold = 6;\r\n\r\n        if (_hasMoved) {\r\n            triggerEvent(DRAG, evt);\r\n        } else {\r\n            const endX = getCoord(evt, 'X');\r\n            const endY = getCoord(evt, 'Y');\r\n            const moveX = endX - _startX;\r\n            const moveY = endY - _startY;\r\n            if (moveX * moveX + moveY * moveY > movementThreshold * movementThreshold) {\r\n                triggerEvent(DRAG_START, evt);\r\n                _hasMoved = true;\r\n                triggerEvent(DRAG, evt);\r\n            }\r\n        }\r\n\r\n        // Prevent scrolling the screen dragging while dragging on mobile.\r\n        if (options.preventScrolling) {\r\n            preventDefault(evt);\r\n        }\r\n    }\r\n\r\n    function interactEndHandler(evt) {\r\n        const isPointerEvent = (evt.type === 'pointerup' || evt.type === 'pointercancel');\r\n        if (isPointerEvent && options.preventScrolling) {\r\n            elem.releasePointerCapture(_pointerId);\r\n        }\r\n        elem.removeEventListener('pointermove', interactDragHandler);\r\n        elem.removeEventListener('pointercancel', interactEndHandler);\r\n        elem.removeEventListener('pointerup', interactEndHandler);\r\n        document.removeEventListener('mousemove', interactDragHandler);\r\n        document.removeEventListener('mouseup', interactEndHandler);\r\n        if (_touchListenerTarget) {\r\n            _touchListenerTarget.removeEventListener('touchmove', interactDragHandler);\r\n            _touchListenerTarget.removeEventListener('touchcancel', interactEndHandler);\r\n            _touchListenerTarget.removeEventListener('touchend', interactEndHandler);\r\n        }\r\n\r\n        if (_hasMoved) {\r\n            triggerEvent(DRAG_END, evt);\r\n        } else if ((!options.directSelect || evt.target === elem) && evt.type.indexOf('cancel') === -1) {\r\n            if (evt.type === 'mouseup' || evt.type === 'click' || isPointerEvent && evt.pointerType === 'mouse') {\r\n                triggerEvent(CLICK, evt);\r\n            } else {\r\n                triggerEvent(TAP, evt);\r\n                if (evt.type === 'touchend') {\r\n                    // preventDefault to not dispatch the 300ms delayed click after a tap\r\n                    preventDefault(evt);\r\n                }\r\n            }\r\n        }\r\n\r\n        _touchListenerTarget = null;\r\n        _hasMoved = false;\r\n    }\r\n\r\n    const self = this;\r\n    function triggerEvent(type, srcEvent) {\r\n        let evt;\r\n        if (options.enableDoubleTap && (type === CLICK || type === TAP)) {\r\n            if (now() - _lastClickTime < _doubleClickDelay) {\r\n                const doubleType = (type === CLICK) ?\r\n                    DOUBLE_CLICK : DOUBLE_TAP;\r\n                evt = normalizeUIEvent(doubleType, srcEvent, _elem);\r\n                self.trigger(doubleType, evt);\r\n                _lastClickTime = 0;\r\n            } else {\r\n                _lastClickTime = now();\r\n            }\r\n        }\r\n        evt = normalizeUIEvent(type, srcEvent, _elem);\r\n        self.trigger(type, evt);\r\n    }\r\n\r\n    this.triggerEvent = triggerEvent;\r\n\r\n    this.destroy = function() {\r\n        this.off();\r\n        elem.removeEventListener('touchstart', interactStartHandler);\r\n        elem.removeEventListener('mousedown', interactStartHandler);\r\n        elem.removeEventListener('keydown', keyHandler);\r\n\r\n        if (_touchListenerTarget) {\r\n            _touchListenerTarget.removeEventListener('touchmove', interactDragHandler);\r\n            _touchListenerTarget.removeEventListener('touchcancel', interactEndHandler);\r\n            _touchListenerTarget.removeEventListener('touchend', interactEndHandler);\r\n            _touchListenerTarget = null;\r\n        }\r\n\r\n        if (_supportsPointerEvents) {\r\n            if (options.preventScrolling) {\r\n                elem.releasePointerCapture(_pointerId);\r\n            }\r\n            elem.removeEventListener('pointerover', overHandler);\r\n            elem.removeEventListener('pointerdown', interactStartHandler);\r\n            elem.removeEventListener('pointermove', interactDragHandler);\r\n            elem.removeEventListener('pointermove', moveHandler);\r\n            elem.removeEventListener('pointercancel', interactEndHandler);\r\n            elem.removeEventListener('pointerout', outHandler);\r\n            elem.removeEventListener('pointerup', interactEndHandler);\r\n        }\r\n\r\n        elem.removeEventListener('click', interactEndHandler);\r\n        elem.removeEventListener('mouseover', overHandler);\r\n        elem.removeEventListener('mousemove', moveHandler);\r\n        elem.removeEventListener('mouseout', outHandler);\r\n        document.removeEventListener('mousemove', interactDragHandler);\r\n        document.removeEventListener('mouseup', interactEndHandler);\r\n\r\n        if (options.useFocus) {\r\n            elem.removeEventListener('focus', overHandler);\r\n            elem.removeEventListener('blur', outHandler);\r\n        }\r\n    };\r\n\r\n    return this;\r\n};\r\n\r\n// Expose what the source of the event is so that we can ensure it's handled correctly.\r\n// This returns only 'touch' or 'mouse'. 'pen' will be treated as a mouse.\r\nUI.getPointerType = function(evt) {\r\n    if (_supportsPointerEvents && evt instanceof window.PointerEvent) {\r\n        return (evt.pointerType === 'touch') ? 'touch' : 'mouse';\r\n    } else if (_supportsTouchEvents && evt instanceof window.TouchEvent) {\r\n        return 'touch';\r\n    }\r\n\r\n    return 'mouse';\r\n};\r\n\r\nObject.assign(UI.prototype, Events);\r\n\r\nexport const getPointerType = UI.getPointerType;\r\n\r\nexport default UI;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/ui.js","import { seconds, trim } from 'utils/strings';\r\n\r\n// Component that loads and parses an SRT file\r\n\r\nexport default function Srt(data) {\r\n    // Trim whitespace and split the list by returns.\r\n    var _captions = [];\r\n    data = trim(data);\r\n    var list = data.split('\\r\\n\\r\\n');\r\n    if (list.length === 1) {\r\n        list = data.split('\\n\\n');\r\n    }\r\n\r\n    for (var i = 0; i < list.length; i++) {\r\n        if (list[i] === 'WEBVTT') {\r\n            continue;\r\n        }\r\n        // Parse each entry\r\n        var entry = _entry(list[i]);\r\n        if (entry.text) {\r\n            _captions.push(entry);\r\n        }\r\n    }\r\n\r\n    return _captions;\r\n}\r\n\r\n\r\n/** Parse a single captions entry. **/\r\nfunction _entry(data) {\r\n    var entry = {};\r\n    var array = data.split('\\r\\n');\r\n    if (array.length === 1) {\r\n        array = data.split('\\n');\r\n    }\r\n    var idx = 1;\r\n    if (array[0].indexOf(' --> ') > 0) {\r\n        idx = 0;\r\n    }\r\n    if (array.length > idx + 1 && array[idx + 1]) {\r\n        // This line contains the start and end.\r\n        var line = array[idx];\r\n        var index = line.indexOf(' --> ');\r\n        if (index > 0) {\r\n            entry.begin = seconds(line.substr(0, index));\r\n            entry.end = seconds(line.substr(index + 5));\r\n            // Remaining lines contain the text\r\n            entry.text = array.slice(idx + 1).join('\\r\\n');\r\n        }\r\n    }\r\n    return entry;\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/parsers/captions/srt.js","import { STATE_IDLE, STATE_COMPLETE, STATE_ERROR } from 'events/events';\r\n\r\n// The api should dispatch an idle event when the model's state changes to complete\r\n// This is to avoid conflicts with the complete event and to maintain legacy event flow\r\nfunction normalizeApiState(newstate) {\r\n    if (newstate === STATE_COMPLETE || newstate === STATE_ERROR) {\r\n        return STATE_IDLE;\r\n    }\r\n    return newstate;\r\n}\r\n\r\nexport default function ChangeStateEvent(model, newstate, oldstate) {\r\n    newstate = normalizeApiState(newstate);\r\n    oldstate = normalizeApiState(oldstate);\r\n    // do not dispatch idle a second time after complete\r\n    if (newstate !== oldstate) {\r\n        // buffering, playing and paused states become:\r\n        // buffer, play and pause events\r\n        var eventType = newstate.replace(/(?:ing|d)$/, '');\r\n        var evt = {\r\n            type: eventType,\r\n            newstate: newstate,\r\n            oldstate: oldstate,\r\n            reason: model.mediaModel.get('state')\r\n        };\r\n        // add reason for play/pause events\r\n        if (eventType === 'play') {\r\n            evt.playReason = model.get('playReason');\r\n        } else if (eventType === 'pause') {\r\n            evt.pauseReason = model.get('pauseReason');\r\n        }\r\n        this.trigger(eventType, evt);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/events/change-state-event.js","import { Browser, OS } from 'environment/environment';\r\nimport SimpleModel from 'model/simplemodel';\r\nimport { INITIAL_PLAYER_STATE } from 'model/player-model';\r\nimport Providers from 'providers/providers';\r\nimport { loadProvidersForPlaylist } from 'api/set-playlist';\r\nimport getMediaElement from 'api/get-media-element';\r\nimport initQoe from 'controller/qoe';\r\nimport { PLAYER_STATE, STATE_IDLE, STATE_BUFFERING, STATE_PAUSED, STATE_COMPLETE, MEDIA_VOLUME, MEDIA_MUTE,\r\n    MEDIA_TYPE, PROVIDER_CHANGED, AUDIO_TRACKS, AUDIO_TRACK_CHANGED,\r\n    MEDIA_PLAY_ATTEMPT, MEDIA_PLAY_ATTEMPT_FAILED, MEDIA_RATE_CHANGE,\r\n    MEDIA_BUFFER, MEDIA_TIME, MEDIA_LEVELS, MEDIA_LEVEL_CHANGED, MEDIA_ERROR, ERROR,\r\n    MEDIA_BEFORECOMPLETE, MEDIA_COMPLETE, MEDIA_META } from 'events/events';\r\nimport { seconds } from 'utils/strings';\r\nimport _ from 'utils/underscore';\r\nimport Events from 'utils/backbone.events';\r\nimport { resolved } from 'polyfills/promise';\r\nimport cancelable from 'utils/cancelable';\r\n\r\n// Represents the state of the player\r\nconst Model = function() {\r\n    const _this = this;\r\n    let _providers;\r\n    let _provider;\r\n    let _beforecompleted = false;\r\n    let _attached = true;\r\n    let thenPlayPromise = cancelable(function() {});\r\n    let providerPromise = resolved;\r\n\r\n    this.mediaController = Object.assign({}, Events);\r\n    this.mediaModel = new MediaModel();\r\n\r\n    initQoe(this);\r\n\r\n    this.set('mediaModel', this.mediaModel);\r\n\r\n    this.setup = function(config) {\r\n\r\n        Object.assign(this.attributes, config, INITIAL_PLAYER_STATE);\r\n\r\n        this.updateProviders();\r\n        this.setAutoStart();\r\n\r\n        return this;\r\n    };\r\n\r\n    this.getConfiguration = function() {\r\n        const config = this.clone();\r\n        delete config.mediaModel;\r\n        return config;\r\n    };\r\n\r\n    this.updateProviders = function() {\r\n        _providers = new Providers(this.getConfiguration());\r\n    };\r\n\r\n    function _videoEventHandler(type, data) {\r\n        const event = Object.assign({}, data, {\r\n            type: type\r\n        });\r\n        const mediaModel = this.mediaModel;\r\n        switch (type) {\r\n            case 'flashThrottle': {\r\n                const throttled = (data.state !== 'resume');\r\n                this.set('flashThrottle', throttled);\r\n                this.set('flashBlocked', throttled);\r\n            }\r\n                break;\r\n            case 'flashBlocked':\r\n                this.set('flashBlocked', true);\r\n                return;\r\n            case 'flashUnblocked':\r\n                this.set('flashBlocked', false);\r\n                return;\r\n            case MEDIA_VOLUME:\r\n                this.set(type, data[type]);\r\n                return;\r\n            case MEDIA_MUTE:\r\n                if (!this.get('autostartMuted')) {\r\n                    // Don't persist mute state with muted autostart\r\n                    this.set(type, data[type]);\r\n                }\r\n                return;\r\n            case MEDIA_RATE_CHANGE: {\r\n                const rate = data.playbackRate;\r\n                // Check if its a generally usable rate.  Shaka changes rate to 0 when pause or buffering.\r\n                if (rate > 0) {\r\n                    this.set('playbackRate', rate);\r\n                }\r\n            }\r\n                return;\r\n            case MEDIA_TYPE:\r\n                if (mediaModel.get('mediaType') !== data.mediaType) {\r\n                    mediaModel.set('mediaType', data.mediaType);\r\n                    this.mediaController.trigger(type, event);\r\n                }\r\n                return;\r\n            case PLAYER_STATE: {\r\n                if (data.newstate === STATE_IDLE) {\r\n                    thenPlayPromise.cancel();\r\n                    mediaModel.srcReset();\r\n                }\r\n                // Always fire change:state to keep player model in sync\r\n                const previousState = mediaModel.attributes[PLAYER_STATE];\r\n                mediaModel.attributes[PLAYER_STATE] = data.newstate;\r\n                mediaModel.trigger('change:' + PLAYER_STATE, mediaModel, data.newstate, previousState);\r\n\r\n            }\r\n                // This \"return\" is important because\r\n                //  we are choosing to not propagate this event.\r\n                //  Instead letting the master controller do so\r\n                return;\r\n            case MEDIA_ERROR:\r\n                thenPlayPromise.cancel();\r\n                mediaModel.srcReset();\r\n                break;\r\n            case MEDIA_BUFFER:\r\n                this.set('buffer', data.bufferPercent);\r\n            /* falls through */\r\n            case MEDIA_META: {\r\n                const duration = data.duration;\r\n                if (_.isNumber(duration) && !_.isNaN(duration)) {\r\n                    mediaModel.set('duration', duration);\r\n                    this.set('duration', duration);\r\n                }\r\n                Object.assign(this.get('itemMeta'), data.metadata);\r\n                break;\r\n            }\r\n            case MEDIA_TIME: {\r\n                mediaModel.set('position', data.position);\r\n                this.set('position', data.position);\r\n                const duration = data.duration;\r\n                if (_.isNumber(duration) && !_.isNaN(duration)) {\r\n                    mediaModel.set('duration', duration);\r\n                    this.set('duration', duration);\r\n                }\r\n                break;\r\n            }\r\n            case PROVIDER_CHANGED:\r\n                this.set('provider', _provider.getName());\r\n                break;\r\n            case MEDIA_LEVELS:\r\n                this.setQualityLevel(data.currentQuality, data.levels);\r\n                mediaModel.set('levels', data.levels);\r\n                break;\r\n            case MEDIA_LEVEL_CHANGED:\r\n                this.setQualityLevel(data.currentQuality, data.levels);\r\n                this.persistQualityLevel(data.currentQuality, data.levels);\r\n                break;\r\n            case MEDIA_COMPLETE:\r\n                _beforecompleted = true;\r\n                this.mediaController.trigger(MEDIA_BEFORECOMPLETE, event);\r\n                if (_attached) {\r\n                    this.playbackComplete();\r\n                }\r\n                return;\r\n            case AUDIO_TRACKS:\r\n                this.setCurrentAudioTrack(data.currentTrack, data.tracks);\r\n                mediaModel.set('audioTracks', data.tracks);\r\n                break;\r\n            case AUDIO_TRACK_CHANGED:\r\n                this.setCurrentAudioTrack(data.currentTrack, data.tracks);\r\n                break;\r\n            case 'subtitlesTrackChanged':\r\n                this.persistVideoSubtitleTrack(data.currentTrack, data.tracks);\r\n                break;\r\n            case 'visualQuality':\r\n                mediaModel.set('visualQuality', Object.assign({}, data));\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n\r\n        this.mediaController.trigger(type, event);\r\n    }\r\n\r\n    this.setQualityLevel = function(quality, levels) {\r\n        if (quality > -1 && levels.length > 1) {\r\n            this.mediaModel.set('currentLevel', parseInt(quality));\r\n        }\r\n    };\r\n\r\n    this.persistQualityLevel = function(quality, levels) {\r\n        var currentLevel = levels[quality] || {};\r\n        var label = currentLevel.label;\r\n        this.set('qualityLabel', label);\r\n    };\r\n\r\n    this.setCurrentAudioTrack = function(currentTrack, tracks) {\r\n        if (currentTrack > -1 && tracks.length > 0 && currentTrack < tracks.length) {\r\n            this.mediaModel.set('currentAudioTrack', parseInt(currentTrack));\r\n        }\r\n    };\r\n\r\n    this.onMediaContainer = function() {\r\n        var container = this.get('mediaContainer');\r\n        _provider.setContainer(container);\r\n    };\r\n\r\n    this.changeVideoProvider = function(Provider) {\r\n        this.off('change:mediaContainer', this.onMediaContainer);\r\n\r\n        if (_provider) {\r\n            _provider.off(null, null, this);\r\n            if (_provider.getContainer()) {\r\n                _provider.remove();\r\n            }\r\n            delete _provider.instreamMode;\r\n        }\r\n\r\n        if (!Provider) {\r\n            this.resetProvider();\r\n            this.set('provider', undefined);\r\n            return;\r\n        }\r\n\r\n        _provider = new Provider(_this.get('id'), _this.getConfiguration());\r\n\r\n        var container = this.get('mediaContainer');\r\n        if (container) {\r\n            _provider.setContainer(container);\r\n        } else {\r\n            this.once('change:mediaContainer', this.onMediaContainer);\r\n        }\r\n\r\n        if (_provider.getName().name.indexOf('flash') === -1) {\r\n            this.set('flashThrottle', undefined);\r\n            this.set('flashBlocked', false);\r\n        }\r\n\r\n        _provider.volume(_this.get('volume'));\r\n\r\n        // Mute the video if autostarting on mobile, except for Android SDK. Otherwise, honor the model's mute value\r\n        const isAndroidSdk = _this.get('sdkplatform') === 1;\r\n        _provider.mute((this.autoStartOnMobile() && !isAndroidSdk) || _this.get('mute'));\r\n\r\n        _provider.on('all', _videoEventHandler, this);\r\n\r\n        // Attempt setting the playback rate to be the user selected value\r\n        this.setPlaybackRate(this.get('defaultPlaybackRate'));\r\n\r\n        // Set playbackRate because provider support for playbackRate may have changed and not sent an update\r\n        this.set('playbackRate', _provider.getPlaybackRate());\r\n\r\n        if (this.get('instreamMode') === true) {\r\n            _provider.instreamMode = true;\r\n        }\r\n\r\n        this.set('renderCaptionsNatively', _provider.renderNatively);\r\n    };\r\n\r\n    this.checkComplete = function() {\r\n        return _beforecompleted;\r\n    };\r\n\r\n    this.detachMedia = function() {\r\n        thenPlayPromise.cancel();\r\n        _attached = false;\r\n        if (_provider) {\r\n            _provider.off('all', _videoEventHandler, this);\r\n            _provider.detachMedia();\r\n        }\r\n    };\r\n\r\n    this.attachMedia = function() {\r\n        _attached = true;\r\n        if (_provider) {\r\n            _provider.off('all', _videoEventHandler, this);\r\n            _provider.on('all', _videoEventHandler, this);\r\n        }\r\n        if (_beforecompleted) {\r\n            this.playbackComplete();\r\n        }\r\n        if (_provider) {\r\n            _provider.attachMedia();\r\n        }\r\n\r\n        // Restore the playback rate to the provider in case it changed while detached and we reused a video tag.\r\n        this.setPlaybackRate(this.get('defaultPlaybackRate'));\r\n    };\r\n\r\n    this.playbackComplete = function() {\r\n        _beforecompleted = false;\r\n        _provider.setState(STATE_COMPLETE);\r\n        this.mediaController.trigger(MEDIA_COMPLETE, {});\r\n    };\r\n\r\n    this.destroy = function() {\r\n        this.attributes._destroyed = true;\r\n        this.off();\r\n        if (_provider) {\r\n            _provider.off(null, null, this);\r\n            _provider.destroy();\r\n        }\r\n    };\r\n\r\n    this.getVideo = function() {\r\n        return _provider;\r\n    };\r\n\r\n    this.setFullscreen = function(state) {\r\n        state = !!state;\r\n        if (state !== _this.get('fullscreen')) {\r\n            _this.set('fullscreen', state);\r\n        }\r\n    };\r\n\r\n    // Give the option for a provider to be forced\r\n    this.chooseProvider = function(source) {\r\n        // if _providers.choose is null, something went wrong in filtering\r\n        return _providers.choose(source).provider;\r\n    };\r\n\r\n    this.setItemIndex = function(index) {\r\n        const playlist = this.get('playlist');\r\n        const length = playlist.length;\r\n\r\n        // If looping past the end, or before the beginning\r\n        index = parseInt(index, 10) || 0;\r\n        index = (index + length) % length;\r\n\r\n        this.set('item', index);\r\n        return this.setActiveItem(playlist[index]);\r\n    };\r\n\r\n    this.setActiveItem = function(item) {\r\n        thenPlayPromise.cancel();\r\n        // Item is actually changing\r\n        this.mediaModel.off();\r\n        this.mediaModel = new MediaModel();\r\n        resetItem(this, item);\r\n        this.set('minDvrWindow', item.minDvrWindow);\r\n        this.set('mediaModel', this.mediaModel);\r\n        this.attributes.playlistItem = null;\r\n        this.set('playlistItem', item);\r\n        providerPromise = this.setProvider(item);\r\n        return providerPromise;\r\n    };\r\n\r\n    function resetItem(model, item) {\r\n        const position = item ? seconds(item.starttime) : 0;\r\n        const duration = item ? seconds(item.duration) : 0;\r\n        const mediaModelState = model.mediaModel.attributes;\r\n        model.mediaModel.srcReset();\r\n        mediaModelState.position = position;\r\n        mediaModelState.duration = duration;\r\n\r\n        model.set('playRejected', false);\r\n        model.set('itemMeta', {});\r\n        model.set('position', position);\r\n        model.set('duration', duration);\r\n    }\r\n\r\n    this.setProvider = function(item) {\r\n        const source = item && item.sources && item.sources[0];\r\n        if (source === undefined) {\r\n            // source is undefined when resetting index with empty playlist\r\n            throw new Error('No media');\r\n        }\r\n\r\n        const Provider = this.chooseProvider(source);\r\n        // If we are changing video providers\r\n        if (!Provider || !(_provider && _provider instanceof Provider)) {\r\n            // Replace the video tag for the next provider\r\n            if (_provider) {\r\n                replaceMediaElement(this);\r\n            }\r\n            this.changeVideoProvider(Provider);\r\n        }\r\n\r\n        if (!_provider) {\r\n            this.set(PLAYER_STATE, STATE_BUFFERING);\r\n            const mediaModelContext = this.mediaModel;\r\n            return loadProvidersForPlaylist(this).then(() => {\r\n                if (mediaModelContext === this.mediaModel) {\r\n                    syncPlayerWithMediaModel(mediaModelContext);\r\n                    // Verify that we have a provider class for this source\r\n                    if (this.chooseProvider(source)) {\r\n                        return this.setProvider(item);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        // this allows the providers to preload\r\n        if (_provider.init) {\r\n            _provider.init(item);\r\n        }\r\n\r\n        // Set the Provider after calling init because some Provider properties are only set afterwards\r\n        this.set('provider', _provider.getName());\r\n\r\n        // Listening for change:item won't suffice when loading the same index or file\r\n        // We also can't listen for change:mediaModel because it triggers whether or not\r\n        //  an item was actually loaded\r\n        this.trigger('itemReady', item);\r\n        return resolved;\r\n    };\r\n\r\n    function replaceMediaElement(model) {\r\n        // Replace click-to-play media element, and call .load() to unblock user-gesture to play requirement\r\n        const lastMediaElement = model.attributes.mediaElement;\r\n        const mediaElement =\r\n            model.attributes.mediaElement = getMediaElement();\r\n        mediaElement.volume = lastMediaElement.volume;\r\n        mediaElement.muted = lastMediaElement.muted;\r\n        mediaElement.load();\r\n    }\r\n\r\n    this.getProviders = function() {\r\n        return _providers;\r\n    };\r\n\r\n    this.resetProvider = function() {\r\n        _provider = null;\r\n    };\r\n\r\n    this.setVolume = function(volume) {\r\n        volume = Math.round(volume);\r\n        this.set('volume', volume);\r\n        if (_provider) {\r\n            _provider.volume(volume);\r\n        }\r\n        var mute = (volume === 0);\r\n        if (mute !== (this.getMute())) {\r\n            this.setMute(mute);\r\n        }\r\n    };\r\n\r\n    this.getMute = function() {\r\n        return this.get('autostartMuted') || this.get('mute');\r\n    };\r\n\r\n    this.setMute = function(mute) {\r\n        if (mute === undefined) {\r\n            mute = !(this.getMute());\r\n        }\r\n        this.set('mute', mute);\r\n        if (_provider) {\r\n            _provider.mute(mute);\r\n        }\r\n        if (!mute) {\r\n            var volume = Math.max(10, this.get('volume'));\r\n            this.set('autostartMuted', false);\r\n            this.setVolume(volume);\r\n        }\r\n    };\r\n\r\n    this.setStreamType = function(streamType) {\r\n        this.set('streamType', streamType);\r\n        if (streamType === 'LIVE') {\r\n            this.setPlaybackRate(1);\r\n        }\r\n    };\r\n\r\n    this.setPlaybackRate = function(playbackRate) {\r\n        if (!_attached || !_.isNumber(playbackRate)) {\r\n            return;\r\n        }\r\n\r\n        // Clamp the rate between 0.25x and 4x\r\n        playbackRate = Math.max(Math.min(playbackRate, 4), 0.25);\r\n\r\n        if (this.get('streamType') === 'LIVE') {\r\n            playbackRate = 1;\r\n        }\r\n\r\n        this.set('defaultPlaybackRate', playbackRate);\r\n\r\n        if (_provider && _provider.setPlaybackRate) {\r\n            _provider.setPlaybackRate(playbackRate);\r\n        }\r\n    };\r\n\r\n    function loadAndPlay(model, item) {\r\n        thenPlayPromise.cancel();\r\n\r\n        const mediaModelContext = model.mediaModel;\r\n\r\n        mediaModelContext.set('setup', true);\r\n        if (_provider) {\r\n            return playWithProvider(item);\r\n        }\r\n\r\n        thenPlayPromise = cancelable(() => {\r\n            if (mediaModelContext === model.mediaModel) {\r\n                return playWithProvider(item);\r\n            }\r\n            throw new Error('Playback cancelled.');\r\n        });\r\n        return providerPromise.catch(error => {\r\n            thenPlayPromise.cancel();\r\n            // Required provider was not loaded\r\n            model.trigger(ERROR, {\r\n                message: `Could not play video: ${error.message}`,\r\n                error: error\r\n            });\r\n            // Fail the playPromise to trigger \"playAttemptFailed\"\r\n            throw error;\r\n        }).then(thenPlayPromise.async);\r\n    }\r\n\r\n    function playWithProvider(item) {\r\n        // Calling load() on Shaka may return a player setup promise\r\n        const providerSetupPromise = _provider.load(item);\r\n        if (providerSetupPromise) {\r\n            thenPlayPromise = cancelable(() => {\r\n                return _provider.play() || resolved;\r\n            });\r\n            return providerSetupPromise.then(thenPlayPromise.async);\r\n        }\r\n        return _provider.play() || resolved;\r\n    }\r\n\r\n    function playAttempt(model, playPromise, playReason) {\r\n        const mediaModelContext = model.mediaModel;\r\n        const itemContext = model.get('playlistItem');\r\n\r\n        model.mediaController.trigger(MEDIA_PLAY_ATTEMPT, {\r\n            item: itemContext,\r\n            playReason: playReason\r\n        });\r\n\r\n        // Immediately set player state to buffering if these conditions are met\r\n        const videoTagUnpaused = _provider && _provider.video && !_provider.video.paused;\r\n        if (videoTagUnpaused) {\r\n            model.set(PLAYER_STATE, STATE_BUFFERING);\r\n        }\r\n\r\n        playPromise.then(() => {\r\n            if (!mediaModelContext.get('setup')) {\r\n                // Exit if model state was reset\r\n                return;\r\n            }\r\n            mediaModelContext.set('started', true);\r\n            if (mediaModelContext === model.mediaModel) {\r\n                syncPlayerWithMediaModel(mediaModelContext);\r\n            }\r\n        }).catch(error => {\r\n            model.set('playRejected', true);\r\n            const videoTagPaused = _provider && _provider.video && _provider.video.paused;\r\n            if (videoTagPaused) {\r\n                mediaModelContext.set(PLAYER_STATE, STATE_PAUSED);\r\n            }\r\n            model.mediaController.trigger(MEDIA_PLAY_ATTEMPT_FAILED, {\r\n                error: error,\r\n                item: itemContext,\r\n                playReason: playReason\r\n            });\r\n        });\r\n    }\r\n\r\n    function syncPlayerWithMediaModel(mediaModel) {\r\n        // Sync player state with mediaModel state\r\n        const mediaState = mediaModel.get('state');\r\n        mediaModel.trigger('change:state', mediaModel, mediaState, mediaState);\r\n    }\r\n\r\n    this.stopVideo = function() {\r\n        thenPlayPromise.cancel();\r\n        const item = this.get('playlist')[this.get('item')];\r\n        this.attributes.playlistItem = item;\r\n        resetItem(this, item);\r\n        if (_provider) {\r\n            _provider.stop();\r\n        }\r\n    };\r\n\r\n    this.preloadVideo = function() {\r\n        const item = this.get('playlistItem');\r\n        // Only attempt to preload if media is attached and hasn't been loaded\r\n        if (this.get('state') === 'idle' && _attached && _provider &&\r\n            item.preload !== 'none' &&\r\n            this.get('autostart') === false &&\r\n            !this.mediaModel.get('setup') &&\r\n            !this.mediaModel.get('preloaded')) {\r\n            this.mediaModel.set('preloaded', true);\r\n            _provider.preload(item);\r\n        }\r\n    };\r\n\r\n    this.playVideo = function(playReason) {\r\n        const item = this.get('playlistItem');\r\n        if (!item) {\r\n            return;\r\n        }\r\n\r\n        if (!playReason) {\r\n            playReason = this.get('playReason');\r\n        }\r\n\r\n        let playPromise;\r\n\r\n        this.set('playRejected', false);\r\n        if (!this.mediaModel.get('setup')) {\r\n            playPromise = loadAndPlay(this, item);\r\n            playAttempt(this, playPromise, playReason);\r\n        } else {\r\n            playPromise = _provider.play() || resolved;\r\n            if (!this.mediaModel.get('started')) {\r\n                playAttempt(this, playPromise, playReason);\r\n            }\r\n        }\r\n        return playPromise;\r\n    };\r\n\r\n    this.persistCaptionsTrack = function() {\r\n        var track = this.get('captionsTrack');\r\n\r\n        if (track) {\r\n            // update preference if an option was selected\r\n            this.set('captionLabel', track.name);\r\n        } else {\r\n            this.set('captionLabel', 'Off');\r\n        }\r\n    };\r\n\r\n\r\n    this.setVideoSubtitleTrack = function(trackIndex, tracks) {\r\n        this.set('captionsIndex', trackIndex);\r\n        /*\r\n         * Tracks could have changed even if the index hasn't.\r\n         * Need to ensure track has data for captionsrenderer.\r\n         */\r\n        if (trackIndex && tracks && trackIndex <= tracks.length && tracks[trackIndex - 1].data) {\r\n            this.set('captionsTrack', tracks[trackIndex - 1]);\r\n        }\r\n\r\n        if (_provider && _provider.setSubtitlesTrack) {\r\n            _provider.setSubtitlesTrack(trackIndex);\r\n        }\r\n    };\r\n\r\n    this.persistVideoSubtitleTrack = function(trackIndex, tracks) {\r\n        this.setVideoSubtitleTrack(trackIndex, tracks);\r\n        this.persistCaptionsTrack();\r\n    };\r\n\r\n    function _autoStartSupportedIOS() {\r\n        if (!OS.iOS) {\r\n            return false;\r\n        }\r\n        // Autostart only supported in iOS 10 or higher - check if the version is 9 or less\r\n        return OS.version.major >= 10;\r\n    }\r\n\r\n    function platformCanAutostart() {\r\n        var autostartAdsIsEnabled = (!_this.get('advertising') || _this.get('advertising').autoplayadsmuted);\r\n        var iosBrowserIsSupported = _autoStartSupportedIOS() && (Browser.safari || Browser.chrome || Browser.facebook);\r\n        var androidBrowserIsSupported = OS.android && Browser.chrome;\r\n        var mobileBrowserIsSupported = (iosBrowserIsSupported || androidBrowserIsSupported);\r\n        var isAndroidSdk = _this.get('sdkplatform') === 1;\r\n        return (!_this.get('sdkplatform') && autostartAdsIsEnabled && mobileBrowserIsSupported) || isAndroidSdk;\r\n    }\r\n\r\n    this.autoStartOnMobile = function() {\r\n        return this.get('autostart') && platformCanAutostart();\r\n    };\r\n\r\n    // Mobile players always wait to become viewable.\r\n    // Desktop players must have autostart set to viewable\r\n    this.setAutoStart = function(autoStart) {\r\n        if (autoStart !== undefined) {\r\n            this.set('autostart', autoStart);\r\n        }\r\n\r\n        const autoStartOnMobile = this.autoStartOnMobile();\r\n        const isAndroidSdk = _this.get('sdkplatform') === 1;\r\n        if (autoStartOnMobile && !isAndroidSdk) {\r\n            this.set('autostartMuted', true);\r\n        }\r\n        this.set('playOnViewable', autoStartOnMobile || this.get('autostart') === 'viewable');\r\n    };\r\n};\r\n\r\n// Represents the state of the provider/media element\r\nconst MediaModel = Model.MediaModel = function() {\r\n    this.attributes = {\r\n        state: STATE_IDLE\r\n    };\r\n};\r\n\r\nObject.assign(MediaModel.prototype, SimpleModel, {\r\n    srcReset() {\r\n        const attributes = this.attributes;\r\n        attributes.setup = false;\r\n        attributes.started = false;\r\n        attributes.preloaded = false;\r\n        attributes.visualQuality = null;\r\n    }\r\n});\r\n\r\nObject.assign(Model.prototype, SimpleModel);\r\n\r\nexport default Model;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/controller/model.js","export const requestAnimationFrame = window.requestAnimationFrame || function (callback) {\r\n    return setTimeout(callback, 17);\r\n};\r\n\r\nexport const cancelAnimationFrame = window.cancelAnimationFrame || clearTimeout;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/request-animation-frame.js","import { replaceClass } from 'utils/dom';\r\n\r\nexport function getBreakpoint(width) {\r\n    let breakpoint = 0;\r\n\r\n    if (width >= 1280) {\r\n        breakpoint = 7;\r\n    } else if (width >= 960) {\r\n        breakpoint = 6;\r\n    } else if (width >= 800) {\r\n        breakpoint = 5;\r\n    } else if (width >= 640) {\r\n        breakpoint = 4;\r\n    } else if (width >= 540) {\r\n        breakpoint = 3;\r\n    } else if (width >= 420) {\r\n        breakpoint = 2;\r\n    } else if (width >= 320) {\r\n        breakpoint = 1;\r\n    }\r\n\r\n    return breakpoint;\r\n}\r\n\r\nexport function setBreakpoint(playerElement, breakpointNumber) {\r\n    const breakpointClass = 'jw-breakpoint-' + breakpointNumber;\r\n    replaceClass(playerElement, /jw-breakpoint-\\d+/, breakpointClass);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/view/utils/breakpoint.js","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader/lib/css-base.js\n// module id = 77\n// module chunks = 0 1 2 3 4 5","import { resolved } from 'polyfills/promise';\r\n\r\nexport default function cancelable(callback) {\r\n    let cancelled = false;\r\n\r\n    return {\r\n        async: function() {\r\n            const args = arguments;\r\n            return resolved.then(() => {\r\n                if (cancelled) {\r\n                    return;\r\n                }\r\n                return callback.apply(this, args);\r\n            });\r\n        },\r\n        cancel: () => {\r\n            cancelled = true;\r\n        },\r\n        cancelled: () => cancelled\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/cancelable.js","export default (function() {\r\n    if ('hidden' in document) {\r\n        return function () {\r\n            return !document.hidden;\r\n        };\r\n    }\r\n    if ('webkitHidden' in document) {\r\n        return function () {\r\n            return !document.webkitHidden;\r\n        };\r\n    }\r\n    // document.hidden not supported\r\n    return function () {\r\n        return true;\r\n    };\r\n}());\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/active-tab.js","import VTTCue from 'parsers/captions/vttcue';\r\nimport { chunkLoadErrorHandler } from '../api/core-loader';\r\nimport utils from 'utils/helpers';\r\nimport { localName } from 'parsers/parsers';\r\nimport srt from 'parsers/captions/srt';\r\nimport dfxp from 'parsers/captions/dfxp';\r\n\r\nexport function loadFile(track, successHandler, errorHandler) {\r\n    track.xhr = utils.ajax(track.file, function(xhr) {\r\n        xhrSuccess(xhr, track, successHandler, errorHandler);\r\n    }, errorHandler);\r\n}\r\n\r\nexport function cancelXhr(tracks) {\r\n    if (tracks) {\r\n        tracks.forEach(track => {\r\n            var xhr = track.xhr;\r\n            if (xhr) {\r\n                xhr.onload = null;\r\n                xhr.onreadystatechange = null;\r\n                xhr.onerror = null;\r\n                if ('abort' in xhr) {\r\n                    xhr.abort();\r\n                }\r\n            }\r\n            delete track.xhr;\r\n        });\r\n    }\r\n}\r\n\r\nexport function convertToVTTCues(cues) {\r\n    // VTTCue is available natively or polyfilled where necessary\r\n    return cues.map(cue => new VTTCue(cue.begin, cue.end, cue.text));\r\n}\r\n\r\nfunction xhrSuccess(xhr, track, successHandler, errorHandler) {\r\n    var xmlRoot = xhr.responseXML ? xhr.responseXML.firstChild : null;\r\n    var cues;\r\n    var vttCues;\r\n\r\n    // IE9 sets the firstChild element to the root <xml> tag\r\n    if (xmlRoot) {\r\n        if (localName(xmlRoot) === 'xml') {\r\n            xmlRoot = xmlRoot.nextSibling;\r\n        }\r\n        // Ignore all comments\r\n        while (xmlRoot.nodeType === xmlRoot.COMMENT_NODE) {\r\n            xmlRoot = xmlRoot.nextSibling;\r\n        }\r\n    }\r\n\r\n    try {\r\n        if (xmlRoot && localName(xmlRoot) === 'tt') {\r\n            // parse dfxp track\r\n            cues = dfxp(xhr.responseXML);\r\n            vttCues = convertToVTTCues(cues);\r\n            delete track.xhr;\r\n            successHandler(vttCues);\r\n        } else {\r\n            // parse VTT/SRT track\r\n            var responseText = xhr.responseText;\r\n            if (responseText.indexOf('WEBVTT') >= 0) {\r\n                // make VTTCues from VTT track\r\n                loadVttParser().then(VTTParser => {\r\n                    var parser = new VTTParser(window);\r\n                    vttCues = [];\r\n                    parser.oncue = function(cue) {\r\n                        vttCues.push(cue);\r\n                    };\r\n\r\n                    parser.onflush = function() {\r\n                        delete track.xhr;\r\n                        successHandler(vttCues);\r\n                    };\r\n\r\n                    // Parse calls onflush internally\r\n                    parser.parse(responseText);\r\n                }).catch(error => {\r\n                    delete track.xhr;\r\n                    errorHandler(error);\r\n                });\r\n            } else {\r\n                // make VTTCues from SRT track\r\n                cues = srt(responseText);\r\n                vttCues = convertToVTTCues(cues);\r\n                delete track.xhr;\r\n                successHandler(vttCues);\r\n            }\r\n        }\r\n    } catch (error) {\r\n        delete track.xhr;\r\n        errorHandler(error);\r\n    }\r\n}\r\n\r\nfunction loadVttParser() {\r\n    return require.ensure(['parsers/captions/vttparser'], function (require) {\r\n        return require('parsers/captions/vttparser').default;\r\n    }, chunkLoadErrorHandler, 'vttparser');\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/controller/tracks-loader.js","export function createId(track, tracksCount) {\r\n    var trackId;\r\n    var prefix = track.kind || 'cc';\r\n    if (track.default || track.defaulttrack) {\r\n        trackId = 'default';\r\n    } else {\r\n        trackId = track._id || track.file || (prefix + tracksCount);\r\n    }\r\n    return trackId;\r\n}\r\n\r\nexport function createLabel(track, unknownCount) {\r\n    var label = track.label || track.name || track.language;\r\n    if (!label) {\r\n        label = 'Unknown CC';\r\n        unknownCount += 1;\r\n        if (unknownCount > 1) {\r\n            label += ' [' + unknownCount + ']';\r\n        }\r\n    }\r\n    return { label: label, unknownCount: unknownCount };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/controller/tracks-helper.js","/**\r\n * Copyright 2013 vtt.js Contributors\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n*/\r\n\r\nlet VTTCue = window.VTTCue;\r\n\r\nfunction findDirectionSetting(value) {\r\n    if (typeof value !== 'string') {\r\n        return false;\r\n    }\r\n    const directionSetting = {\r\n        '': true,\r\n        lr: true,\r\n        rl: true\r\n    };\r\n    const dir = directionSetting[value.toLowerCase()];\r\n    return dir ? value.toLowerCase() : false;\r\n}\r\n\r\nfunction findAlignSetting(value) {\r\n    if (typeof value !== 'string') {\r\n        return false;\r\n    }\r\n    const alignSetting = {\r\n        start: true,\r\n        middle: true,\r\n        end: true,\r\n        left: true,\r\n        right: true\r\n    };\r\n    const align = alignSetting[value.toLowerCase()];\r\n    return align ? value.toLowerCase() : false;\r\n}\r\n\r\nif (!VTTCue) {\r\n    const autoKeyword = 'auto';\r\n\r\n    VTTCue = function(startTime, endTime, text) {\r\n        const cue = this;\r\n\r\n        /**\r\n         * Shim implementation specific properties. These properties are not in\r\n         * the spec.\r\n         */\r\n\r\n        // Lets us know when the VTTCue's data has changed in such a way that we need\r\n        // to recompute its display state. This lets us compute its display state\r\n        // lazily.\r\n        cue.hasBeenReset = false;\r\n\r\n        /**\r\n         * VTTCue and TextTrackCue properties\r\n         * http://dev.w3.org/html5/webvtt/#vttcue-interface\r\n         */\r\n\r\n        let _id = '';\r\n        let _pauseOnExit = false;\r\n        let _startTime = startTime;\r\n        let _endTime = endTime;\r\n        let _text = text;\r\n        let _region = null;\r\n        let _vertical = '';\r\n        let _snapToLines = true;\r\n        let _line = autoKeyword;\r\n        let _lineAlign = 'start';\r\n        let _position = autoKeyword;\r\n        let _size = 100;\r\n        let _align = 'middle';\r\n\r\n        Object.defineProperty(cue, 'id', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _id;\r\n            },\r\n            set: function (value) {\r\n                _id = '' + value;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'pauseOnExit', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _pauseOnExit;\r\n            },\r\n            set: function (value) {\r\n                _pauseOnExit = !!value;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'startTime', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _startTime;\r\n            },\r\n            set: function (value) {\r\n                if (typeof value !== 'number') {\r\n                    throw new TypeError('Start time must be set to a number.');\r\n                }\r\n                _startTime = value;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'endTime', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _endTime;\r\n            },\r\n            set: function (value) {\r\n                if (typeof value !== 'number') {\r\n                    throw new TypeError('End time must be set to a number.');\r\n                }\r\n                _endTime = value;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'text', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _text;\r\n            },\r\n            set: function (value) {\r\n                _text = '' + value;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'region', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _region;\r\n            },\r\n            set: function (value) {\r\n                _region = value;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'vertical', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _vertical;\r\n            },\r\n            set: function (value) {\r\n                const setting = findDirectionSetting(value);\r\n                // Have to check for false because the setting an be an empty string.\r\n                if (setting === false) {\r\n                    throw new SyntaxError('An invalid or illegal string was specified.');\r\n                }\r\n                _vertical = setting;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'snapToLines', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _snapToLines;\r\n            },\r\n            set: function (value) {\r\n                _snapToLines = !!value;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'line', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _line;\r\n            },\r\n            set: function (value) {\r\n                if (typeof value !== 'number' && value !== autoKeyword) {\r\n                    throw new SyntaxError('An invalid number or illegal string was specified.');\r\n                }\r\n                _line = value;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'lineAlign', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _lineAlign;\r\n            },\r\n            set: function (value) {\r\n                const setting = findAlignSetting(value);\r\n                if (!setting) {\r\n                    throw new SyntaxError('An invalid or illegal string was specified.');\r\n                }\r\n                _lineAlign = setting;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'position', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _position;\r\n            },\r\n            set: function (value) {\r\n                if (value < 0 || value > 100) {\r\n                    throw new Error('Position must be between 0 and 100.');\r\n                }\r\n                _position = value;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'size', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _size;\r\n            },\r\n            set: function (value) {\r\n                if (value < 0 || value > 100) {\r\n                    throw new Error('Size must be between 0 and 100.');\r\n                }\r\n                _size = value;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'align', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _align;\r\n            },\r\n            set: function (value) {\r\n                const setting = findAlignSetting(value);\r\n                if (!setting) {\r\n                    throw new SyntaxError('An invalid or illegal string was specified.');\r\n                }\r\n                _align = setting;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        /**\r\n         * Other <track> spec defined properties\r\n         */\r\n\r\n        // http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#text-track-cue-display-state\r\n        cue.displayState = undefined;\r\n    };\r\n\r\n    /**\r\n     * VTTCue methods\r\n     */\r\n\r\n    VTTCue.prototype.getCueAsHTML = function () {\r\n        // Assume WebVTT.convertCueToDOMTree is on the global.\r\n        const WebVTT = window.WebVTT;\r\n        return WebVTT.convertCueToDOMTree(window, this.text);\r\n    };\r\n}\r\n\r\nexport default VTTCue;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/parsers/captions/vttcue.js","import { seconds, trim } from 'utils/strings';\r\n\r\n// Component that loads and parses an DFXP file\r\n\r\nexport default function Dfxp(xmlDoc) {\r\n    validate(xmlDoc);\r\n    var _captions = [];\r\n    var paragraphs = xmlDoc.getElementsByTagName('p');\r\n    // Default frameRate is 30\r\n    var frameRate = 30;\r\n    var tt = xmlDoc.getElementsByTagName('tt');\r\n    if (tt && tt[0]) {\r\n        var parsedFrameRate = parseFloat(tt[0].getAttribute('ttp:frameRate'));\r\n        if (!isNaN(parsedFrameRate)) {\r\n            frameRate = parsedFrameRate;\r\n        }\r\n    }\r\n    validate(paragraphs);\r\n    if (!paragraphs.length) {\r\n        paragraphs = xmlDoc.getElementsByTagName('tt:p');\r\n        if (!paragraphs.length) {\r\n            paragraphs = xmlDoc.getElementsByTagName('tts:p');\r\n        }\r\n    }\r\n\r\n    for (var i = 0; i < paragraphs.length; i++) {\r\n        var p = paragraphs[i];\r\n\r\n        var breaks = p.getElementsByTagName('br');\r\n        for (var j = 0; j < breaks.length; j++) {\r\n            var b = breaks[j];\r\n            b.parentNode.replaceChild(xmlDoc.createTextNode('\\r\\n'), b);\r\n        }\r\n\r\n        var rawText = (p.innerHTML || p.textContent || p.text || '');\r\n        var text = trim(rawText).replace(/>\\s+</g, '><').replace(/(<\\/?)tts?:/g, '$1').replace(/<br.*?\\/>/g, '\\r\\n');\r\n        if (text) {\r\n            var begin = p.getAttribute('begin');\r\n            var dur = p.getAttribute('dur');\r\n            var end = p.getAttribute('end');\r\n\r\n            var entry = {\r\n                begin: seconds(begin, frameRate),\r\n                text: text\r\n            };\r\n            if (end) {\r\n                entry.end = seconds(end, frameRate);\r\n            } else if (dur) {\r\n                entry.end = entry.begin + seconds(dur, frameRate);\r\n            }\r\n            _captions.push(entry);\r\n        }\r\n    }\r\n    if (!_captions.length) {\r\n        parseError();\r\n    }\r\n    return _captions;\r\n}\r\n\r\nfunction validate(object) {\r\n    if (!object) {\r\n        parseError();\r\n    }\r\n}\r\n\r\nfunction parseError() {\r\n    throw new Error('Invalid DFXP file');\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/parsers/captions/dfxp.js","import _ from 'utils/underscore';\r\n\r\nconst supportedFields = [\r\n    'repeat',\r\n    'volume',\r\n    'mute',\r\n    'autostart'\r\n];\r\n\r\nfunction setAutoStart(model, controller, autoStart) {\r\n    model.setAutoStart(autoStart);\r\n\r\n    if (model.get('state') === 'idle' && autoStart === true) {\r\n        controller.play({ reason: 'autostart' });\r\n    }\r\n}\r\n\r\nexport default (controller, newConfig) => {\r\n    const model = controller._model;\r\n\r\n    if (!_.size(newConfig)) {\r\n        return;\r\n    }\r\n\r\n    supportedFields.forEach(field => {\r\n        const newValue = newConfig[field];\r\n\r\n        if (_.isUndefined(newValue)) {\r\n            return;\r\n        }\r\n\r\n        switch (field) {\r\n            case 'mute':\r\n                controller.setMute(newValue);\r\n                break;\r\n            case 'volume':\r\n                controller.setVolume(newValue);\r\n                break;\r\n            case 'autostart':\r\n                setAutoStart(model, controller, newValue);\r\n                break;\r\n            default:\r\n                model.set(field, newValue);\r\n        }\r\n    });\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/api/set-config.js","import { OS } from 'environment/environment';\r\nimport { STATE_BUFFERING, STATE_COMPLETE, STATE_PAUSED,\r\n    ERROR, MEDIA_META, MEDIA_TIME, MEDIA_COMPLETE,\r\n    PLAYLIST_ITEM, PLAYLIST_COMPLETE, INSTREAM_CLICK, AD_SKIPPED } from 'events/events';\r\nimport InstreamHtml5 from 'controller/instream-html5';\r\nimport InstreamFlash from 'controller/instream-flash';\r\nimport utils from 'utils/helpers';\r\nimport Events from 'utils/backbone.events';\r\nimport _ from 'utils/underscore';\r\n\r\nfunction chooseInstreamMethod(_model) {\r\n    var providerName = '';\r\n    var provider = _model.get('provider');\r\n    if (provider) {\r\n        providerName = provider.name;\r\n    }\r\n    if (providerName.indexOf('flash') >= 0) {\r\n        return InstreamFlash;\r\n    }\r\n\r\n    return InstreamHtml5;\r\n}\r\n\r\nvar _defaultOptions = {\r\n    skipoffset: null,\r\n    tag: null\r\n};\r\n\r\nvar InstreamAdapter = function(_controller, _model, _view) {\r\n    var InstreamMethod = chooseInstreamMethod(_model);\r\n    var _instream = new InstreamMethod(_controller, _model);\r\n\r\n    var _array;\r\n    var _arrayOptions;\r\n    var _arrayIndex = 0;\r\n    var _options = {};\r\n    var _oldpos;\r\n    var _olditem;\r\n    var _this = this;\r\n    var _skipAd = _instreamItemNext;\r\n\r\n    var _clickHandler = _.bind(function(evt) {\r\n        evt = evt || {};\r\n        evt.hasControls = !!_model.get('controls');\r\n\r\n        this.trigger(INSTREAM_CLICK, evt);\r\n\r\n        // toggle playback after click event\r\n        if (!_instream || !_instream._adModel) {\r\n            return;\r\n        }\r\n        if (_instream._adModel.get('state') === STATE_PAUSED) {\r\n            if (evt.hasControls) {\r\n                _instream.instreamPlay();\r\n            }\r\n        } else {\r\n            _instream.instreamPause();\r\n        }\r\n    }, this);\r\n\r\n    var _doubleClickHandler = _.bind(function() {\r\n        if (!_instream || !_instream._adModel) {\r\n            return;\r\n        }\r\n        if (_instream._adModel.get('state') === STATE_PAUSED) {\r\n            if (_model.get('controls')) {\r\n                _controller.setFullscreen();\r\n                _controller.play();\r\n            }\r\n        }\r\n    }, this);\r\n\r\n    this.type = 'instream';\r\n\r\n    this.init = function(sharedVideoTag) {\r\n        // Keep track of the original player state\r\n        const mediaElement = sharedVideoTag || _model.get('mediaElement');\r\n        _oldpos = _model.get('position');\r\n        _olditem = _model.get('playlist')[_model.get('item')];\r\n\r\n        _instream.on('all', _instreamForward, this);\r\n        _instream.on(MEDIA_TIME, _instreamTime, this);\r\n        _instream.on(MEDIA_COMPLETE, _instreamItemComplete, this);\r\n        _instream.init(mediaElement, _model.clone());\r\n\r\n        // Make sure the original player's provider stops broadcasting events (pseudo-lock...)\r\n        _controller.detachMedia();\r\n\r\n        // Let the element finish loading for mobile before calling pause\r\n        if (mediaElement) {\r\n            if (!mediaElement.paused) {\r\n                mediaElement.pause();\r\n            }\r\n            mediaElement.playbackRate = mediaElement.defaultPlaybackRate = 1;\r\n        }\r\n\r\n        if (_controller.checkBeforePlay() || (_oldpos === 0 && !_model.checkComplete())) {\r\n            // make sure video restarts after preroll\r\n            _oldpos = 0;\r\n        } else if (_model.checkComplete() || _model.get('state') === STATE_COMPLETE) {\r\n            _oldpos = null;\r\n        }\r\n\r\n        // Show instream state instead of normal player state\r\n        _model.set('adModel', _instream._adModel);\r\n        _view.setupInstream(_instream._adModel);\r\n        _instream._adModel.set('state', STATE_BUFFERING);\r\n\r\n        // don't trigger api play/pause on display click\r\n        if (_view.clickHandler()) {\r\n            _view.clickHandler().setAlternateClickHandlers(utils.noop, null);\r\n        }\r\n\r\n        this.setText(_model.get('localization').loadingAd);\r\n        return this;\r\n    };\r\n\r\n    function _loadNextItem() {\r\n        _arrayIndex++;\r\n        var item = _array[_arrayIndex];\r\n        var options;\r\n        if (_arrayOptions) {\r\n            options = _arrayOptions[_arrayIndex];\r\n        }\r\n        _this.loadItem(item, options);\r\n    }\r\n\r\n    function _instreamForward(type, data) {\r\n        if (type === 'complete') {\r\n            return;\r\n        }\r\n        data = data || {};\r\n\r\n        if (_options.tag && !data.tag) {\r\n            data.tag = _options.tag;\r\n        }\r\n\r\n        this.trigger(type, data);\r\n\r\n        if (type === 'mediaError' || type === 'error') {\r\n            if (_array && _arrayIndex + 1 < _array.length) {\r\n                _loadNextItem();\r\n            }\r\n        }\r\n    }\r\n\r\n    function _instreamTime(evt) {\r\n        _instream._adModel.set('duration', evt.duration);\r\n        _instream._adModel.set('position', evt.position);\r\n    }\r\n\r\n    function _instreamItemComplete(e) {\r\n        var data = {};\r\n        if (_options.tag) {\r\n            data.tag = _options.tag;\r\n        }\r\n        this.trigger(MEDIA_COMPLETE, data);\r\n        _instreamItemNext.call(this, e);\r\n    }\r\n\r\n    function _instreamItemNext(e) {\r\n        if (_array && _arrayIndex + 1 < _array.length) {\r\n            _loadNextItem();\r\n        } else {\r\n            // notify vast of breakEnd\r\n            this.trigger('adBreakEnd', {});\r\n            if (e.type === MEDIA_COMPLETE) {\r\n                // Dispatch playlist complete event for ad pods\r\n                this.trigger(PLAYLIST_COMPLETE, {});\r\n            }\r\n            this.destroy();\r\n        }\r\n    }\r\n\r\n    this.loadItem = function(item, options) {\r\n        if (!_instream) {\r\n            return;\r\n        }\r\n        if (OS.android && OS.version.major === 2 && OS.version.minor === 3) {\r\n            this.trigger({\r\n                type: ERROR,\r\n                message: 'Error loading instream: Cannot play instream on Android 2.3'\r\n            });\r\n            return;\r\n        }\r\n        // Copy the playlist item passed in and make sure it's formatted as a proper playlist item\r\n        let playlist = item;\r\n        if (_.isArray(item)) {\r\n            _array = item;\r\n            _arrayOptions = options;\r\n            item = _array[_arrayIndex];\r\n            if (_arrayOptions) {\r\n                options = _arrayOptions[_arrayIndex];\r\n            }\r\n        } else {\r\n            playlist = [item];\r\n        }\r\n\r\n        const adModel = _instream._adModel;\r\n        adModel.set('playlist', playlist);\r\n\r\n        _model.set('hideAdsControls', false);\r\n\r\n        // Dispatch playlist item event for ad pods\r\n        _this.trigger(PLAYLIST_ITEM, {\r\n            index: _arrayIndex,\r\n            item: item\r\n        });\r\n\r\n        _options = Object.assign({}, _defaultOptions, options);\r\n\r\n        _this.addClickHandler();\r\n\r\n        adModel.set('skipButton', false);\r\n\r\n        const playPromise = _instream.load(item);\r\n\r\n        const skipoffset = item.skipoffset || _options.skipoffset;\r\n        if (skipoffset) {\r\n            _this.setupSkipButton(skipoffset, _options);\r\n        }\r\n\r\n        return playPromise;\r\n    };\r\n\r\n    this.setupSkipButton = function(skipoffset, options, customNext) {\r\n        const adModel = _instream._adModel;\r\n        if (customNext) {\r\n            _skipAd = customNext;\r\n        } else {\r\n            _skipAd = _instreamItemNext;\r\n        }\r\n        adModel.set('skipMessage', options.skipMessage);\r\n        adModel.set('skipText', options.skipText);\r\n        adModel.set('skipOffset', skipoffset);\r\n        adModel.set('skipButton', false);\r\n        adModel.set('skipButton', true);\r\n    };\r\n\r\n    this.applyProviderListeners = function(provider) {\r\n        _instream.applyProviderListeners(provider);\r\n\r\n        this.addClickHandler();\r\n    };\r\n\r\n    this.play = function() {\r\n        _instream.instreamPlay();\r\n    };\r\n\r\n    this.pause = function() {\r\n        _instream.instreamPause();\r\n    };\r\n\r\n    this.addClickHandler = function() {\r\n        // start listening for ad click\r\n        if (_view.clickHandler()) {\r\n            _view.clickHandler().setAlternateClickHandlers(_clickHandler, _doubleClickHandler);\r\n        }\r\n\r\n        if (_instream) {\r\n            _instream.on(MEDIA_META, this.metaHandler, this);\r\n        }\r\n    };\r\n\r\n    this.skipAd = function(evt) {\r\n        var skipAdType = AD_SKIPPED;\r\n        this.trigger(skipAdType, evt);\r\n        _skipAd.call(this, {\r\n            type: skipAdType\r\n        });\r\n    };\r\n\r\n    /** Handle the MEDIA_META event **/\r\n    this.metaHandler = function (evt) {\r\n        // If we're getting video dimension metadata from the provider, allow the view to resize the media\r\n        if (evt.width && evt.height) {\r\n            _view.resizeMedia();\r\n        }\r\n    };\r\n\r\n    this.replacePlaylistItem = function(item) {\r\n        _model.set('playlistItem', item);\r\n    };\r\n\r\n    this.destroy = function() {\r\n        this.off();\r\n\r\n        _model.set('adModel', null);\r\n\r\n        if (_view.clickHandler()) {\r\n            _view.clickHandler().revertAlternateClickHandlers();\r\n        }\r\n\r\n        if (_instream) {\r\n            // Sync player state with ad for model \"change:state\" events to trigger\r\n            if (_instream._adModel) {\r\n                const adState = _instream._adModel.get('state');\r\n                _model.attributes.state = adState;\r\n            }\r\n\r\n            _model.off(null, null, _instream);\r\n            _instream.off(null, null, _this);\r\n            _instream.instreamDestroy();\r\n\r\n            // Must happen after instream.instreamDestroy()\r\n            _view.destroyInstream();\r\n\r\n            _instream = null;\r\n\r\n            // Player was destroyed\r\n            if (_model.attributes._destroyed) {\r\n                return;\r\n            }\r\n\r\n            // Re-attach the controller\r\n            _controller.attachMedia();\r\n\r\n            if (_oldpos === null) {\r\n                _model.stopVideo();\r\n            } else {\r\n                const mediaModelContext = _model.mediaModel;\r\n                const item = Object.assign({}, _olditem);\r\n                item.starttime = _oldpos;\r\n                _model.attributes.playlistItem = item;\r\n                _model.playVideo().catch(function(error) {\r\n                    if (mediaModelContext === _model.mediaModel) {\r\n                        _model.mediaController.trigger('error', {\r\n                            message: error.message\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    this.getState = function() {\r\n        if (_instream && _instream._adModel) {\r\n            return _instream._adModel.get('state');\r\n        }\r\n        // api expects false to know we aren't in instreamMode\r\n        return false;\r\n    };\r\n\r\n    this.setText = function(text) {\r\n        _view.setAltText(text ? text : '');\r\n    };\r\n\r\n    // This method is triggered by plugins which want to hide player controls\r\n    this.hide = function() {\r\n        _model.set('hideAdsControls', true);\r\n    };\r\n\r\n};\r\n\r\nObject.assign(InstreamAdapter.prototype, Events);\r\n\r\nexport default InstreamAdapter;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/controller/instream-adapter.js","import { STATE_PAUSED, STATE_PLAYING, ERROR, FULLSCREEN,\r\n    PLAYER_STATE, MEDIA_COMPLETE } from 'events/events';\r\nimport { OS } from 'environment/environment';\r\nimport Events from 'utils/backbone.events';\r\nimport changeStateEvent from 'events/change-state-event';\r\nimport Model from 'controller/model';\r\n\r\nconst InstreamHtml5 = function(_controller, _model) {\r\n    var _adModel;\r\n    var _currentProvider;\r\n    var _this = Object.assign(this, Events);\r\n\r\n    // Listen for player resize events\r\n    _controller.on(FULLSCREEN, function(data) {\r\n        this.trigger(FULLSCREEN, data);\r\n    }, _this);\r\n\r\n    /** ***************************************\r\n     *****  Public instream API methods  *****\r\n     *****************************************/\r\n\r\n    this.init = function(mediaElement) {\r\n        // Initialize the instream player's model copied from main player's model\r\n        const playerAttributes = _model.attributes;\r\n        const mediaModelContext = _model.mediaModel;\r\n        _adModel = new Model().setup({\r\n            id: playerAttributes.id,\r\n            volume: playerAttributes.volume,\r\n            fullscreen: playerAttributes.fullscreen,\r\n            instreamMode: true,\r\n            edition: playerAttributes.edition,\r\n            mediaContext: mediaModelContext,\r\n            mediaElement: mediaElement,\r\n            mediaSrc: mediaElement.src,\r\n            mute: playerAttributes.mute || playerAttributes.autostartMuted,\r\n            autostartMuted: playerAttributes.autostartMuted,\r\n            autostart: playerAttributes.autostart,\r\n            advertising: playerAttributes.advertising,\r\n            sdkplatform: playerAttributes.sdkplatform,\r\n            skipButton: false\r\n        });\r\n        if (!OS.mobile) {\r\n            _adModel.set('mediaContainer', _model.get('mediaContainer'));\r\n        }\r\n        _adModel.on('fullscreenchange', _nativeFullscreenHandler);\r\n        _adModel.on('change:state', changeStateEvent, _this);\r\n        _adModel.on(ERROR, function(data) {\r\n            _this.trigger(ERROR, data);\r\n        }, _this);\r\n        // Listen to media element for events that indicate src was reset or load() was called\r\n        _this.srcReset = function() {\r\n            mediaModelContext.srcReset();\r\n        };\r\n        mediaElement.addEventListener('abort', _this.srcReset);\r\n        mediaElement.addEventListener('emptied', _this.srcReset);\r\n        this._adModel = _adModel;\r\n    };\r\n\r\n    /** Load an instream item and initialize playback **/\r\n    _this.load = function() {\r\n        // Let the player media model know we're using it's video tag\r\n        _this.srcReset();\r\n\r\n        // Make sure it chooses a provider\r\n        _adModel.stopVideo();\r\n        _adModel.setItemIndex(0).then(() => {\r\n            if (!_adModel) {\r\n                return;\r\n            }\r\n            _checkProvider(_adModel.getVideo());\r\n        });\r\n        _checkProvider();\r\n\r\n        // Load the instream item\r\n        return _adModel.playVideo();\r\n    };\r\n\r\n    _this.applyProviderListeners = function(provider) {\r\n        // check provider after item change\r\n        _checkProvider(provider);\r\n\r\n        if (!provider) {\r\n            return;\r\n        }\r\n\r\n        // Match the main player's controls state\r\n        provider.off(ERROR);\r\n        provider.on(ERROR, function(data) {\r\n            this.trigger(ERROR, data);\r\n        }, _this);\r\n        _model.on('change:volume', function(data, value) {\r\n            provider.volume(value);\r\n        }, _this);\r\n        _model.on('change:mute', function(data, value) {\r\n            provider.mute(value);\r\n        }, _this);\r\n        _model.on('change:autostartMuted', function(data, value) {\r\n            if (!value) {\r\n                provider.mute(_model.get('mute'));\r\n            }\r\n        }, _this);\r\n    };\r\n\r\n    /** Stop the instream playback and revert the main player back to its original state **/\r\n    this.instreamDestroy = function() {\r\n        if (!_adModel) {\r\n            return;\r\n        }\r\n\r\n        _adModel.off();\r\n        if (_adModel.mediaModel) {\r\n            _adModel.mediaModel.off();\r\n        }\r\n\r\n        // We don't want the instream provider to be attached to the video tag anymore\r\n        this.off();\r\n        if (_currentProvider) {\r\n            _currentProvider.detachMedia();\r\n            _currentProvider.off();\r\n            if (_adModel.getVideo()) {\r\n                _currentProvider.destroy();\r\n            }\r\n        }\r\n\r\n        const mediaElement = _adModel.get('mediaElement');\r\n        mediaElement.removeEventListener('abort', _this.srcReset);\r\n        mediaElement.removeEventListener('emptied', _this.srcReset);\r\n\r\n        // Reset the player media model if the src was changed externally\r\n        const srcChanged = mediaElement.src !== _adModel.get('mediaSrc');\r\n        if (srcChanged) {\r\n            _model.mediaModel.srcReset();\r\n        }\r\n\r\n        // Return the view to its normal state\r\n        _adModel = null;\r\n\r\n        // Remove all callbacks for 'this' for all events\r\n        _controller.off(null, null, this);\r\n        _controller = null;\r\n    };\r\n\r\n    /** Start instream playback **/\r\n    _this.instreamPlay = function() {\r\n        if (!_adModel.getVideo()) {\r\n            return;\r\n        }\r\n        _adModel.getVideo().play();\r\n    };\r\n\r\n    /** Pause instream playback **/\r\n    _this.instreamPause = function() {\r\n        if (!_adModel.getVideo()) {\r\n            return;\r\n        }\r\n        _adModel.getVideo().pause();\r\n    };\r\n\r\n\r\n    /** ***************************\r\n     ****** Private methods ******\r\n     *****************************/\r\n\r\n    function _checkProvider(pseudoProvider) {\r\n        const provider = pseudoProvider || _adModel.getVideo();\r\n\r\n        // Clear current provider when applyProviderListeners(null) is called\r\n        _currentProvider = provider;\r\n\r\n        if (!provider) {\r\n            return;\r\n        }\r\n\r\n        var isVpaidProvider = provider.type === 'vpaid';\r\n\r\n        provider.off();\r\n        provider.on('all', function(type, data) {\r\n            if (isVpaidProvider && (type === MEDIA_COMPLETE)) {\r\n                return;\r\n            }\r\n            this.trigger(type, Object.assign({}, data, { type: type }));\r\n        }, _this);\r\n\r\n        const adMediaModelContext = _adModel.mediaModel;\r\n        provider.on(PLAYER_STATE, (event) => {\r\n            adMediaModelContext.set(PLAYER_STATE, event.newstate);\r\n        });\r\n        adMediaModelContext.on('change:' + PLAYER_STATE, (changeAdModel, state) => {\r\n            stateHandler(state);\r\n        });\r\n        provider.attachMedia();\r\n        provider.volume(_model.get('volume'));\r\n        provider.mute(_model.get('mute') || _model.get('autostartMuted'));\r\n        if (provider.setPlaybackRate) {\r\n            provider.setPlaybackRate(1);\r\n        }\r\n    }\r\n\r\n    function stateHandler(state) {\r\n        switch (state) {\r\n            case STATE_PLAYING:\r\n            case STATE_PAUSED:\r\n                _adModel.set(PLAYER_STATE, state);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n\r\n    function _nativeFullscreenHandler(evt) {\r\n        _model.trigger(evt.type, evt);\r\n        _this.trigger(FULLSCREEN, {\r\n            fullscreen: evt.jwstate\r\n        });\r\n    }\r\n\r\n    return _this;\r\n};\r\n\r\nexport default InstreamHtml5;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/controller/instream-html5.js","import { PLAYLIST_ITEM, MEDIA_PLAY_ATTEMPT, PROVIDER_FIRST_FRAME, MEDIA_TIME, MEDIA_FIRST_FRAME } from 'events/events';\r\nimport Timer from 'api/timer';\r\n\r\nconst TAB_HIDDEN = 'tabHidden';\r\nconst TAB_VISIBLE = 'tabVisible';\r\n\r\n// This is to provide a first frame event even when\r\n//  a provider does not give us one.\r\nconst onTimeIncreasesGenerator = (function(callback) {\r\n    let lastVal = 0;\r\n    return function (evt) {\r\n        const pos = evt.position;\r\n        if (pos > lastVal) {\r\n            callback();\r\n        }\r\n        // sometimes the number will wrap around (ie 100 down to 0)\r\n        //  so always update\r\n        lastVal = pos;\r\n    };\r\n});\r\n\r\nfunction unbindFirstFrameEvents(model) {\r\n    model.mediaController.off(MEDIA_PLAY_ATTEMPT, model._onPlayAttempt);\r\n    model.mediaController.off(PROVIDER_FIRST_FRAME, model._triggerFirstFrame);\r\n    model.mediaController.off(MEDIA_TIME, model._onTime);\r\n    model.off('change:activeTab', model._onTabVisible);\r\n}\r\n\r\nfunction trackFirstFrame(model) {\r\n    if (model._onTabVisible) {\r\n        unbindFirstFrameEvents(model);\r\n    }\r\n\r\n    // When it occurs, send the event, and unbind all listeners\r\n    let once = false;\r\n    model._triggerFirstFrame = function() {\r\n        if (once) {\r\n            return;\r\n        }\r\n        once = true;\r\n        const qoeItem = model._qoeItem;\r\n        qoeItem.tick(MEDIA_FIRST_FRAME);\r\n\r\n        const time = qoeItem.getFirstFrame();\r\n        model.mediaController.trigger(MEDIA_FIRST_FRAME, { loadTime: time });\r\n        unbindFirstFrameEvents(model);\r\n    };\r\n\r\n    model._onTime = onTimeIncreasesGenerator(model._triggerFirstFrame);\r\n\r\n    model._onPlayAttempt = function() {\r\n        model._qoeItem.tick(MEDIA_PLAY_ATTEMPT);\r\n    };\r\n\r\n    // track visibility change\r\n    model._onTabVisible = function(modelChanged, activeTab) {\r\n        if (activeTab) {\r\n            model._qoeItem.tick(TAB_VISIBLE);\r\n        } else {\r\n            model._qoeItem.tick(TAB_HIDDEN);\r\n        }\r\n    };\r\n\r\n    model.on('change:activeTab', model._onTabVisible);\r\n    model.mediaController.on(MEDIA_PLAY_ATTEMPT, model._onPlayAttempt);\r\n    model.mediaController.once(PROVIDER_FIRST_FRAME, model._triggerFirstFrame);\r\n    model.mediaController.on(MEDIA_TIME, model._onTime);\r\n}\r\n\r\nconst initQoe = function(initialModel) {\r\n    function onMediaModel(model, mediaModel, oldMediaModel) {\r\n        // finish previous item\r\n        if (model._qoeItem && oldMediaModel) {\r\n            model._qoeItem.end(oldMediaModel.get('state'));\r\n        }\r\n        // reset item level qoe\r\n        model._qoeItem = new Timer();\r\n        model._qoeItem.getFirstFrame = function() {\r\n            const time = this.between(MEDIA_PLAY_ATTEMPT, MEDIA_FIRST_FRAME);\r\n            // If time between the tab becoming visible and first frame is valid\r\n            // and less than the time since play attempt, play was not attempted until the tab became visible\r\n            const timeActive = this.between(TAB_VISIBLE, MEDIA_FIRST_FRAME);\r\n            if (timeActive > 0 && timeActive < time) {\r\n                return timeActive;\r\n            }\r\n            return time;\r\n        };\r\n        model._qoeItem.tick(PLAYLIST_ITEM);\r\n        model._qoeItem.start(mediaModel.get('state'));\r\n\r\n        trackFirstFrame(model);\r\n\r\n        mediaModel.on('change:state', function (changeMediaModel, newstate, oldstate) {\r\n            if (newstate !== oldstate) {\r\n                model._qoeItem.end(oldstate);\r\n                model._qoeItem.start(newstate);\r\n            }\r\n        });\r\n    }\r\n\r\n    initialModel.on('change:mediaModel', onMediaModel);\r\n};\r\n\r\nexport default initQoe;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/controller/qoe.js","import { Browser } from 'environment/environment';\r\nimport { STATE_BUFFERING, STATE_PAUSED, STATE_PLAYING, PLAYER_STATE, MEDIA_COMPLETE, MEDIA_TIME, MEDIA_ERROR } from 'events/events';\r\nimport Events from 'utils/backbone.events';\r\nimport Model from 'controller/model';\r\nimport changeStateEvent from 'events/change-state-event';\r\nimport { resolved } from 'polyfills/promise';\r\n\r\nconst InstreamFlash = function(_controller, _model) {\r\n    this.model = _model;\r\n\r\n    this._adModel = new Model().setup({\r\n        id: _model.get('id'),\r\n        volume: _model.get('volume'),\r\n        fullscreen: _model.get('fullscreen'),\r\n        mute: _model.get('mute')\r\n    });\r\n\r\n    this._adModel.on('change:state', changeStateEvent, this);\r\n\r\n    var container = _controller.getContainer();\r\n    this.swf = container.querySelector('object');\r\n};\r\n\r\nObject.assign(InstreamFlash.prototype, {\r\n\r\n    init: function() {\r\n        // Pause playback when throttled, and only resume is paused here\r\n        if (Browser.chrome) {\r\n            var _throttleTimeout = -1;\r\n            var _throttlePaused = false;\r\n            this.swf.on('throttle', function(e) {\r\n                clearTimeout(_throttleTimeout);\r\n\r\n                if (e.state === 'resume') {\r\n                    if (_throttlePaused) {\r\n                        _throttlePaused = false;\r\n                        this.instreamPlay();\r\n                    }\r\n                } else {\r\n                    var _this = this;\r\n                    _throttleTimeout = setTimeout(function () {\r\n                        if (_this._adModel.get('state') === STATE_PLAYING) {\r\n                            _throttlePaused = true;\r\n                            _this.instreamPause();\r\n                        }\r\n                    }, 250);\r\n                }\r\n            }, this);\r\n        }\r\n\r\n        this.swf.on('instream:state', this.stateHandler, this)\r\n            .on('instream:time', function(evt) {\r\n                this._adModel.set('position', evt.position);\r\n                this._adModel.set('duration', evt.duration);\r\n                this.trigger(MEDIA_TIME, evt);\r\n            }, this)\r\n            .on('instream:complete', function(evt) {\r\n                this.trigger(MEDIA_COMPLETE, evt);\r\n            }, this)\r\n            .on('instream:error', function(evt) {\r\n                this.trigger(MEDIA_ERROR, evt);\r\n            }, this);\r\n\r\n        this.swf.triggerFlash('instream:init');\r\n\r\n        this.applyProviderListeners = function(provider) {\r\n            if (!provider) {\r\n                return;\r\n            }\r\n            this.model.on('change:volume', function(data, value) {\r\n                provider.volume(value);\r\n            }, this);\r\n            this.model.on('change:mute', function(data, value) {\r\n                provider.mute(value);\r\n            }, this);\r\n\r\n            provider.volume(this.model.get('volume'));\r\n            provider.mute(this.model.get('mute'));\r\n\r\n            // update admodel state when set from googima\r\n            provider.off();\r\n            provider.on(PLAYER_STATE, this.stateHandler, this);\r\n\r\n            // trigger time evemt when sent from freewheel\r\n            provider.on(MEDIA_TIME, function(data) {\r\n                this.trigger(MEDIA_TIME, data);\r\n            }, this);\r\n        };\r\n    },\r\n\r\n    stateHandler: function(evt) {\r\n        switch (evt.newstate) {\r\n            case STATE_PLAYING:\r\n            case STATE_PAUSED:\r\n                this._adModel.set('state', evt.newstate);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    },\r\n\r\n    instreamDestroy: function() {\r\n        if (!this._adModel) {\r\n            return;\r\n        }\r\n\r\n        this.off();\r\n\r\n        this.swf.off(null, null, this);\r\n        this.swf.triggerFlash('instream:destroy');\r\n        this.swf = null;\r\n\r\n        this._adModel.off();\r\n        this._adModel = null;\r\n\r\n        this.model = null;\r\n    },\r\n\r\n    load: function(item) {\r\n        this._adModel.set('state', STATE_BUFFERING);\r\n        // Show the instream layer\r\n        this.swf.triggerFlash('instream:load', item);\r\n        return resolved;\r\n    },\r\n\r\n    instreamPlay: function() {\r\n        this.swf.triggerFlash('instream:play');\r\n    },\r\n\r\n    instreamPause: function() {\r\n        this.swf.triggerFlash('instream:pause');\r\n    }\r\n\r\n}, Events);\r\n\r\nexport default InstreamFlash;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/controller/instream-flash.js","import { loadFile } from 'controller/tracks-loader';\r\nimport { createId, createLabel } from 'controller/tracks-helper';\r\nimport Events from 'utils/backbone.events';\r\nimport { ERROR } from 'events/events';\r\n\r\n\r\n/** Displays closed captions or subtitles on top of the video. **/\r\nconst Captions = function(_model) {\r\n\r\n    // Reset and load external captions on playlist item\r\n    _model.on('change:playlistItem', _itemHandler, this);\r\n\r\n    // Listen for captions menu index changes from the view\r\n    _model.on('change:captionsIndex', _captionsIndexHandler, this);\r\n\r\n    // Listen for item ready to determine which provider is in use\r\n    _model.on('itemReady', _itemReadyHandler, this);\r\n\r\n    // Listen for provider subtitle tracks\r\n    //   ignoring provider \"subtitlesTrackChanged\" since index should be managed here\r\n    _model.mediaController.on('subtitlesTracks', _subtitlesTracksHandler, this);\r\n\r\n    function _subtitlesTracksHandler(e) {\r\n        if (!e.tracks.length) {\r\n            return;\r\n        }\r\n\r\n        const tracks = e.tracks || [];\r\n        for (let i = 0; i < tracks.length; i++) {\r\n            _addTrack(tracks[i]);\r\n        }\r\n\r\n        // To avoid duplicate tracks in the menu when we reuse an _id, regenerate the tracks array\r\n        _tracks = Object.keys(_tracksById).map(id => _tracksById[id]);\r\n\r\n        const captionsMenu = _captionsMenu();\r\n        _selectDefaultIndex();\r\n        this.setCaptionsList(captionsMenu);\r\n    }\r\n\r\n    let _tracks = [];\r\n    let _tracksById = {};\r\n    let _unknownCount = 0;\r\n\r\n    /** Listen to playlist item updates. **/\r\n    function _itemHandler() {\r\n        _tracks = [];\r\n        _tracksById = {};\r\n        _unknownCount = 0;\r\n    }\r\n\r\n    function _itemReadyHandler(item) {\r\n        // Clean up in case we're replaying\r\n        _itemHandler(_model, item);\r\n\r\n        const tracks = item.tracks;\r\n        const len = tracks && tracks.length;\r\n\r\n        // Sideload tracks when not rendering natively\r\n        if (!_model.get('renderCaptionsNatively') && len) {\r\n            for (let i = 0; i < len; i++) {\r\n                /* eslint-disable no-loop-func */\r\n                const track = tracks[i];\r\n                if (_kindSupported(track.kind) && !_tracksById[track._id]) {\r\n                    _addTrack(track);\r\n                    loadFile(track,\r\n                        (vttCues) => {\r\n                            _addVTTCuesToTrack(track, vttCues);\r\n                        },\r\n                        (error) => {\r\n                            this.trigger(ERROR, {\r\n                                message: 'Captions failed to load',\r\n                                reason: error\r\n                            });\r\n                        });\r\n                }\r\n            }\r\n        }\r\n\r\n        const captionsMenu = _captionsMenu();\r\n        _selectDefaultIndex();\r\n        this.setCaptionsList(captionsMenu);\r\n    }\r\n\r\n    function _kindSupported(kind) {\r\n        return kind === 'subtitles' || kind === 'captions';\r\n    }\r\n\r\n    function _addVTTCuesToTrack(track, vttCues) {\r\n        track.data = vttCues;\r\n    }\r\n\r\n    function _captionsIndexHandler(model, captionsMenuIndex) {\r\n        let track = null;\r\n        if (captionsMenuIndex !== 0) {\r\n            track = _tracks[captionsMenuIndex - 1];\r\n        }\r\n        model.set('captionsTrack', track);\r\n    }\r\n\r\n    function _addTrack(track) {\r\n        track.data = track.data || [];\r\n        track.name = track.label || track.name || track.language;\r\n        track._id = createId(track, _tracks.length);\r\n\r\n        if (!track.name) {\r\n            const labelInfo = createLabel(track, _unknownCount);\r\n            track.name = labelInfo.label;\r\n            _unknownCount = labelInfo.unknownCount;\r\n        }\r\n\r\n        // During the same playlist we may reu and readd tracks with the same _id; allow the new track to replace the old\r\n        _tracksById[track._id] = track;\r\n        _tracks.push(track);\r\n    }\r\n\r\n    function _captionsMenu() {\r\n        const list = [{\r\n            id: 'off',\r\n            label: 'Off'\r\n        }];\r\n        for (let i = 0; i < _tracks.length; i++) {\r\n            list.push({\r\n                id: _tracks[i]._id,\r\n                label: _tracks[i].name || 'Unknown CC'\r\n            });\r\n        }\r\n        return list;\r\n    }\r\n\r\n    function _selectDefaultIndex() {\r\n        let captionsMenuIndex = 0;\r\n        const label = _model.get('captionLabel');\r\n\r\n        // Because there is no explicit track for \"Off\"\r\n        //  it is the implied zeroth track\r\n        if (label === 'Off') {\r\n            _model.set('captionsIndex', 0);\r\n            return;\r\n        }\r\n\r\n        for (let i = 0; i < _tracks.length; i++) {\r\n            const track = _tracks[i];\r\n            if (label && label === track.name) {\r\n                captionsMenuIndex = i + 1;\r\n                break;\r\n            } else if (track.default || track.defaulttrack || track._id === 'default') {\r\n                captionsMenuIndex = i + 1;\r\n            } else if (track.autoselect) {\r\n                // TODO: auto select track by comparing track.language to system lang\r\n            }\r\n        }\r\n        // set the index without the side effect of storing the Off label in _selectCaptions\r\n        _setCurrentIndex(captionsMenuIndex);\r\n    }\r\n\r\n    function _setCurrentIndex (index) {\r\n        if (_tracks.length) {\r\n            _model.setVideoSubtitleTrack(index, _tracks);\r\n        } else {\r\n            _model.set('captionsIndex', index);\r\n        }\r\n    }\r\n\r\n    this.getCurrentIndex = function() {\r\n        return _model.get('captionsIndex');\r\n    };\r\n\r\n    this.getCaptionsList = function() {\r\n        return _model.get('captionsList');\r\n    };\r\n\r\n    this.setCaptionsList = function(captionsMenu) {\r\n        _model.set('captionsList', captionsMenu);\r\n    };\r\n\r\n    this.destroy = function() {\r\n        this.off(null, null, this);\r\n    };\r\n};\r\n\r\nObject.assign(Captions.prototype, Events);\r\n\r\nexport default Captions;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/controller/captions.js","import playerTemplate from 'templates/player';\r\nimport ErrorContainer from 'view/error-container';\r\nimport { isAudioMode, CONTROLBAR_ONLY_HEIGHT } from 'view/utils/audio-mode';\r\nimport viewsManager from 'view/utils/views-manager';\r\nimport getVisibility from 'view/utils/visibility';\r\nimport activeTab from 'utils/active-tab';\r\nimport { requestAnimationFrame, cancelAnimationFrame } from 'utils/request-animation-frame';\r\nimport { getBreakpoint, setBreakpoint } from 'view/utils/breakpoint';\r\nimport { normalizeSkin, handleColorOverrides } from 'view/utils/skin';\r\nimport { Browser, OS, Features } from 'environment/environment';\r\nimport * as ControlsLoader from 'controller/controls-loader';\r\nimport { STATE_BUFFERING, STATE_IDLE, STATE_COMPLETE, STATE_PAUSED, STATE_PLAYING, STATE_ERROR, RESIZE, BREAKPOINT,\r\n    DISPLAY_CLICK, LOGO_CLICK, ERROR } from 'events/events';\r\nimport Events from 'utils/backbone.events';\r\nimport {\r\n    addClass,\r\n    hasClass,\r\n    removeClass,\r\n    replaceClass,\r\n    toggleClass,\r\n    createElement,\r\n    bounds,\r\n} from 'utils/dom';\r\nimport {\r\n    clearCss,\r\n    style,\r\n} from 'utils/css';\r\nimport _ from 'utils/underscore';\r\nimport requestFullscreenHelper from 'view/utils/request-fullscreen-helper';\r\nimport flagNoFocus from 'view/utils/flag-no-focus';\r\nimport ClickHandler from 'view/utils/clickhandler';\r\nimport CaptionsRenderer from 'view/captionsrenderer';\r\nimport Logo from 'view/logo';\r\nimport Preview from 'view/preview';\r\nimport Title from 'view/title';\r\n\r\nrequire('css/jwplayer.less');\r\n\r\nlet ControlsModule;\r\n\r\nconst _isMobile = OS.mobile;\r\nconst _isIE = Browser.ie;\r\n\r\nfunction View(_api, _model) {\r\n    const _this = Object.assign(this, Events, {\r\n        isSetup: false,\r\n        api: _api,\r\n        model: _model\r\n    });\r\n\r\n    // init/reset view model properties\r\n    Object.assign(_model.attributes, {\r\n        containerWidth: undefined,\r\n        containerHeight: undefined,\r\n        mediaContainer: undefined,\r\n        fullscreen: false,\r\n        inDom: undefined,\r\n        iFrame: undefined,\r\n        activeTab: undefined,\r\n        intersectionRatio: undefined,\r\n        visibility: undefined,\r\n        viewable: undefined,\r\n        viewSetup: false,\r\n        audioMode: undefined,\r\n        touchMode: undefined,\r\n        altText: '',\r\n        cues: undefined,\r\n        castClicked: false,\r\n        scrubbing: false,\r\n        logoWidth: 0,\r\n    });\r\n\r\n    const _playerElement = createElement(playerTemplate(_model.get('id'), _model.get('localization').player));\r\n    const _videoLayer = _playerElement.querySelector('.jw-media');\r\n\r\n    const _preview = new Preview(_model);\r\n    const _title = new Title(_model);\r\n\r\n    let _captionsRenderer = new CaptionsRenderer(_model);\r\n    _captionsRenderer.on('all', _this.trigger, _this);\r\n\r\n    let _logo;\r\n\r\n    let _playerState;\r\n\r\n    let _lastWidth;\r\n    let _lastHeight;\r\n\r\n    let _instreamModel;\r\n\r\n    let _resizeMediaTimeout = -1;\r\n    let _resizeContainerRequestId = -1;\r\n    let _stateClassRequestId = -1;\r\n\r\n    let displayClickHandler;\r\n    let fullscreenHelpers;\r\n    let focusHelper;\r\n\r\n    let _breakpoint = null;\r\n    let _controls;\r\n\r\n    function reasonInteraction() {\r\n        return { reason: 'interaction' };\r\n    }\r\n\r\n    this.updateBounds = function () {\r\n        cancelAnimationFrame(_resizeContainerRequestId);\r\n        const inDOM = document.body.contains(_playerElement);\r\n        const rect = bounds(_playerElement);\r\n        const containerWidth = Math.round(rect.width);\r\n        const containerHeight = Math.round(rect.height);\r\n\r\n        // If the container is the same size as before, return early\r\n        if (containerWidth === _lastWidth && containerHeight === _lastHeight) {\r\n            // Listen for player to be added to DOM\r\n            if (!_lastWidth || !_lastHeight) {\r\n                _responsiveListener();\r\n            }\r\n            _model.set('inDom', inDOM);\r\n            return;\r\n        }\r\n        // If we have bad values for either dimension, return early\r\n        if (!containerWidth || !containerHeight) {\r\n            // If we haven't established player size, try again\r\n            if (!_lastWidth || !_lastHeight) {\r\n                _responsiveListener();\r\n            }\r\n        }\r\n\r\n        // Don't update container dimensions to 0, 0 when not in DOM\r\n        if (containerWidth || containerHeight || inDOM) {\r\n            _model.set('containerWidth', containerWidth);\r\n            _model.set('containerHeight', containerHeight);\r\n        }\r\n        _model.set('inDom', inDOM);\r\n\r\n        if (inDOM) {\r\n            viewsManager.observe(_playerElement);\r\n        }\r\n    };\r\n\r\n    this.updateStyles = function() {\r\n        const containerWidth = _model.get('containerWidth');\r\n        const containerHeight = _model.get('containerHeight');\r\n\r\n        if (_model.get('controls')) {\r\n            updateContainerStyles(containerWidth, containerHeight);\r\n        }\r\n\r\n        if (_controls) {\r\n            _controls.resize(containerWidth, containerHeight);\r\n        }\r\n\r\n        _resizeMedia(containerWidth, containerHeight);\r\n        _captionsRenderer.resize();\r\n    };\r\n\r\n    this.checkResized = function() {\r\n        const containerWidth = _model.get('containerWidth');\r\n        const containerHeight = _model.get('containerHeight');\r\n        if (containerWidth !== _lastWidth || containerHeight !== _lastHeight) {\r\n            _lastWidth = containerWidth;\r\n            _lastHeight = containerHeight;\r\n            _this.trigger(RESIZE, {\r\n                width: containerWidth,\r\n                height: containerHeight\r\n            });\r\n            const breakpoint = getBreakpoint(containerWidth);\r\n            if (_breakpoint !== breakpoint) {\r\n                _breakpoint = breakpoint;\r\n                _this.trigger(BREAKPOINT, {\r\n                    breakpoint: _breakpoint\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    function _responsiveListener() {\r\n        cancelAnimationFrame(_resizeContainerRequestId);\r\n        _resizeContainerRequestId = requestAnimationFrame(_responsiveUpdate);\r\n    }\r\n\r\n    function _responsiveUpdate() {\r\n        if (!_this.isSetup) {\r\n            return;\r\n        }\r\n        _this.updateBounds();\r\n        _this.updateStyles();\r\n        _this.checkResized();\r\n    }\r\n\r\n    function updateContainerStyles(width, height) {\r\n        const audioMode = isAudioMode(_model);\r\n        // Set timeslider flags\r\n        if (_.isNumber(width) && _.isNumber(height)) {\r\n            const breakpoint = getBreakpoint(width);\r\n            setBreakpoint(_playerElement, breakpoint);\r\n\r\n            const smallPlayer = breakpoint < 2;\r\n            toggleClass(_playerElement, 'jw-flag-small-player', smallPlayer);\r\n            toggleClass(_playerElement, 'jw-orientation-portrait', (height > width));\r\n        }\r\n        toggleClass(_playerElement, 'jw-flag-audio-player', audioMode);\r\n        _model.set('audioMode', audioMode);\r\n    }\r\n\r\n    this.setup = function () {\r\n        _preview.setup(_playerElement.querySelector('.jw-preview'));\r\n        _title.setup(_playerElement.querySelector('.jw-title'));\r\n\r\n        _logo = new Logo(_model);\r\n        _logo.setup();\r\n        _logo.setContainer(_playerElement);\r\n        _logo.on(LOGO_CLICK, _logoClickHandler);\r\n\r\n        // captions rendering\r\n        _captionsRenderer.setup(_playerElement.id, _model.get('captions'));\r\n\r\n        // captions should be placed behind controls, and not hidden when controls are hidden\r\n        _playerElement.insertBefore(_captionsRenderer.element(), _title.element());\r\n\r\n        // Display Click and Double Click Handling\r\n        displayClickHandler = clickHandlerHelper(_api, _model, _videoLayer);\r\n\r\n        focusHelper = flagNoFocus(_playerElement);\r\n        fullscreenHelpers = requestFullscreenHelper(_playerElement, document, _fullscreenChangeHandler);\r\n\r\n        _model.on('change:errorEvent', _errorHandler);\r\n        _model.on('change:hideAdsControls', function (model, val) {\r\n            toggleClass(_playerElement, 'jw-flag-ads-hide-controls', val);\r\n        });\r\n        _model.on('change:scrubbing', function (model, val) {\r\n            toggleClass(_playerElement, 'jw-flag-dragging', val);\r\n        });\r\n        _model.on('change:playRejected', function (model, val) {\r\n            toggleClass(_playerElement, 'jw-flag-play-rejected', val);\r\n        });\r\n\r\n        // Native fullscreen (coming through from the provider)\r\n        _model.mediaController.on('fullscreenchange', _fullscreenChangeHandler);\r\n\r\n        _model.change('mediaModel', (model, mediaModel) => {\r\n            mediaModel.change('mediaType', _onMediaTypeChange, this);\r\n            mediaModel.on('change:visualQuality', () => {\r\n                _resizeMedia();\r\n            }, this);\r\n        });\r\n        _model.change('stretching', onStretchChange);\r\n        _model.change('flashBlocked', onFlashBlockedChange);\r\n\r\n        const width = _model.get('width');\r\n        const height = _model.get('height');\r\n        _resizePlayer(width, height);\r\n        _model.change('aspectratio', onAspectRatioChange);\r\n        if (_model.get('controls')) {\r\n            updateContainerStyles(width, height);\r\n        } else {\r\n            addClass(_playerElement, 'jw-flag-controls-hidden');\r\n        }\r\n\r\n        if (_isIE) {\r\n            addClass(_playerElement, 'jw-ie');\r\n        }\r\n\r\n        const skin = _model.get('skin') || {};\r\n\r\n        if (skin.name) {\r\n            replaceClass(_playerElement, /jw-skin-\\S+/, 'jw-skin-' + skin.name);\r\n        }\r\n\r\n        const skinColors = normalizeSkin(skin);\r\n        handleColorOverrides(_model.get('id'), skinColors);\r\n\r\n        // adds video tag to video layer\r\n        _model.set('mediaContainer', _videoLayer);\r\n        _model.set('iFrame', Features.iframe);\r\n        _model.set('activeTab', activeTab());\r\n        _model.set('touchMode', _isMobile && (typeof height === 'string' || height >= CONTROLBAR_ONLY_HEIGHT));\r\n\r\n        viewsManager.add(this);\r\n\r\n        this.isSetup = true;\r\n        _model.set('viewSetup', true);\r\n\r\n        const inDOM = document.body.contains(_playerElement);\r\n        if (inDOM) {\r\n            viewsManager.observe(_playerElement);\r\n        }\r\n        _model.set('inDom', inDOM);\r\n    };\r\n\r\n    function updateVisibility() {\r\n        _model.set('visibility', getVisibility(_model, _playerElement));\r\n    }\r\n\r\n    this.init = function() {\r\n        this.updateBounds();\r\n\r\n        _model.on('change:fullscreen', _fullscreen);\r\n        _model.on('change:activeTab', updateVisibility);\r\n        _model.on('change:fullscreen', updateVisibility);\r\n        _model.on('change:intersectionRatio', updateVisibility);\r\n        _model.on('change:visibility', redraw);\r\n\r\n        updateVisibility();\r\n\r\n        // Always draw first player for icons to load\r\n        if (viewsManager.size() === 1 && !_model.get('visibility')) {\r\n            redraw(_model, 1, 0);\r\n        }\r\n\r\n        _model.change('state', _stateHandler);\r\n        _model.change('controls', changeControls);\r\n        // Set the title attribute of the video tag to display background media information on mobile devices\r\n        if (_isMobile) {\r\n            setMediaTitleAttribute(_model.get('playlistItem'));\r\n            _model.on('itemReady', setMediaTitleAttribute);\r\n        }\r\n\r\n        // Triggering 'resize' resulting in player 'ready'\r\n        _lastWidth = _lastHeight = null;\r\n        this.checkResized();\r\n    };\r\n\r\n    function changeControls(model, enable) {\r\n        if (enable) {\r\n            ControlsModule = ControlsLoader.module.controls;\r\n            if (!ControlsModule) {\r\n                ControlsLoader.load()\r\n                    .then(function (Controls) {\r\n                        ControlsModule = Controls;\r\n                        addControls();\r\n                    })\r\n                    .catch(function (reason) {\r\n                        _this.trigger(ERROR, {\r\n                            message: 'Controls failed to load',\r\n                            reason: reason\r\n                        });\r\n                    });\r\n            } else {\r\n                addControls();\r\n            }\r\n        } else {\r\n            _this.removeControls();\r\n        }\r\n    }\r\n\r\n    function addControls() {\r\n        const controls = new ControlsModule(document, _this.element());\r\n        _this.addControls(controls);\r\n    }\r\n\r\n    function setMediaTitleAttribute(item) {\r\n        var videotag = _videoLayer.querySelector('video, audio');\r\n        // chromecast and flash providers do no support video tags\r\n        if (!videotag) {\r\n            return;\r\n        }\r\n\r\n        // Writing a string to innerHTML completely decodes multiple-encoded strings\r\n        const dummyDiv = document.createElement('div');\r\n        dummyDiv.innerHTML = item.title || '';\r\n        videotag.setAttribute('title', dummyDiv.textContent);\r\n    }\r\n\r\n    function redraw(model, visibility, lastVisibility) {\r\n        if (visibility && !lastVisibility) {\r\n            _stateHandler(_instreamModel || model);\r\n            _this.updateStyles();\r\n        }\r\n    }\r\n\r\n    function clickHandlerHelper(api, model, videoLayer) {\r\n        const clickHandler = new ClickHandler(model, videoLayer, { useHover: true });\r\n        const controls = _model.get('controls');\r\n        clickHandler.on({\r\n            click: () => {\r\n                _this.trigger(DISPLAY_CLICK);\r\n\r\n                if (_controls) {\r\n                    if (settingsMenuVisible()) {\r\n                        _controls.settingsMenu.close();\r\n                    } else {\r\n                        api.playToggle(reasonInteraction());\r\n                    }\r\n                }\r\n            },\r\n            tap: () => {\r\n                _this.trigger(DISPLAY_CLICK);\r\n                if (settingsMenuVisible()) {\r\n                    _controls.settingsMenu.close();\r\n                }\r\n                const state = model.get('state');\r\n\r\n                if (controls &&\r\n                    ((state === STATE_IDLE || state === STATE_COMPLETE) ||\r\n                    (_instreamModel && _instreamModel.get('state') === STATE_PAUSED))) {\r\n                    api.playToggle(reasonInteraction());\r\n                }\r\n\r\n                if (controls && state === STATE_PAUSED) {\r\n                    // Toggle visibility of the controls when tapping the media\r\n                    // Do not add mobile toggle \"jw-flag-controls-hidden\" in these cases\r\n                    if (_instreamModel ||\r\n                        model.get('castActive') ||\r\n                        (model.mediaModel && model.mediaModel.get('mediaType') === 'audio')) {\r\n                        return;\r\n                    }\r\n                    toggleClass(_playerElement, 'jw-flag-controls-hidden');\r\n                    _captionsRenderer.renderCues(true);\r\n                } else if (_controls) {\r\n                    if (!_controls.showing) {\r\n                        _controls.userActive();\r\n                    } else {\r\n                        _controls.userInactive();\r\n                    }\r\n                }\r\n            },\r\n            doubleClick: () => _controls && api.setFullscreen(),\r\n            move: () => _controls && _controls.userActive(),\r\n            over: () => _controls && _controls.userActive()\r\n        });\r\n\r\n        return clickHandler;\r\n    }\r\n\r\n    function onStretchChange(model, newVal) {\r\n        replaceClass(_playerElement, /jw-stretch-\\S+/, 'jw-stretch-' + newVal);\r\n    }\r\n\r\n    function onAspectRatioChange(model, aspectratio) {\r\n        toggleClass(_playerElement, 'jw-flag-aspect-mode', !!aspectratio);\r\n        const aspectRatioContainer = _playerElement.querySelector('.jw-aspect');\r\n        style(aspectRatioContainer, {\r\n            paddingTop: aspectratio || null\r\n        });\r\n    }\r\n\r\n    function onFlashBlockedChange(model, isBlocked) {\r\n        toggleClass(_playerElement, 'jw-flag-flash-blocked', isBlocked);\r\n    }\r\n\r\n    function _logoClickHandler(evt) {\r\n        if (!evt.link) {\r\n            if (_model.get('controls')) {\r\n                _api.playToggle(reasonInteraction());\r\n            }\r\n        } else {\r\n            _api.pause(reasonInteraction());\r\n            _api.setFullscreen(false);\r\n            window.open(evt.link, evt.linktarget);\r\n        }\r\n    }\r\n\r\n    const _onChangeControls = function (model, bool) {\r\n        if (bool) {\r\n            // ignore model that triggered this event and use current state model\r\n            _stateHandler(_instreamModel || _model);\r\n        }\r\n    };\r\n\r\n    this.addControls = function (controls) {\r\n        _controls = controls;\r\n\r\n        removeClass(_playerElement, 'jw-flag-controls-hidden');\r\n\r\n        _model.change('streamType', _setLiveMode, this);\r\n\r\n        controls.enable(_api, _model);\r\n        controls.addActiveListeners(_logo.element());\r\n\r\n        const logoContainer = controls.logoContainer();\r\n        if (logoContainer) {\r\n            _logo.setContainer(logoContainer);\r\n        }\r\n\r\n        // refresh breakpoint and timeslider classes\r\n        if (_lastHeight) {\r\n            updateContainerStyles(_lastWidth, _lastHeight);\r\n            controls.resize(_lastWidth, _lastHeight);\r\n            _captionsRenderer.renderCues(true);\r\n        }\r\n\r\n        controls.on('userActive userInactive', function() {\r\n            if (_playerState === STATE_PLAYING || _playerState === STATE_BUFFERING) {\r\n                _captionsRenderer.renderCues(true);\r\n            }\r\n        });\r\n\r\n        controls.on('all', _this.trigger, _this);\r\n\r\n        if (_instreamModel) {\r\n            _controls.setupInstream(_instreamModel);\r\n        }\r\n\r\n        const overlaysElement = _playerElement.querySelector('.jw-overlays');\r\n        overlaysElement.addEventListener('mousemove', _userActivityCallback);\r\n    };\r\n\r\n    this.removeControls = function () {\r\n        _logo.setContainer(_playerElement);\r\n\r\n        if (_controls) {\r\n            _controls.removeActiveListeners(_logo.element());\r\n            _controls.disable(_model);\r\n            _controls = null;\r\n        }\r\n\r\n        const overlay = document.querySelector('.jw-overlays');\r\n        if (overlay) {\r\n            overlay.removeEventListener('mousemove', _userActivityCallback);\r\n        }\r\n\r\n        addClass(_playerElement, 'jw-flag-controls-hidden');\r\n    };\r\n\r\n    // Perform the switch to fullscreen\r\n    const _fullscreen = function (model, state) {\r\n\r\n        // If it supports DOM fullscreen\r\n        const provider = _model.getVideo();\r\n\r\n        // Unmute the video so volume can be adjusted with native controls in fullscreen\r\n        if (state && _controls && _model.get('autostartMuted')) {\r\n            _controls.unmuteAutoplay(_api, _model);\r\n        }\r\n\r\n        if (fullscreenHelpers.supportsDomFullscreen()) {\r\n            if (state) {\r\n                fullscreenHelpers.requestFullscreen();\r\n            } else {\r\n                fullscreenHelpers.exitFullscreen();\r\n            }\r\n            _toggleDOMFullscreen(_playerElement, state);\r\n        } else if (_isIE) {\r\n            _toggleDOMFullscreen(_playerElement, state);\r\n        } else {\r\n            // else use native fullscreen\r\n            if (_instreamModel && _instreamModel.getVideo()) {\r\n                _instreamModel.getVideo().setFullscreen(state);\r\n            }\r\n            provider.setFullscreen(state);\r\n        }\r\n        // pass fullscreen state to Flash provider\r\n        // provider.getName() is the same as _api.getProvider() or _model.get('provider')\r\n        if (provider && provider.getName().name.indexOf('flash') === 0) {\r\n            provider.setFullscreen(state);\r\n        }\r\n    };\r\n\r\n    function _resizePlayer(playerWidth, playerHeight, resetAspectMode) {\r\n        const widthSet = playerWidth !== undefined;\r\n        const heightSet = playerHeight !== undefined;\r\n        const playerStyle = {\r\n            width: playerWidth\r\n        };\r\n\r\n        // when jwResize is called remove aspectMode and force layout\r\n        if (heightSet && resetAspectMode) {\r\n            _model.set('aspectratio', null);\r\n        }\r\n        if (!_model.get('aspectratio')) {\r\n            // If the height is a pixel value (number) greater than 0, snap it to the minimum supported height\r\n            // Allow zero to mean \"hide the player\"\r\n            let height = playerHeight;\r\n            if (_.isNumber(height) && height !== 0) {\r\n                height = Math.max(height, CONTROLBAR_ONLY_HEIGHT);\r\n            }\r\n            playerStyle.height = height;\r\n        }\r\n\r\n        if (widthSet && heightSet) {\r\n            _model.set('width', playerWidth);\r\n            _model.set('height', playerHeight);\r\n        }\r\n\r\n        style(_playerElement, playerStyle);\r\n    }\r\n\r\n    function _resizeMedia(containerWidth, containerHeight) {\r\n        if (!containerWidth || isNaN(1 * containerWidth)) {\r\n            containerWidth = _model.get('containerWidth');\r\n            if (!containerWidth) {\r\n                return;\r\n            }\r\n        }\r\n        if (!containerHeight || isNaN(1 * containerHeight)) {\r\n            containerHeight = _model.get('containerHeight');\r\n            if (!containerHeight) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        if (_preview) {\r\n            _preview.resize(containerWidth, containerHeight, _model.get('stretching'));\r\n        }\r\n\r\n        const provider = _model.getVideo();\r\n        if (!provider) {\r\n            return;\r\n        }\r\n        const transformScale = provider.resize(containerWidth, containerHeight, _model.get('stretching'));\r\n\r\n        // poll resizing if video is transformed\r\n        if (transformScale) {\r\n            clearTimeout(_resizeMediaTimeout);\r\n            _resizeMediaTimeout = setTimeout(_resizeMedia, 250);\r\n        }\r\n    }\r\n\r\n    this.resize = function (playerWidth, playerHeight) {\r\n        const resetAspectMode = true;\r\n        _resizePlayer(playerWidth, playerHeight, resetAspectMode);\r\n        _responsiveUpdate();\r\n    };\r\n    this.resizeMedia = _resizeMedia;\r\n\r\n    /**\r\n     * Return whether or not we're in native fullscreen\r\n     */\r\n    function _isNativeFullscreen() {\r\n        if (fullscreenHelpers.supportsDomFullscreen()) {\r\n            const fsElement = fullscreenHelpers.fullscreenElement();\r\n            return !!(fsElement && fsElement.id === _model.get('id'));\r\n        }\r\n        // if player element view fullscreen not available, return video fullscreen state\r\n        return _instreamModel ? _instreamModel.getVideo().getFullScreen() :\r\n            _model.getVideo().getFullScreen();\r\n    }\r\n\r\n\r\n    function _fullscreenChangeHandler(event) {\r\n        const modelState = _model.get('fullscreen');\r\n        const newState = (event.jwstate !== undefined) ? event.jwstate : _isNativeFullscreen();\r\n\r\n        // If fullscreen was triggered by something other than the player\r\n        //  then we want to sync up our internal state\r\n        if (modelState !== newState) {\r\n            _model.set('fullscreen', newState);\r\n        }\r\n\r\n        _responsiveListener();\r\n        clearTimeout(_resizeMediaTimeout);\r\n        _resizeMediaTimeout = setTimeout(_resizeMedia, 200);\r\n    }\r\n\r\n    function _toggleDOMFullscreen(playerElement, fullscreenState) {\r\n        toggleClass(playerElement, 'jw-flag-fullscreen', fullscreenState);\r\n        style(document.body, { overflowY: (fullscreenState) ? 'hidden' : '' });\r\n\r\n        if (fullscreenState && _controls) {\r\n            // When going into fullscreen, we want the control bar to fade after a few seconds\r\n            _controls.userActive();\r\n        }\r\n\r\n        _resizeMedia();\r\n        _responsiveListener();\r\n    }\r\n\r\n    function _setLiveMode(model, streamType) {\r\n        if (!_instreamModel) {\r\n            const live = (streamType === 'LIVE');\r\n            toggleClass(_playerElement, 'jw-flag-live', live);\r\n        }\r\n    }\r\n\r\n    function _userActivityCallback(/* event */) {\r\n        _controls.userActive();\r\n    }\r\n\r\n    function _onMediaTypeChange(model, val) {\r\n        const isAudioFile = (val === 'audio');\r\n        const provider = _model.getVideo();\r\n        const isFlash = (provider && provider.getName().name.indexOf('flash') === 0);\r\n\r\n        toggleClass(_playerElement, 'jw-flag-media-audio', isAudioFile);\r\n\r\n        const element = (isAudioFile && !isFlash) ? _videoLayer : _videoLayer.nextSibling;\r\n        // Put the preview element before the media element in order to display browser captions\r\n        // otherwise keep it on top of the media element to display captions with the captions renderer\r\n        _playerElement.insertBefore(_preview.el, element);\r\n    }\r\n\r\n    function _errorHandler(model, evt) {\r\n        if (!evt) {\r\n            _title.playlistItem(model, model.get('playlistItem'));\r\n            return;\r\n        }\r\n        const errorContainer = ErrorContainer(_model, evt.message);\r\n        if (ErrorContainer.cloneIcon) {\r\n            errorContainer.querySelector('.jw-icon').appendChild(ErrorContainer.cloneIcon('error'));\r\n        }\r\n        _playerElement.appendChild(errorContainer.firstChild);\r\n        toggleClass(_playerElement, 'jw-flag-audio-player', !!model.get('audioMode'));\r\n    }\r\n\r\n    function _stateHandler(model, newState, oldState) {\r\n        if (!_model.get('viewSetup')) {\r\n            return;\r\n        }\r\n\r\n        _playerState = model.get('state');\r\n\r\n        instreamStateUpdate(_playerState);\r\n\r\n        if (oldState === STATE_ERROR) {\r\n            const errorContainer = _playerElement.querySelector('.jw-error-msg');\r\n            if (errorContainer) {\r\n                errorContainer.parentNode.removeChild(errorContainer);\r\n            }\r\n        }\r\n\r\n        cancelAnimationFrame(_stateClassRequestId);\r\n        if (_playerState === STATE_PLAYING || (_playerState === STATE_IDLE && _model.get('autostart'))) {\r\n            _stateUpdate(_playerState);\r\n        } else {\r\n            _stateClassRequestId = requestAnimationFrame(() => _stateUpdate(_playerState));\r\n        }\r\n    }\r\n\r\n    function instreamStateUpdate(state) {\r\n        let instreamState = null;\r\n        if (_instreamModel) {\r\n            instreamState = state;\r\n        }\r\n        if (_controls) {\r\n            _controls.instreamState = instreamState;\r\n        }\r\n    }\r\n\r\n    function _stateUpdate(state) {\r\n        if (_model.get('controls') && state !== STATE_PAUSED && hasClass(_playerElement, 'jw-flag-controls-hidden')) {\r\n            removeClass(_playerElement, 'jw-flag-controls-hidden');\r\n        }\r\n        replaceClass(_playerElement, /jw-state-\\S+/, 'jw-state-' + state);\r\n\r\n        _model.off('change:playlistItem', setPosterImage);\r\n        switch (state) {\r\n            case STATE_IDLE:\r\n            case STATE_ERROR:\r\n            case STATE_COMPLETE:\r\n                _model.change('playlistItem', setPosterImage);                \r\n                if (_captionsRenderer) {\r\n                    _captionsRenderer.hide();\r\n                }\r\n                break;\r\n            default:\r\n                if (_captionsRenderer) {\r\n                    _captionsRenderer.show();\r\n                    if (state === STATE_PAUSED && _controls && !_controls.showing) {\r\n                        _captionsRenderer.renderCues(true);\r\n                    }\r\n                }\r\n                break;\r\n        }\r\n    }\r\n\r\n    function setPosterImage(model) {\r\n        const playlistItem = model.get('playlistItem');\r\n        _preview.setImage(playlistItem && playlistItem.image);\r\n    }\r\n\r\n    const settingsMenuVisible = () => {\r\n        const settingsMenu = _controls && _controls.settingsMenu;\r\n        return !!(settingsMenu && settingsMenu.visible);\r\n    };\r\n\r\n    this.setupInstream = function (instreamModel) {\r\n        this.instreamModel = _instreamModel = instreamModel;\r\n        _instreamModel.on('change:controls', _onChangeControls, this);\r\n        _instreamModel.on('change:state', _stateHandler, this);\r\n        _instreamModel.on('change:playRejected', function (model, val) {\r\n            toggleClass(_playerElement, 'jw-flag-play-rejected', val);\r\n        }, this);\r\n\r\n        addClass(_playerElement, 'jw-flag-ads');\r\n        removeClass(_playerElement, 'jw-flag-live');\r\n\r\n        if (_controls) {\r\n            _controls.setupInstream(instreamModel);\r\n        }\r\n    };\r\n\r\n    this.setAltText = function (text) {\r\n        _model.set('altText', text);\r\n    };\r\n\r\n    this.destroyInstream = function () {\r\n        if (_instreamModel) {\r\n            _instreamModel.off(null, null, this);\r\n            _instreamModel = null;\r\n        }\r\n        if (!displayClickHandler) {\r\n            // view was destroyed\r\n            return;\r\n        }\r\n        if (_controls) {\r\n            _controls.destroyInstream(_model);\r\n        }\r\n\r\n        this.setAltText('');\r\n        removeClass(_playerElement, ['jw-flag-ads', 'jw-flag-ads-hide-controls']);\r\n        _model.set('hideAdsControls', false);\r\n        const provider = _model.getVideo();\r\n        if (provider) {\r\n            provider.setContainer(_videoLayer);\r\n        }\r\n        _setLiveMode(_model, _model.get('streamType'));\r\n        // reset display click handler\r\n        displayClickHandler.revertAlternateClickHandlers();\r\n    };\r\n\r\n    this.addCues = function (cues) {\r\n        _model.set('cues', cues);\r\n    };\r\n\r\n    this.clickHandler = function () {\r\n        return displayClickHandler;\r\n    };\r\n\r\n    this.getContainer = this.element = function () {\r\n        return _playerElement;\r\n    };\r\n\r\n    this.controlsContainer = function() {\r\n        if (_controls) {\r\n            return _controls.element();\r\n        }\r\n        return null;\r\n    };\r\n\r\n    this.getSafeRegion = function (excludeControlbar = true) {\r\n        const safeRegion = {\r\n            x: 0,\r\n            y: 0,\r\n            width: _lastWidth || 0,\r\n            height: _lastHeight || 0\r\n        };\r\n        if (_controls) {\r\n            // Subtract controlbar from the bottom when using one\r\n            if (excludeControlbar) {\r\n                safeRegion.height -= _controls.controlbarHeight();\r\n            }\r\n        }\r\n        return safeRegion;\r\n    };\r\n\r\n    this.setCaptions = function (captionsStyle) {\r\n        _captionsRenderer.clear();\r\n        _captionsRenderer.setup(_model.get('id'), captionsStyle);\r\n        _captionsRenderer.resize();\r\n    };\r\n\r\n    this.destroy = function () {\r\n        viewsManager.unobserve(_playerElement);\r\n        viewsManager.remove(this);\r\n        this.isSetup = false;\r\n        this.off();\r\n        cancelAnimationFrame(_resizeContainerRequestId);\r\n        clearTimeout(_resizeMediaTimeout);\r\n        if (focusHelper) {\r\n            focusHelper.destroy();\r\n            focusHelper = null;\r\n        }\r\n        if (fullscreenHelpers) {\r\n            fullscreenHelpers.destroy();\r\n            fullscreenHelpers = null;\r\n        }\r\n        if (_model.mediaController) {\r\n            _model.mediaController.off('fullscreenchange', _fullscreenChangeHandler);\r\n        }\r\n        if (_controls) {\r\n            _controls.disable(_model);\r\n        }\r\n\r\n        if (_instreamModel) {\r\n            this.destroyInstream();\r\n        }\r\n        if (displayClickHandler) {\r\n            displayClickHandler.destroy();\r\n            displayClickHandler = null;\r\n        }\r\n        if (_captionsRenderer) {\r\n            _captionsRenderer.destroy();\r\n            _captionsRenderer = null;\r\n        }\r\n        if (_logo) {\r\n            _logo.destroy();\r\n            _logo = null;\r\n        }\r\n        clearCss(_model.get('id'));\r\n    };\r\n}\r\n\r\nexport default View;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/view/view.js","export default (id, ariaLabel = '') => {\r\n    return (\r\n        `<div id=\"${id}\" class=\"jwplayer jw-reset jw-state-setup\" tabindex=\"0\" aria-label=\"${ariaLabel}\">` +\r\n            `<div class=\"jw-aspect jw-reset\"></div>` +\r\n            `<div class=\"jw-media jw-reset\"></div>` +\r\n            `<div class=\"jw-preview jw-reset\"></div>` +\r\n            `<div class=\"jw-title jw-reset\">` +\r\n                `<div class=\"jw-title-primary jw-reset\"></div>` +\r\n                `<div class=\"jw-title-secondary jw-reset\"></div>` +\r\n            `</div>` +\r\n            `<div class=\"jw-overlays jw-reset\"></div>` +\r\n        `</div>`\r\n    );\r\n};\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/templates/player.js","export const CONTROLBAR_ONLY_HEIGHT = 44;\r\n\r\nexport const isAudioMode = function(model) {\r\n    const playerHeight = model.get('height');\r\n    if (model.get('aspectratio')) {\r\n        return false;\r\n    }\r\n    if (typeof playerHeight === 'string' && playerHeight.indexOf('%') > -1) {\r\n        return false;\r\n    }\r\n\r\n    // Coerce into Number (don't parse out CSS units)\r\n    let verticalPixels = (playerHeight * 1) || NaN;\r\n    verticalPixels = (!isNaN(verticalPixels) ? verticalPixels : model.get('containerHeight'));\r\n    if (!verticalPixels) {\r\n        return false;\r\n    }\r\n\r\n    return verticalPixels && verticalPixels <= CONTROLBAR_ONLY_HEIGHT;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/view/utils/audio-mode.js","import activeTab from 'utils/active-tab';\r\nimport { requestAnimationFrame, cancelAnimationFrame } from 'utils/request-animation-frame';\r\n\r\nconst views = [];\r\nconst observed = {};\r\n\r\nlet intersectionObserver;\r\nlet responsiveRepaintRequestId = -1;\r\n\r\nfunction lazyInitIntersectionObserver() {\r\n    const IntersectionObserver = window.IntersectionObserver;\r\n    if (!intersectionObserver) {\r\n        // Fire the callback every time 25% of the player comes in/out of view\r\n        intersectionObserver = new IntersectionObserver((entries) => {\r\n            if (entries && entries.length) {\r\n                for (let i = entries.length; i--;) {\r\n                    const entry = entries[i];\r\n                    for (let j = views.length; j--;) {\r\n                        let view = views[j];\r\n                        if (entry.target === view.getContainer()) {\r\n                            view.model.set('intersectionRatio', entry.intersectionRatio);\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }, { threshold: [0, 0.25, 0.5, 0.75, 1] });\r\n    }\r\n}\r\n\r\nfunction scheduleResponsiveRedraw() {\r\n    cancelAnimationFrame(responsiveRepaintRequestId);\r\n    responsiveRepaintRequestId = requestAnimationFrame(function responsiveRepaint() {\r\n        views.forEach(view => {\r\n            view.updateBounds();\r\n        });\r\n        views.forEach(view => {\r\n            if (view.model.get('visibility')) {\r\n                view.updateStyles();\r\n            }\r\n        });\r\n        views.forEach(view => {\r\n            view.checkResized();\r\n        });\r\n    });\r\n}\r\n\r\nfunction onVisibilityChange() {\r\n    views.forEach(view => {\r\n        view.model.set('activeTab', activeTab());\r\n    });\r\n}\r\n\r\ndocument.addEventListener('visibilitychange', onVisibilityChange);\r\ndocument.addEventListener('webkitvisibilitychange', onVisibilityChange);\r\nwindow.addEventListener('resize', scheduleResponsiveRedraw);\r\nwindow.addEventListener('orientationchange', scheduleResponsiveRedraw);\r\n\r\nwindow.addEventListener('beforeunload', () => {\r\n    document.removeEventListener('visibilitychange', onVisibilityChange);\r\n    document.removeEventListener('webkitvisibilitychange', onVisibilityChange);\r\n    window.removeEventListener('resize', scheduleResponsiveRedraw);\r\n    window.removeEventListener('orientationchange', scheduleResponsiveRedraw);\r\n});\r\n\r\nexport default {\r\n    add: function(view) {\r\n        views.push(view);\r\n    },\r\n    remove: function(view) {\r\n        const index = views.indexOf(view);\r\n        if (index !== -1) {\r\n            views.splice(index, 1);\r\n        }\r\n    },\r\n    size: function() {\r\n        return views.length;\r\n    },\r\n    observe(container) {\r\n        lazyInitIntersectionObserver();\r\n\r\n        if (observed[container.id]) {\r\n            return;\r\n        }\r\n\r\n        observed[container.id] = true;\r\n        intersectionObserver.observe(container);\r\n    },\r\n    unobserve(container) {\r\n        if (intersectionObserver && observed[container.id]) {\r\n            delete observed[container.id];\r\n            intersectionObserver.unobserve(container);\r\n        }\r\n    },\r\n    getIntersectionObserver() {\r\n        return intersectionObserver;\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/view/utils/views-manager.js","export default function getVisibility(model, element) {\r\n    // Set visibility to 1 if we're in fullscreen\r\n    if (model.get('fullscreen')) {\r\n        return 1;\r\n    }\r\n\r\n    // Set visibility to 0 if we're not in the active tab\r\n    if (!model.get('activeTab')) {\r\n        return 0;\r\n    }\r\n    // Otherwise, set it to the intersection ratio reported from the intersection observer\r\n    let intersectionRatio = model.get('intersectionRatio');\r\n\r\n    if (intersectionRatio === undefined) {\r\n        // Get intersectionRatio through brute force\r\n        intersectionRatio = computeVisibility(element);\r\n    }\r\n\r\n    return intersectionRatio;\r\n}\r\n\r\nfunction computeVisibility(target) {\r\n    const html = document.documentElement;\r\n    const body = document.body;\r\n    const rootRect = {\r\n        top: 0,\r\n        left: 0,\r\n        right: html.clientWidth || body.clientWidth,\r\n        width: html.clientWidth || body.clientWidth,\r\n        bottom: html.clientHeight || body.clientHeight,\r\n        height: html.clientHeight || body.clientHeight\r\n    };\r\n\r\n    if (!body.contains(target)) {\r\n        return 0;\r\n    }\r\n    // If the element isn't displayed, an intersection can't happen.\r\n    if (window.getComputedStyle(target).display === 'none') {\r\n        return 0;\r\n    }\r\n\r\n    const targetRect = getBoundingClientRect(target);\r\n    if (!targetRect) {\r\n        return 0;\r\n    }\r\n\r\n    let intersectionRect = targetRect;\r\n    let parent = target.parentNode;\r\n    let atRoot = false;\r\n\r\n    while (!atRoot) {\r\n        let parentRect = null;\r\n        if (parent === body || parent === html || parent.nodeType !== 1) {\r\n            atRoot = true;\r\n            parentRect = rootRect;\r\n        } else if (window.getComputedStyle(parent).overflow !== 'visible') {\r\n            parentRect = getBoundingClientRect(parent);\r\n        }\r\n        if (parentRect) {\r\n            intersectionRect = computeRectIntersection(parentRect, intersectionRect);\r\n            if (!intersectionRect) {\r\n                return 0;\r\n            }\r\n        }\r\n        parent = parent.parentNode;\r\n    }\r\n    const targetArea = targetRect.width * targetRect.height;\r\n    const intersectionArea = intersectionRect.width * intersectionRect.height;\r\n    return targetArea ? (intersectionArea / targetArea) : 0;\r\n}\r\n\r\nfunction getBoundingClientRect(el) {\r\n    try {\r\n        return el.getBoundingClientRect();\r\n    } catch (e) {/* ignore Windows 7 IE11 \"Unspecified error\" */}\r\n}\r\n\r\nfunction computeRectIntersection(rect1, rect2) {\r\n    const top = Math.max(rect1.top, rect2.top);\r\n    const bottom = Math.min(rect1.bottom, rect2.bottom);\r\n    const left = Math.max(rect1.left, rect2.left);\r\n    const right = Math.min(rect1.right, rect2.right);\r\n    const width = right - left;\r\n    const height = bottom - top;\r\n    return (width >= 0 && height >= 0) && {\r\n        top: top,\r\n        bottom: bottom,\r\n        left: left,\r\n        right: right,\r\n        width: width,\r\n        height: height\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/view/utils/visibility.js","import { prefix } from 'utils/strings';\r\nimport { css, getRgba } from 'utils/css';\r\n\r\nexport function normalizeSkin(skinConfig = {}) {\r\n\r\n    const active = skinConfig.active;\r\n    const inactive = skinConfig.inactive;\r\n    const background = skinConfig.background;\r\n\r\n    const colors = {};\r\n\r\n    colors.controlbar = getControlBar(skinConfig.controlbar);\r\n\r\n    colors.timeslider = getTimeSlider(skinConfig.timeslider);\r\n\r\n    colors.menus = getMenus(skinConfig.menus);\r\n\r\n    colors.tooltips = getTooltips(skinConfig.tooltips);\r\n\r\n    function getControlBar(controlBarConfig) {\r\n        if (controlBarConfig || active || inactive || background) {\r\n            const config = {};\r\n\r\n            controlBarConfig = controlBarConfig || {};\r\n            config.iconsActive = controlBarConfig.iconsActive || active;\r\n            config.icons = controlBarConfig.icons || inactive;\r\n            config.text = controlBarConfig.text || inactive;\r\n            config.background = controlBarConfig.background || background;\r\n\r\n            return config;\r\n        }\r\n    }\r\n\r\n    function getTimeSlider(timesliderConfig) {\r\n        if (timesliderConfig || active) {\r\n            const config = {};\r\n\r\n            timesliderConfig = timesliderConfig || {};\r\n            config.progress = timesliderConfig.progress || active;\r\n            config.rail = timesliderConfig.rail;\r\n\r\n            return config;\r\n        }\r\n    }\r\n\r\n    function getMenus(menusConfig) {\r\n        if (menusConfig || active || inactive || background) {\r\n            const config = {};\r\n\r\n            menusConfig = menusConfig || {};\r\n            config.text = menusConfig.text || inactive;\r\n            config.textActive = menusConfig.textActive || active;\r\n            config.background = menusConfig.background || background;\r\n\r\n            return config;\r\n        }\r\n    }\r\n\r\n    function getTooltips(tooltipsConfig) {\r\n        if (tooltipsConfig || inactive || background) {\r\n            const config = {};\r\n\r\n            tooltipsConfig = tooltipsConfig || {};\r\n            config.text = tooltipsConfig.text || inactive;\r\n            config.background = tooltipsConfig.background || background;\r\n\r\n            return config;\r\n        }\r\n    }\r\n\r\n    return colors;\r\n}\r\n\r\nexport function handleColorOverrides(playerId, skin) {\r\n    if (!skin) {\r\n        return;\r\n    }\r\n\r\n    function addStyle(elements, attr, value, extendParent) {\r\n        if (!value) {\r\n            return;\r\n        }\r\n        /* if extendParent is true, bundle the first selector of\r\n         element string to the player element instead of defining it as a\r\n         child of the player element (default). i.e. #player.sel-1 .sel-2 vs. #player .sel-1 .sel-2 */\r\n        elements = prefix(elements, '#' + playerId + (extendParent ? '' : ' '));\r\n\r\n        const o = {};\r\n        o[attr] = value;\r\n        css(elements.join(', '), o, playerId);\r\n    }\r\n\r\n    // These will use standard style names for CSS since they are added directly to a style sheet\r\n    // Using background instead of background-color so we don't have to clear gradients with background-image\r\n\r\n    if (skin.controlbar) {\r\n        styleControlbar(skin.controlbar);\r\n    }\r\n    if (skin.timeslider) {\r\n        styleTimeslider(skin.timeslider);\r\n    }\r\n    if (skin.menus) {\r\n        styleMenus(skin.menus);\r\n    }\r\n    if (skin.tooltips) {\r\n        styleTooltips(skin.tooltips);\r\n    }\r\n\r\n    insertGlobalColorClasses(skin.menus);\r\n\r\n    function styleControlbar(config) {\r\n\r\n        addStyle([\r\n            // controlbar text colors\r\n            '.jw-controlbar .jw-icon-inline.jw-text',\r\n            '.jw-title-primary',\r\n            '.jw-title-secondary',\r\n        ], 'color', config.text);\r\n\r\n        if (config.icons) {\r\n            addStyle([\r\n                // controlbar button colors\r\n                '.jw-button-color:not(.jw-icon-cast)',\r\n                '.jw-button-color.jw-toggle.jw-off:not(.jw-icon-cast)',\r\n            ], 'color', config.icons);\r\n\r\n            addStyle([\r\n                '.jw-display-icon-container .jw-button-color',\r\n            ], 'color', config.icons);\r\n\r\n            // Chromecast overrides\r\n            // Can't use addStyle since it will camel case the style name\r\n            css(`#${playerId} .jw-icon-cast button.jw-off`, `{--disconnected-color: ${config.icons}}`, playerId);\r\n        }\r\n        if (config.iconsActive) {\r\n            addStyle([\r\n                '.jw-display-icon-container .jw-button-color:hover',\r\n                '.jw-display-icon-container .jw-button-color:focus',\r\n            ], 'color', config.iconsActive);\r\n\r\n            // Apply active color\r\n            addStyle([\r\n                // Toggle and menu button active colors\r\n                '.jw-button-color.jw-toggle:not(.jw-icon-cast)',\r\n                '.jw-button-color:hover:not(.jw-icon-cast)',\r\n                '.jw-button-color:focus:not(.jw-icon-cast)',\r\n                '.jw-button-color.jw-toggle.jw-off:hover:not(.jw-icon-cast)'\r\n            ], 'color', config.iconsActive);\r\n\r\n            addStyle([\r\n                '.jw-svg-icon-buffer',\r\n            ], 'fill', config.icons);\r\n\r\n            // Chromecast overrides\r\n            // Can't use addStyle since it will camel case the style name\r\n            css(`#${playerId} .jw-icon-cast:hover button.jw-off`, `{--disconnected-color: ${config.iconsActive}}`, playerId);\r\n            css(`#${playerId} .jw-icon-cast:focus button.jw-off`, `{--disconnected-color: ${config.iconsActive}}`, playerId);\r\n            css(`#${playerId} .jw-icon-cast button.jw-off:focus`, `{--disconnected-color: ${config.iconsActive}}`, playerId);\r\n\r\n            css(`#${playerId} .jw-icon-cast button`, `{--connected-color: ${config.iconsActive}}`, playerId);\r\n            css(`#${playerId} .jw-icon-cast button:focus`, `{--connected-color: ${config.iconsActive}}`, playerId);\r\n            css(`#${playerId} .jw-icon-cast:hover button`, `{--connected-color: ${config.iconsActive}}`, playerId);\r\n            css(`#${playerId} .jw-icon-cast:focus button`, `{--connected-color: ${config.iconsActive}}`, playerId);\r\n        }\r\n\r\n        // A space is purposefully left before '.jw-settings-topbar' since extendParent is set to true in order to append ':not(.jw-state-idle)'\r\n        addStyle([\r\n            ' .jw-settings-topbar',\r\n            ':not(.jw-state-idle) .jw-controlbar',\r\n            '.jw-flag-audio-player .jw-controlbar'\r\n        ], 'background', config.background, true);\r\n    }\r\n\r\n    function styleTimeslider(config) {\r\n\r\n        addStyle([\r\n            '.jw-progress',\r\n            '.jw-knob'\r\n        ], 'background-color', config.progress);\r\n\r\n        addStyle([\r\n            '.jw-buffer',\r\n        ], 'background-color', getRgba(config.progress, 50));\r\n\r\n        addStyle([\r\n            '.jw-rail'\r\n        ], 'background-color', config.rail);\r\n\r\n        addStyle([\r\n            '.jw-background-color.jw-slider-time',\r\n            '.jw-slider-time .jw-cue'\r\n        ], 'background-color', config.background);\r\n    }\r\n\r\n    function styleMenus(config) {\r\n\r\n        addStyle([\r\n            '.jw-option',\r\n            '.jw-toggle.jw-off',\r\n            '.jw-skip .jw-skip-icon',\r\n            '.jw-nextup-tooltip',\r\n            '.jw-nextup-close',\r\n            '.jw-settings-content-item'\r\n        ], 'color', config.text);\r\n\r\n        addStyle([\r\n            '.jw-option.jw-active-option',\r\n            '.jw-option:not(.jw-active-option):hover',\r\n            '.jw-option:not(.jw-active-option):focus',\r\n            '.jw-settings-item-active',\r\n            '.jw-settings-content-item:hover',\r\n            '.jw-settings-content-item:focus',\r\n            '.jw-nextup-tooltip:hover',\r\n            '.jw-nextup-tooltip:focus',\r\n            '.jw-nextup-close:hover'\r\n        ], 'color', config.textActive);\r\n\r\n        addStyle([\r\n            '.jw-nextup',\r\n            '.jw-settings-menu',\r\n        ], 'background', config.background);\r\n    }\r\n\r\n    function styleTooltips(config) {\r\n\r\n        addStyle([\r\n            '.jw-skip',\r\n            '.jw-tooltip .jw-text',\r\n            '.jw-time-tip .jw-text'\r\n        ], 'background-color', config.background);\r\n\r\n        addStyle([\r\n            '.jw-time-tip',\r\n            '.jw-tooltip'\r\n        ], 'color', config.background);\r\n\r\n        addStyle([\r\n            '.jw-skip',\r\n        ], 'border', 'none');\r\n\r\n        addStyle([\r\n            '.jw-skip .jw-text',\r\n            '.jw-skip .jw-icon',\r\n            '.jw-time-tip .jw-text',\r\n            '.jw-tooltip .jw-text'\r\n        ], 'color', config.text);\r\n    }\r\n\r\n    // Set global colors, used by related plugin\r\n    // If a color is undefined simple-style-loader won't add their styles to the dom\r\n    function insertGlobalColorClasses(config = {}) {\r\n        if (config.textActive) {\r\n            const activeColorSet = {\r\n                color: config.textActive,\r\n                borderColor: config.textActive,\r\n                stroke: config.textActive\r\n            };\r\n            css('#' + playerId + ' .jw-color-active', activeColorSet, playerId);\r\n            css('#' + playerId + ' .jw-color-active-hover:hover', activeColorSet, playerId);\r\n        }\r\n        if (config.text) {\r\n            const inactiveColorSet = {\r\n                color: config.text,\r\n                borderColor: config.text,\r\n                stroke: config.text\r\n            };\r\n            css('#' + playerId + ' .jw-color-inactive', inactiveColorSet, playerId);\r\n            css('#' + playerId + ' .jw-color-inactive-hover:hover', inactiveColorSet, playerId);\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/view/utils/skin.js","const DOCUMENT_FULLSCREEN_EVENTS = [\r\n    'fullscreenchange',\r\n    'webkitfullscreenchange',\r\n    'mozfullscreenchange',\r\n    'MSFullscreenChange'\r\n];\r\n\r\nexport default function(elementContext, documentContext, changeCallback) {\r\n    const requestFullscreen = elementContext.requestFullscreen ||\r\n        elementContext.webkitRequestFullscreen ||\r\n        elementContext.webkitRequestFullScreen ||\r\n        elementContext.mozRequestFullScreen ||\r\n        elementContext.msRequestFullscreen;\r\n\r\n    const exitFullscreen = documentContext.exitFullscreen ||\r\n        documentContext.webkitExitFullscreen ||\r\n        documentContext.webkitCancelFullScreen ||\r\n        documentContext.mozCancelFullScreen ||\r\n        documentContext.msExitFullscreen;\r\n\r\n    const supportsDomFullscreen = !!(requestFullscreen && exitFullscreen);\r\n\r\n    for (let i = DOCUMENT_FULLSCREEN_EVENTS.length; i--;) {\r\n        documentContext.addEventListener(DOCUMENT_FULLSCREEN_EVENTS[i], changeCallback);\r\n    }\r\n\r\n    return {\r\n        events: DOCUMENT_FULLSCREEN_EVENTS,\r\n        supportsDomFullscreen: function() {\r\n            return supportsDomFullscreen;\r\n        },\r\n        requestFullscreen: function() {\r\n            requestFullscreen.apply(elementContext);\r\n        },\r\n        exitFullscreen: function() {\r\n            exitFullscreen.apply(documentContext);\r\n        },\r\n        fullscreenElement: function() {\r\n            return documentContext.fullscreenElement ||\r\n                documentContext.webkitCurrentFullScreenElement ||\r\n                documentContext.mozFullScreenElement ||\r\n                documentContext.msFullscreenElement;\r\n        },\r\n        destroy: function() {\r\n            for (let i = DOCUMENT_FULLSCREEN_EVENTS.length; i--;) {\r\n                documentContext.removeEventListener(DOCUMENT_FULLSCREEN_EVENTS[i], changeCallback);\r\n            }\r\n        }\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/view/utils/request-fullscreen-helper.js","import { addClass, removeClass } from 'utils/dom';\r\n\r\n\r\nexport default function (elementContext) {\r\n    var _focusFromClick = false;\r\n\r\n    const onBlur = function () {\r\n        _focusFromClick = false;\r\n        removeClass(elementContext, 'jw-no-focus');\r\n    };\r\n\r\n    const onMouseDown = function () {\r\n        _focusFromClick = true;\r\n        addClass(elementContext, 'jw-no-focus');\r\n    };\r\n\r\n    const onFocus = function () {\r\n        if (!_focusFromClick) {\r\n            onBlur();\r\n        }\r\n    };\r\n\r\n    elementContext.addEventListener('focus', onFocus);\r\n    elementContext.addEventListener('blur', onBlur);\r\n    elementContext.addEventListener('mousedown', onMouseDown);\r\n\r\n    return {\r\n        destroy: function() {\r\n            elementContext.removeEventListener('focus', onFocus);\r\n            elementContext.removeEventListener('blur', onBlur);\r\n            elementContext.removeEventListener('mousedown', onMouseDown);\r\n        }\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/view/utils/flag-no-focus.js","import { CLICK } from 'events/events';\r\nimport UI from 'utils/ui';\r\nimport Events from 'utils/backbone.events';\r\n\r\nexport default class ClickHandler {\r\n    constructor(model, element, options) {\r\n        Object.assign(this, Events);\r\n\r\n        this.revertAlternateClickHandlers();\r\n        this.domElement = element;\r\n        this.model = model;\r\n\r\n        const defaultOptions = { enableDoubleTap: true, useMove: true };\r\n        this.ui = new UI(element, Object.assign(defaultOptions, options)).on({\r\n            'click tap': this.clickHandler,\r\n            'doubleClick doubleTap': function() {\r\n                if (this.alternateDoubleClickHandler) {\r\n                    this.alternateDoubleClickHandler();\r\n                    return;\r\n                }\r\n                this.trigger('doubleClick');\r\n            },\r\n            move: function() {\r\n                this.trigger('move');\r\n            },\r\n            over: function() {\r\n                this.trigger('over');\r\n            },\r\n            out: function() {\r\n                this.trigger('out');\r\n            }\r\n        }, this);\r\n    }\r\n\r\n    destroy() {\r\n        if (this.ui) {\r\n            this.ui.destroy();\r\n            this.ui = this.domElement = this.model = null;\r\n            this.revertAlternateClickHandlers();\r\n        }\r\n    }\r\n\r\n    clickHandler(evt) {\r\n        if (this.model.get('flashBlocked')) {\r\n            return;\r\n        }\r\n        if (this.alternateClickHandler) {\r\n            this.alternateClickHandler(evt);\r\n            return;\r\n        }\r\n        this.trigger((evt.type === CLICK) ? 'click' : 'tap');\r\n    }\r\n\r\n    element() {\r\n        return this.domElement;\r\n    }\r\n\r\n    setAlternateClickHandlers(clickHandler, doubleClickHandler) {\r\n        this.alternateClickHandler = clickHandler;\r\n        this.alternateDoubleClickHandler = doubleClickHandler || null;\r\n    }\r\n\r\n    revertAlternateClickHandlers() {\r\n        this.alternateClickHandler = null;\r\n        this.alternateDoubleClickHandler = null;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/view/utils/clickhandler.js","import { Browser } from 'environment/environment';\r\nimport { chunkLoadErrorHandler } from '../api/core-loader';\r\nimport Events from 'utils/backbone.events';\r\nimport { ERROR } from 'events/events';\r\nimport { css, style, getRgba } from 'utils/css';\r\nimport { addClass, removeClass, empty } from 'utils/dom';\r\nimport _ from 'utils/underscore';\r\n\r\n/** Component that renders the actual captions on screen. **/\r\n\r\nlet _WebVTT;\r\n\r\nconst _defaults = {\r\n    back: true,\r\n    backgroundOpacity: 50,\r\n    edgeStyle: null,\r\n    fontSize: 14,\r\n    fontOpacity: 100,\r\n    fontScale: 0.05, // Default captions font size = 1/20th of the video's height\r\n    preprocessor: _.identity,\r\n    windowOpacity: 0\r\n};\r\n\r\nconst CaptionsRenderer = function (_model) {\r\n\r\n    let _options;\r\n    let _captionsTrack;\r\n    let _currentCues;\r\n    let _timeEvent;\r\n    let _display;\r\n    let _captionsWindow;\r\n    let _textContainer;\r\n    let _fontScale;\r\n    let _windowStyle;\r\n\r\n    _display = document.createElement('div');\r\n    _display.className = 'jw-captions jw-reset';\r\n\r\n    this.show = function () {\r\n        addClass(_display, 'jw-captions-enabled');\r\n    };\r\n\r\n    this.hide = function () {\r\n        removeClass(_display, 'jw-captions-enabled');\r\n    };\r\n\r\n    // Assign list of captions to the renderer\r\n    this.populate = function (captions) {\r\n        if (_model.get('renderCaptionsNatively')) {\r\n            return;\r\n        }\r\n\r\n        _currentCues = [];\r\n        _captionsTrack = captions;\r\n        if (!captions) {\r\n            _currentCues = [];\r\n            this.renderCues();\r\n            return;\r\n        }\r\n        this.selectCues(captions, _timeEvent);\r\n    };\r\n\r\n    this.resize = function () {\r\n        _setFontSize();\r\n        this.renderCues(true);\r\n    };\r\n\r\n    this.renderCues = function (updateBoxPosition) {\r\n        updateBoxPosition = !!updateBoxPosition;\r\n        if (_WebVTT) {\r\n            _WebVTT.processCues(window, _currentCues, _display, updateBoxPosition);\r\n        }\r\n    };\r\n\r\n    this.selectCues = function (track, timeEvent) {\r\n        if (!track || !track.data || !timeEvent) {\r\n            return;\r\n        }\r\n\r\n        const pos = this.getAlignmentPosition(track, timeEvent);\r\n        if (pos === false) {\r\n            return;\r\n        }\r\n\r\n        const cues = this.getCurrentCues(track.data, pos);\r\n\r\n        this.updateCurrentCues(cues);\r\n        this.renderCues(true);\r\n    };\r\n\r\n    this.getCurrentCues = function (allCues, pos) {\r\n        return _.filter(allCues, function (cue) {\r\n            return pos >= (cue.startTime) && (!cue.endTime || pos <= cue.endTime);\r\n        });\r\n    };\r\n\r\n    this.updateCurrentCues = function (cues) {\r\n        // Render with vtt.js if there are cues, clear if there are none\r\n        if (!cues.length) {\r\n            _currentCues = [];\r\n        } else if (_.difference(cues, _currentCues).length) {\r\n            addClass(_captionsWindow, 'jw-captions-window-active');\r\n            _currentCues = cues;\r\n        }\r\n\r\n        return _currentCues;\r\n    };\r\n\r\n    this.getAlignmentPosition = function (track, timeEvent) {\r\n        const source = track.source;\r\n        const metadata = timeEvent.metadata;\r\n\r\n        // subtitles with \"source\" time must be synced with \"metadata[source]\"\r\n        if (source) {\r\n            if (metadata && _.isNumber(metadata[source])) {\r\n                return metadata[source];\r\n            }\r\n            return;\r\n        } else if (timeEvent.duration < 0) {\r\n            // When the duration is negative (DVR mode), need to make alignmentPosition positive for captions to work\r\n            return timeEvent.position - timeEvent.duration;\r\n        }\r\n\r\n        // Default to syncing with current position\r\n        return timeEvent.position;\r\n    };\r\n\r\n    this.clear = function () {\r\n        empty(_display);\r\n    };\r\n\r\n    /** Constructor for the renderer. **/\r\n    this.setup = function (playerElementId, options) {\r\n        _captionsWindow = document.createElement('div');\r\n        _textContainer = document.createElement('span');\r\n        _captionsWindow.className = 'jw-captions-window jw-reset';\r\n        _textContainer.className = 'jw-captions-text jw-reset';\r\n\r\n        _options = Object.assign({}, _defaults, options);\r\n\r\n        _fontScale = _defaults.fontScale;\r\n        _setFontScale(_options.fontSize);\r\n\r\n        const windowColor = _options.windowColor;\r\n        const windowOpacity = _options.windowOpacity;\r\n        const edgeStyle = _options.edgeStyle;\r\n        _windowStyle = {};\r\n        const textStyle = {};\r\n\r\n        _addTextStyle(textStyle, _options);\r\n\r\n        if (windowColor || windowOpacity !== _defaults.windowOpacity) {\r\n            _windowStyle.backgroundColor = getRgba(windowColor || '#000000', windowOpacity);\r\n        }\r\n\r\n        _addEdgeStyle(edgeStyle, textStyle, _options.fontOpacity);\r\n\r\n        if (!_options.back && edgeStyle === null) {\r\n            _addEdgeStyle('uniform', textStyle);\r\n        }\r\n\r\n        style(_captionsWindow, _windowStyle);\r\n        style(_textContainer, textStyle);\r\n        _setupCaptionStyles(playerElementId, textStyle);\r\n\r\n        _captionsWindow.appendChild(_textContainer);\r\n        _display.appendChild(_captionsWindow);\r\n\r\n        this.populate(_model.get('captionsTrack'));\r\n        _model.set('captions', _options);\r\n    };\r\n\r\n    this.element = function () {\r\n        return _display;\r\n    };\r\n\r\n    this.destroy = function() {\r\n        this.off();\r\n        _model.off(null, null, this);\r\n    };\r\n\r\n    function _setFontScale() {\r\n        if (!_.isFinite(_options.fontSize)) {\r\n            return;\r\n        }\r\n\r\n        const height = _model.get('containerHeight');\r\n\r\n        if (!height) {\r\n            _model.once('change:containerHeight', _setFontScale, this);\r\n            return;\r\n        }\r\n\r\n        // Adjust scale based on font size relative to the default\r\n        _fontScale = _defaults.fontScale * _options.fontSize / _defaults.fontSize;\r\n    }\r\n\r\n    function _setFontSize() {\r\n        const height = _model.get('containerHeight');\r\n\r\n        if (!height) {\r\n            return;\r\n        }\r\n\r\n        const fontSize = Math.round(height * _fontScale);\r\n\r\n        if (_model.get('renderCaptionsNatively')) {\r\n            _setShadowDOMFontSize(_model.get('id'), fontSize);\r\n        } else {\r\n            style(_display, {\r\n                fontSize: fontSize + 'px'\r\n            });\r\n        }\r\n    }\r\n\r\n    function _setupCaptionStyles(playerId, textStyle) {\r\n        _setFontSize();\r\n        _styleNativeCaptions(playerId, textStyle);\r\n        _stylePlayerCaptions(playerId, textStyle);\r\n    }\r\n\r\n    function _stylePlayerCaptions(playerId, textStyle) {\r\n        // VTT.js DOM window and text styles\r\n        css('#' + playerId + ' .jw-text-track-display', _windowStyle, playerId);\r\n        css('#' + playerId + ' .jw-text-track-cue', textStyle, playerId);\r\n    }\r\n\r\n    function _styleNativeCaptions(playerId, textStyle) {\r\n        if (Browser.safari) {\r\n            // Only Safari uses a separate element for styling text background\r\n            css('#' + playerId + ' .jw-video::-webkit-media-text-track-display-backdrop', {\r\n                backgroundColor: textStyle.backgroundColor\r\n            }, playerId, true);\r\n        }\r\n\r\n        css('#' + playerId + ' .jw-video::-webkit-media-text-track-display', _windowStyle, playerId, true);\r\n        css('#' + playerId + ' .jw-video::cue', textStyle, playerId, true);\r\n    }\r\n\r\n    function _setShadowDOMFontSize(playerId, fontSize) {\r\n        // Set Shadow DOM font size (needs to be important to override browser's in line style)\r\n        _windowStyle.fontSize = fontSize + 'px';\r\n        css('#' + playerId + ' .jw-video::-webkit-media-text-track-display', _windowStyle, playerId, true);\r\n    }\r\n\r\n    function _addTextStyle(textStyle, options) {\r\n        const color = options.color;\r\n        const fontOpacity = options.fontOpacity;\r\n        if (color || fontOpacity !== _defaults.fontOpacity) {\r\n            textStyle.color = getRgba(color || '#ffffff', fontOpacity);\r\n        }\r\n\r\n        if (options.back) {\r\n            const bgColor = options.backgroundColor;\r\n            const bgOpacity = options.backgroundOpacity;\r\n            if (bgColor !== _defaults.backgroundColor || bgOpacity !== _defaults.backgroundOpacity) {\r\n                textStyle.backgroundColor = getRgba(bgColor, bgOpacity);\r\n            }\r\n        } else {\r\n            textStyle.background = 'transparent';\r\n        }\r\n\r\n        if (options.fontFamily) {\r\n            textStyle.fontFamily = options.fontFamily;\r\n        }\r\n\r\n        if (options.fontStyle) {\r\n            textStyle.fontStyle = options.fontStyle;\r\n        }\r\n\r\n        if (options.fontWeight) {\r\n            textStyle.fontWeight = options.fontWeight;\r\n        }\r\n\r\n        if (options.textDecoration) {\r\n            textStyle.textDecoration = options.textDecoration;\r\n        }\r\n    }\r\n\r\n    function _addEdgeStyle(option, styles, fontOpacity) {\r\n        const color = getRgba('#000000', fontOpacity);\r\n        if (option === 'dropshadow') { // small drop shadow\r\n            styles.textShadow = '0 2px 1px ' + color;\r\n        } else if (option === 'raised') { // larger drop shadow\r\n            styles.textShadow = '0 0 5px ' + color + ', 0 1px 5px ' + color + ', 0 2px 5px ' + color;\r\n        } else if (option === 'depressed') { // top down shadow\r\n            styles.textShadow = '0 -2px 1px ' + color;\r\n        } else if (option === 'uniform') { // outline\r\n            styles.textShadow = '-2px 0 1px ' + color + ',2px 0 1px ' + color +\r\n                ',0 -2px 1px ' + color + ',0 2px 1px ' + color + ',-1px 1px 1px ' +\r\n                color + ',1px 1px 1px ' + color + ',1px -1px 1px ' + color +\r\n                ',1px 1px 1px ' + color;\r\n        }\r\n    }\r\n\r\n    function _timeChange(e) {\r\n        if (_model.get('renderCaptionsNatively')) {\r\n            return;\r\n        }\r\n\r\n        _timeEvent = e;\r\n        this.selectCues(_captionsTrack, _timeEvent);\r\n    }\r\n\r\n    function _captionsListHandler(model, captionsList) {\r\n        if (captionsList.length === 1) {\r\n            // captionsList only contains 'off'\r\n            return;\r\n        }\r\n\r\n        // don't load the polyfill or do unnecessary work if rendering natively\r\n        if (!model.get('renderCaptionsNatively') && !_WebVTT) {\r\n            loadWebVttPolyfill().catch((error) => {\r\n                this.trigger(ERROR, {\r\n                    message: 'Captions renderer failed to load',\r\n                    reason: error\r\n                });\r\n            });\r\n            model.off('change:captionsList', _captionsListHandler, this);\r\n        }\r\n    }\r\n\r\n    function loadWebVttPolyfill() {\r\n        return require.ensure(['polyfills/webvtt'], function (require) {\r\n            _WebVTT = require('polyfills/webvtt').default;\r\n        }, chunkLoadErrorHandler, 'polyfills.webvtt');\r\n    }\r\n\r\n    _model.on('change:playlistItem', function () {\r\n        _timeEvent = null;\r\n        _currentCues = [];\r\n    }, this);\r\n\r\n    _model.on('change:captionsTrack', function (model, captionsTrack) {\r\n        this.populate(captionsTrack);\r\n    }, this);\r\n\r\n    _model.mediaController.on('seek', function () {\r\n        _currentCues = [];\r\n    }, this);\r\n\r\n    _model.mediaController.on('time seek', _timeChange, this);\r\n\r\n    _model.mediaController.on('subtitlesTrackData', function () {\r\n        // update captions after a provider's subtitle track changes\r\n        this.selectCues(_captionsTrack, _timeEvent);\r\n    }, this);\r\n\r\n    _model.on('change:captionsList', _captionsListHandler, this);\r\n};\r\n\r\nObject.assign(CaptionsRenderer.prototype, Events);\r\n\r\nexport default CaptionsRenderer;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/view/captionsrenderer.js","import logoTemplate from 'templates/logo';\r\nimport { LOGO_CLICK } from 'events/events';\r\nimport UI from 'utils/ui';\r\nimport { style } from 'utils/css';\r\nimport { createElement } from 'utils/dom';\r\nimport Events from 'utils/backbone.events';\r\n\r\nconst LogoDefaults = {\r\n    linktarget: '_blank',\r\n    margin: 8,\r\n    hide: false,\r\n    position: 'top-right'\r\n};\r\n\r\nexport default function Logo(_model) {\r\n    Object.assign(this, Events);\r\n\r\n    var _logo;\r\n    var _settings;\r\n    const _img = new Image();\r\n\r\n    this.setup = function() {\r\n        _settings = Object.assign({}, LogoDefaults, _model.get('logo'));\r\n        _settings.position = _settings.position || LogoDefaults.position;\r\n        _settings.hide = (_settings.hide.toString() === 'true');\r\n\r\n        // We should only create a logo in the display container when\r\n        // it is not supposed to be in the control bar, as it will\r\n        // handle the creation in that case\r\n        if (!_settings.file || _settings.position === 'control-bar') {\r\n            return;\r\n        }\r\n\r\n        if (!_logo) {\r\n            _logo = createElement(logoTemplate(_settings.position, _settings.hide));\r\n        }\r\n\r\n        _model.set('logo', _settings);\r\n\r\n        // apply styles onload when image width and height are known\r\n        _img.onload = function () {\r\n            // update logo style\r\n            let height = this.height;\r\n            let width = this.width;\r\n            const styles = {\r\n                backgroundImage: 'url(\"' + this.src + '\")'\r\n            };\r\n            if (_settings.margin !== LogoDefaults.margin) {\r\n                const positions = (/(\\w+)-(\\w+)/).exec(_settings.position);\r\n                if (positions.length === 3) {\r\n                    styles['margin-' + positions[1]] = _settings.margin;\r\n                    styles['margin-' + positions[2]] = _settings.margin;\r\n                }\r\n            }\r\n\r\n            // Constraint logo size to 15% of their respective player dimension\r\n            const maxHeight = _model.get('containerHeight') * 0.15;\r\n            const maxWidth = _model.get('containerWidth') * 0.15;\r\n\r\n            if (height > maxHeight || width > maxWidth) {\r\n                const logoAR = width / height;\r\n                const videoAR = maxWidth / maxHeight;\r\n\r\n                if (videoAR > logoAR) {\r\n                    // height = max dimension\r\n                    height = maxHeight;\r\n                    width = maxHeight * logoAR;\r\n                } else {\r\n                    // width = max dimension\r\n                    width = maxWidth;\r\n                    height = maxWidth / logoAR;\r\n                }\r\n            }\r\n\r\n            styles.width = Math.round(width);\r\n            styles.height = Math.round(height);\r\n\r\n            style(_logo, styles);\r\n\r\n            // update title\r\n            _model.set('logoWidth', styles.width);\r\n        };\r\n\r\n        _img.src = _settings.file;\r\n\r\n        const logoInteractHandler = new UI(_logo);\r\n\r\n        if (_settings.link) {\r\n            _logo.setAttribute('tabindex', '0');\r\n            _logo.setAttribute('aria-label', 'Logo');\r\n        }\r\n\r\n        logoInteractHandler.on('click tap enter', function (evt) {\r\n            if (evt && evt.stopPropagation) {\r\n                evt.stopPropagation();\r\n            }\r\n\r\n            this.trigger(LOGO_CLICK, {\r\n                link: _settings.link,\r\n                linktarget: _settings.linktarget\r\n            });\r\n\r\n        }, this);\r\n    };\r\n\r\n    this.setContainer = function(container) {\r\n        if (_logo) {\r\n            container.appendChild(_logo);\r\n        }\r\n    };\r\n\r\n    this.element = function() {\r\n        return _logo;\r\n    };\r\n\r\n    this.position = function() {\r\n        return _settings.position;\r\n    };\r\n\r\n    this.destroy = function() {\r\n        _img.onload = null;\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/view/logo.js","export default (position, hide) => {\r\n    const jwhide = hide ? ' jw-hide' : '';\r\n    return `<div class=\"jw-logo jw-logo-${position}${jwhide} jw-reset\"></div>`;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/templates/logo.js","import { style } from 'utils/css';\r\n\r\nconst Preview = function(_model) {\r\n    this.model = _model;\r\n    this.image = null;\r\n};\r\n\r\nfunction validState(state) {\r\n    return state === 'complete' || state === 'idle' || state === 'error';\r\n}\r\n\r\nObject.assign(Preview.prototype, {\r\n    setup: function(element) {\r\n        this.el = element;\r\n    },\r\n    setImage: function(img) {\r\n        // Remove onload function from previous image\r\n        var image = this.image;\r\n        if (image) {\r\n            image.onload = null;\r\n        }\r\n        this.image = null;\r\n        if (!validState(this.model.get('state'))) {\r\n            return;\r\n        }\r\n        this.model.off('change:state', null, this);\r\n        var backgroundImage = '';\r\n        if (typeof img === 'string') {\r\n            backgroundImage = 'url(\"' + img + '\")';\r\n            image = this.image = new Image();\r\n            image.src = img;\r\n        }\r\n        style(this.el, {\r\n            backgroundImage: backgroundImage\r\n        });\r\n    },\r\n    resize: function(width, height, stretching) {\r\n        if (stretching === 'uniform') {\r\n            if (width) {\r\n                this.playerAspectRatio = width / height;\r\n            }\r\n            if (!this.playerAspectRatio ||\r\n                !this.image ||\r\n                !validState(this.model.get('state'))) {\r\n                return;\r\n            }\r\n            // snap image to edges when the difference in aspect ratio is less than 9%\r\n            var image = this.image;\r\n            var backgroundSize = null;\r\n            if (image) {\r\n                if (image.width === 0) {\r\n                    var _this = this;\r\n                    image.onload = function() {\r\n                        _this.resize(width, height, stretching);\r\n                    };\r\n                    return;\r\n                }\r\n                var imageAspectRatio = image.width / image.height;\r\n                if (Math.abs(this.playerAspectRatio - imageAspectRatio) < 0.09) {\r\n                    backgroundSize = 'cover';\r\n                }\r\n            }\r\n            style(this.el, {\r\n                backgroundSize: backgroundSize\r\n            });\r\n        }\r\n    },\r\n    element: function() {\r\n        return this.el;\r\n    }\r\n});\r\n\r\nexport default Preview;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/view/preview.js","import { style } from 'utils/css';\r\n\r\nconst Title = function(_model) {\r\n    this.model = _model;\r\n};\r\n\r\nObject.assign(Title.prototype, {\r\n    // This is normally shown/hidden by states\r\n    //   these are only used for when no title exists\r\n    hide: function() {\r\n        style(this.el, { display: 'none' });\r\n    },\r\n    show: function() {\r\n        style(this.el, { display: '' });\r\n    },\r\n\r\n    setup: function(titleEl) {\r\n        this.el = titleEl;\r\n\r\n        // Perform the DOM search only once\r\n        var arr = this.el.getElementsByTagName('div');\r\n        this.title = arr[0];\r\n        this.description = arr[1];\r\n\r\n        this.model.on('change:logoWidth', this.update, this);\r\n        this.model.change('playlistItem', this.playlistItem, this);\r\n    },\r\n\r\n    update: function(model) {\r\n        var titleStyle = {};\r\n        var logo = model.get('logo');\r\n        if (logo) {\r\n            // Only use Numeric or pixel (\"Npx\") margin values\r\n            var margin = 1 * ('' + logo.margin).replace('px', '');\r\n            var padding = model.get('logoWidth') + (isNaN(margin) ? 0 : margin + 10);\r\n            if (logo.position === 'top-left') {\r\n                titleStyle.paddingLeft = padding;\r\n            } else if (logo.position === 'top-right') {\r\n                titleStyle.paddingRight = padding;\r\n            }\r\n        }\r\n        style(this.el, titleStyle);\r\n    },\r\n\r\n    playlistItem: function(model, item) {\r\n        if (!item) {\r\n            return;\r\n        }\r\n        if (model.get('displaytitle') || model.get('displaydescription')) {\r\n            var title = '';\r\n            var description = '';\r\n\r\n            if (item.title && model.get('displaytitle')) {\r\n                title = item.title;\r\n            }\r\n            if (item.description && model.get('displaydescription')) {\r\n                description = item.description;\r\n            }\r\n\r\n            this.updateText(title, description);\r\n        } else {\r\n            this.hide();\r\n        }\r\n    },\r\n\r\n    updateText: function(title, description) {\r\n        this.title.innerHTML = title;\r\n        this.description.innerHTML = description;\r\n\r\n        if (this.title.firstChild || this.description.firstChild) {\r\n            this.show();\r\n        } else {\r\n            this.hide();\r\n        }\r\n    },\r\n\r\n    element: function() {\r\n        return this.el;\r\n    }\r\n});\r\n\r\nexport default Title;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/view/title.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/postcss-loader/lib/index.js!../../node_modules/less-loader/dist/cjs.js??ref--0-3!./jwplayer.less\");\nif(typeof content === 'string') content = [['all-players', content, '']];\n// add the styles to the DOM\nrequire(\"!../../node_modules/simple-style-loader/addStyles.js\").style(content,'all-players');\nif(content.locals) module.exports = content.locals;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/css/jwplayer.less\n// module id = 161\n// module chunks = 0 1 2 3 5","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".jw-reset{color:inherit;background-color:transparent;padding:0;margin:0;float:none;font-family:Arial,Helvetica,sans-serif;font-size:1em;line-height:1em;list-style:none;text-align:left;text-transform:none;vertical-align:baseline;border:0;direction:ltr;font-variant:inherit;font-stretch:inherit;-webkit-tap-highlight-color:rgba(255,255,255,0)}body .jw-error,body .jwplayer.jw-state-error{height:100%;width:100%}.jw-title{position:absolute;top:0}.jw-background-color{background:rgba(0,0,0,0.4)}.jw-text{color:rgba(255,255,255,0.8)}.jw-knob{color:rgba(255,255,255,0.8);background-color:#fff}.jw-button-color{color:rgba(255,255,255,0.8)}:not(.jw-flag-touch) .jw-button-color:not(.jw-logo-button):focus,:not(.jw-flag-touch) .jw-button-color:not(.jw-logo-button):hover{outline:none;color:#fff}.jw-toggle{color:#fff}.jw-toggle.jw-off{color:rgba(255,255,255,0.8)}.jw-toggle.jw-off:focus{color:#fff}.jw-toggle:focus{outline:none}:not(.jw-flag-touch) .jw-toggle.jw-off:hover{color:#fff}.jw-rail{background:rgba(255,255,255,0.3)}.jw-buffer{background:rgba(255,255,255,0.3)}.jw-progress{background:#f2f2f2}.jw-time-tip,.jw-volume-tip{border:0}.jw-slider-volume.jw-volume-tip.jw-background-color.jw-slider-vertical{background:none}.jw-skip{padding:.5em;outline:none}.jw-skip .jw-skiptext,.jw-skip .jw-skip-icon{color:rgba(255,255,255,0.8)}.jw-skip.jw-skippable:hover .jw-skip-icon,.jw-skip.jw-skippable:focus .jw-skip-icon{color:#fff}.jw-icon-cast button{--connected-color:#fff;--disconnected-color:rgba(255,255,255,0.8)}.jw-icon-cast button:focus{outline:none}.jw-icon-cast button.jw-off{--connected-color:rgba(255,255,255,0.8)}.jw-icon-cast:focus button{--connected-color:#fff;--disconnected-color:#fff}.jw-icon-cast:hover button{--connected-color:#fff;--disconnected-color:#fff}.jw-nextup-container{bottom:2.5em;padding:5px .5em}.jw-nextup{border-radius:0}.jw-color-active{color:#fff;stroke:#fff;border-color:#fff}:not(.jw-flag-touch) .jw-color-active-hover:hover{color:#fff;stroke:#fff;border-color:#fff}.jw-color-inactive{color:rgba(255,255,255,0.8);stroke:rgba(255,255,255,0.8);border-color:rgba(255,255,255,0.8)}:not(.jw-flag-touch) .jw-color-inactive-hover:hover{color:rgba(255,255,255,0.8);stroke:rgba(255,255,255,0.8);border-color:rgba(255,255,255,0.8)}.jw-option{color:rgba(255,255,255,0.8)}.jw-option.jw-active-option{color:#fff;background-color:rgba(255,255,255,0.1)}:not(.jw-flag-touch) .jw-option:hover{color:#fff}.jwplayer{width:100%;font-size:16px;position:relative;display:block;min-height:0;overflow:hidden;box-sizing:border-box;font-family:Arial,Helvetica,sans-serif;background-color:#000;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.jwplayer *{box-sizing:inherit}.jwplayer.jw-flag-aspect-mode{height:auto !important}.jwplayer.jw-flag-aspect-mode .jw-aspect{display:block}.jwplayer .jw-aspect{display:none}.jwplayer.jw-no-focus:focus,.jwplayer .jw-swf{outline:none}.jwplayer.jw-ie:focus{outline:#585858 dotted 1px}.jw-media,.jw-preview{position:absolute;width:100%;height:100%;top:0;left:0;bottom:0;right:0}.jw-media{overflow:hidden;cursor:pointer}.jw-plugin{position:absolute;bottom:66px}.jw-plugin .jw-banner{max-width:100%;opacity:0;cursor:pointer;position:absolute;margin:auto auto 0;left:0;right:0;bottom:0;display:block}.jw-preview,.jw-captions,.jw-title{pointer-events:none}.jw-media,.jw-logo{pointer-events:all}.jwplayer video{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;height:100%;margin:auto;background:transparent}.jwplayer video::-webkit-media-controls-start-playback-button{display:none}.jwplayer.jw-stretch-uniform video{object-fit:contain}.jwplayer.jw-stretch-none video{object-fit:none}.jwplayer.jw-stretch-fill video{object-fit:cover}.jwplayer.jw-stretch-exactfit video{object-fit:fill}.jw-preview{position:absolute;display:none;opacity:1;visibility:visible;width:100%;height:100%;background:#000 no-repeat 50% 50%}.jwplayer .jw-preview,.jw-error .jw-preview{background-size:contain}.jw-stretch-none .jw-preview{background-size:auto auto}.jw-stretch-fill .jw-preview{background-size:cover}.jw-stretch-exactfit .jw-preview{background-size:100% 100%}.jw-title{display:none;padding-top:20px;width:100%;z-index:1}.jw-title-primary,.jw-title-secondary{color:#fff;padding-left:20px;padding-right:20px;padding-bottom:.5em;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}.jw-title-primary{font-size:1.625em}.jw-breakpoint-2 .jw-title-primary,.jw-breakpoint-3 .jw-title-primary{font-size:1.5em}.jw-flag-small-player .jw-title-primary{font-size:1.25em}.jw-flag-small-player .jw-title-secondary,.jw-title-secondary:empty{display:none}.jw-captions{position:absolute;width:100%;height:100%;text-align:center;display:none;max-height:calc(100% - 60px);letter-spacing:normal;word-spacing:normal;text-transform:none;text-indent:0;text-decoration:none;pointer-events:none;overflow:hidden;top:0}.jw-captions.jw-captions-enabled{display:block}.jw-captions-window{display:none;padding:.25em;border-radius:.25em}.jw-captions-window.jw-captions-window-active{display:inline-block}.jw-captions-text{display:inline-block;color:#fff;background-color:#000;word-wrap:normal;word-break:normal;white-space:pre-line;font-style:normal;font-weight:normal;text-align:center;text-decoration:none}.jw-text-track-display{font-size:inherit;line-height:1.5}.jw-text-track-cue{background-color:rgba(0,0,0,0.5);color:#fff;padding:.1em .3em}.jwplayer video::-webkit-media-controls{display:none;justify-content:flex-start}.jwplayer video::-webkit-media-text-track-container{max-height:calc(100% - 60px);line-height:normal}.jwplayer video::-webkit-media-text-track-display{min-width:-webkit-min-content}.jwplayer video::cue{background-color:rgba(0,0,0,0.5)}.jwplayer video::-webkit-media-controls-panel-container{display:none}.jw-logo{position:absolute;margin:20px;cursor:pointer;pointer-events:all;background-repeat:no-repeat;background-size:contain;top:auto;right:auto;left:auto;bottom:auto}.jw-flag-audio-player .jw-logo{display:none}.jw-logo-top-right{top:0;right:0}.jw-logo-top-left{top:0;left:0}.jw-logo-bottom-left{left:0}.jw-logo-bottom-right{right:0}.jw-logo-bottom-left,.jw-logo-bottom-right{bottom:44px;transition:bottom 150ms cubic-bezier(0, -0.25, .25, 1)}.jw-state-idle .jw-logo{z-index:1}.jw-state-setup{background-color:transparent}.jw-state-setup .jw-logo,.jw-state-setup .jw-controls,.jw-state-setup .jw-controls-backdrop{visibility:hidden}body .jw-error,body .jwplayer.jw-state-error{background-color:#333;color:#fff;font-size:16px;display:table;opacity:1;overflow:hidden;position:relative}body .jw-error .jw-display,body .jwplayer.jw-state-error .jw-display{display:none}body .jw-error .jw-media,body .jwplayer.jw-state-error .jw-media{cursor:default}body .jw-error .jw-preview,body .jwplayer.jw-state-error .jw-preview{background-color:#333}body .jw-error .jw-error-msg,body .jwplayer.jw-state-error .jw-error-msg{top:50%;position:absolute;left:50%;align-items:center;background-color:#000;border-radius:2px;display:flex;padding:20px;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%)}body .jw-error .jw-error-msg .jw-icon,body .jwplayer.jw-state-error .jw-error-msg .jw-icon{height:30px;width:30px;margin-right:20px;flex:0 0 auto}body .jw-error .jw-error-msg .jw-icon:empty,body .jwplayer.jw-state-error .jw-error-msg .jw-icon:empty{display:none}body .jw-error .jw-error-msg .jw-title,body .jwplayer.jw-state-error .jw-error-msg .jw-title{display:block;position:static}body .jw-error .jw-error-msg .jw-title,body .jwplayer.jw-state-error .jw-error-msg .jw-title,body .jw-error .jw-error-msg .jw-title-primary,body .jwplayer.jw-state-error .jw-error-msg .jw-title-primary,body .jw-error .jw-error-msg .jw-title-secondary,body .jwplayer.jw-state-error .jw-error-msg .jw-title-secondary{font-size:14px;line-height:1.35;padding:0}body .jw-error .jw-error-msg .jw-title-primary,body .jwplayer.jw-state-error .jw-error-msg .jw-title-primary{font-weight:600;white-space:normal}.jwplayer.jw-state-error.jw-flag-audio-player .jw-error-msg{height:100%;width:100%;top:0;position:absolute;left:0;background:#000;-webkit-transform:none;transform:none;padding:0 16px;z-index:1}body .jwplayer.jw-state-error .jw-title,body .jw-error .jw-title,.jw-state-idle .jw-title,.jwplayer.jw-state-complete:not(.jw-flag-casting):not(.jw-flag-audio-player):not(.jw-flag-overlay-open-related) .jw-title{display:block}body .jwplayer.jw-state-error .jw-preview,body .jw-error .jw-preview,.jw-state-idle .jw-preview,.jwplayer.jw-state-complete:not(.jw-flag-casting):not(.jw-flag-audio-player):not(.jw-flag-overlay-open-related) .jw-preview{display:block}.jw-state-idle .jw-captions,.jwplayer.jw-state-complete .jw-captions,body .jwplayer.jw-state-error .jw-captions{display:none}.jw-state-idle video::-webkit-media-text-track-container,.jwplayer.jw-state-complete video::-webkit-media-text-track-container,body .jwplayer.jw-state-error video::-webkit-media-text-track-container{display:none}.jwplayer.jw-flag-fullscreen{width:100% !important;height:100% !important;top:0;right:0;bottom:0;left:0;z-index:1000;margin:0;position:fixed}body .jwplayer.jw-flag-flash-blocked .jw-title{display:block}.jwplayer.jw-flag-controls-hidden .jw-captions{max-height:none}.jwplayer.jw-flag-controls-hidden video::-webkit-media-text-track-container{max-height:none}.jwplayer.jw-flag-controls-hidden .jw-media{cursor:default}.jw-flag-audio-player:not(.jw-flag-flash-blocked) .jw-media{visibility:hidden}.jw-flag-audio-player .jw-title{background:none}.jw-flag-audio-player object{min-height:45px}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader!./node_modules/postcss-loader/lib!./node_modules/less-loader/dist/cjs.js?{\"compress\":true,\"strictMath\":true,\"noIeCompat\":true}!./src/css/jwplayer.less\n// module id = 162\n// module chunks = 0 1 2 3 5","export default function middleware(model, type, currentState) {\r\n    let newState = currentState;\r\n\r\n    switch (type) {\r\n        case 'time':\r\n        case 'beforePlay':\r\n        case 'pause':\r\n        case 'play':\r\n        case 'ready': {\r\n            const viewable = model.get('viewable');\r\n            // Don't add viewable to events if we don't know we're viewable\r\n            if (viewable !== undefined) {\r\n                // Emit viewable as 0 or 1\r\n                newState = Object.assign({}, currentState, { viewable: viewable });\r\n            }\r\n            break;\r\n        }\r\n        default: {\r\n            break;\r\n        }\r\n    }\r\n\r\n    return newState;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/controller/events-middleware.js","\r\n// It's DVR if the duration is above the minDvrWindow, Live otherwise\r\nexport function isDvr(duration, minDvrWindow) {\r\n    return Math.abs(duration) >= Math.max(minDvrWindow, 0);\r\n}\r\n\r\n// Determine the adaptive type - Live, DVR, or VOD\r\n// Duration can be positive or negative, but minDvrWindow should always be positive\r\nexport function streamType(duration, minDvrWindow) {\r\n    const _minDvrWindow = (minDvrWindow === undefined) ? 120 : minDvrWindow;\r\n    let type = 'VOD';\r\n\r\n    if (duration === Infinity) {\r\n        // Live streams are always Infinity duration\r\n        type = 'LIVE';\r\n    } else if (duration < 0) {\r\n        type = isDvr(duration, _minDvrWindow) ? 'DVR' : 'LIVE';\r\n    }\r\n\r\n    // Default option is VOD (i.e. positive or non-infinite)\r\n    return type;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/providers/utils/stream-type.js"],"sourceRoot":""}