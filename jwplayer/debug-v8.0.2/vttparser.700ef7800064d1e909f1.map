{"version":3,"sources":["webpack:///./src/js/utils/request-animation-frame.js","webpack:///./src/js/parsers/captions/vttparser.js"],"names":["requestAnimationFrame","window","callback","setTimeout","cancelAnimationFrame","clearTimeout","timestampRegex","integerRegex","fullLineRegex","noteRegex","removeTimestampRegex","colonDelimRegex","stringDelimRegex","whitespaceRegex","arrowRegex","headerRegex","VTTParser","decoder","state","buffer","StringDecoder","regionList","maxCueBatch","decode","data","Error","decodeURIComponent","encodeURIComponent","parseTimeStamp","input","computeSeconds","h","m","s","f","match","replace","Settings","values","Object","create","prototype","set","k","v","get","dflt","defaultKey","has","alt","a","n","length","integer","test","parseInt","percent","parseFloat","parseOptions","keyValueDelim","groupDelim","groups","split","i","kv","defaults","center","align","parseCue","cue","oInput","consumeTimeStamp","ts","consumeCueSettings","inputInner","cueInner","settings","id","region","vals","vals0","vertical","line","lineAlign","snapToLines","size","position","skipWhitespace","startTime","substr","endTime","parse","flushing","self","stream","collectNextLine","pos","errorHandler","oncue","e","alreadyCollectedLine","currentCueBatch","processBuffer","flush","hasSubstring","text","undefined","onflush"],"mappings":"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","file":"vttparser.js","sourcesContent":["export const requestAnimationFrame = window.requestAnimationFrame || function (callback) {\r\n    return setTimeout(callback, 17);\r\n};\r\n\r\nexport const cancelAnimationFrame = window.cancelAnimationFrame || clearTimeout;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/request-animation-frame.js","/* eslint-disable no-nested-ternary */\r\n/*\r\n* Source: https://github.com/mozilla/vtt.js/blob/master/dist/vtt.js#L1716\r\n*/\r\n\r\nimport { requestAnimationFrame } from 'utils/request-animation-frame';\r\nimport VTTCue from 'parsers/captions/vttcue';\r\n\r\nconst timestampRegex = /^(\\d+):(\\d{2})(:\\d{2})?\\.(\\d{3})/;\r\nconst integerRegex = /^-?\\d+$/;\r\nconst fullLineRegex = /\\r\\n|\\n/;\r\nconst noteRegex = /^NOTE($|[ \\t])/;\r\nconst removeTimestampRegex = /^[^\\sa-zA-Z-]+/;\r\nconst colonDelimRegex = /:/;\r\nconst stringDelimRegex = /\\s/;\r\nconst whitespaceRegex = /^\\s+/;\r\nconst arrowRegex = /-->/;\r\nconst headerRegex = /^WEBVTT([ \\t].*)?$/;\r\n\r\nconst VTTParser = function(window, decoder) {\r\n    this.window = window;\r\n    this.state = 'INITIAL';\r\n    this.buffer = '';\r\n    this.decoder = decoder || new StringDecoder();\r\n    this.regionList = [];\r\n    this.maxCueBatch = 1000;\r\n};\r\n\r\nfunction StringDecoder() {\r\n    return {\r\n        decode: function(data) {\r\n            if (!data) {\r\n                return '';\r\n            }\r\n            if (typeof data !== 'string') {\r\n                throw new Error('Error - expected string data.');\r\n            }\r\n            return decodeURIComponent(encodeURIComponent(data));\r\n        }\r\n    };\r\n}\r\n\r\n// Try to parse input as a time stamp.\r\nfunction parseTimeStamp(input) {\r\n\r\n    function computeSeconds(h, m, s, f) {\r\n        return (h | 0) * 3600 + (m | 0) * 60 + (s | 0) + (f | 0) / 1000;\r\n    }\r\n\r\n    var m = input.match(timestampRegex);\r\n    if (!m) {\r\n        return null;\r\n    }\r\n\r\n    if (m[3]) {\r\n        // Timestamp takes the form of [hours]:[minutes]:[seconds].[milliseconds]\r\n        return computeSeconds(m[1], m[2], m[3].replace(':', ''), m[4]);\r\n    } else if (m[1] > 59) {\r\n        // Timestamp takes the form of [hours]:[minutes].[milliseconds]\r\n        // First position is hours as it's over 59.\r\n        return computeSeconds(m[1], m[2], 0, m[4]);\r\n    }\r\n    // Timestamp takes the form of [minutes]:[seconds].[milliseconds]\r\n    return computeSeconds(0, m[1], m[2], m[4]);\r\n}\r\n\r\n// A settings object holds key/value pairs and will ignore anything but the first\r\n// assignment to a specific key.\r\nfunction Settings() {\r\n    this.values = Object.create(null);\r\n}\r\n\r\nSettings.prototype = {\r\n    // Only accept the first assignment to any key.\r\n    set: function(k, v) {\r\n        if (!this.get(k) && v !== '') {\r\n            this.values[k] = v;\r\n        }\r\n    },\r\n    // Return the value for a key, or a default value.\r\n    // If 'defaultKey' is passed then 'dflt' is assumed to be an object with\r\n    // a number of possible default values as properties where 'defaultKey' is\r\n    // the key of the property that will be chosen; otherwise it's assumed to be\r\n    // a single value.\r\n    get: function(k, dflt, defaultKey) {\r\n        if (defaultKey) {\r\n            return this.has(k) ? this.values[k] : dflt[defaultKey];\r\n        }\r\n        return this.has(k) ? this.values[k] : dflt;\r\n    },\r\n    // Check whether we have a value for a key.\r\n    has: function(k) {\r\n        return k in this.values;\r\n    },\r\n    // Accept a setting if its one of the given alternatives.\r\n    alt: function(k, v, a) {\r\n        for (var n = 0; n < a.length; ++n) {\r\n            if (v === a[n]) {\r\n                this.set(k, v);\r\n                break;\r\n            }\r\n        }\r\n    },\r\n    // Accept a setting if its a valid (signed) integer.\r\n    integer: function(k, v) {\r\n        if (integerRegex.test(v)) { // integer\r\n            this.set(k, parseInt(v, 10));\r\n        }\r\n    },\r\n    // Accept a setting if its a valid percentage.\r\n    percent: function(k, v) {\r\n        v = parseFloat(v);\r\n        if (v >= 0 && v <= 100) {\r\n            this.set(k, v);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n};\r\n\r\n// Helper function to parse input into groups separated by 'groupDelim', and\r\n// interprete each group as a key/value pair separated by 'keyValueDelim'.\r\nfunction parseOptions(input, callback, keyValueDelim, groupDelim) {\r\n    var groups = groupDelim ? input.split(groupDelim) : [input];\r\n    for (var i = 0; i <= groups.length; i += 1) {\r\n        if (typeof groups[i] !== 'string') {\r\n            continue;\r\n        }\r\n        var kv = groups[i].split(keyValueDelim);\r\n        if (kv.length !== 2) {\r\n            continue;\r\n        }\r\n        var k = kv[0];\r\n        var v = kv[1];\r\n        callback(k, v);\r\n    }\r\n}\r\n\r\nvar defaults = new VTTCue(0, 0, 0);\r\n// 'middle' was changed to 'center' in the spec: https://github.com/w3c/webvtt/pull/244\r\n// Chrome and Safari don't yet support this change, but FF does\r\nvar center = defaults.align === 'middle' ? 'middle' : 'center';\r\n\r\nfunction parseCue(input, cue, regionList) {\r\n    // Remember the original input if we need to throw an error.\r\n    var oInput = input;\r\n    // 4.1 WebVTT timestamp\r\n    function consumeTimeStamp() {\r\n        var ts = parseTimeStamp(input);\r\n        if (ts === null) {\r\n            throw new Error('Malformed timestamp: ' + oInput);\r\n        }\r\n        // Remove time stamp from input.\r\n        input = input.replace(removeTimestampRegex, '');\r\n        return ts;\r\n    }\r\n\r\n    // 4.4.2 WebVTT cue settings\r\n    function consumeCueSettings(inputInner, cueInner) {\r\n        var settings = new Settings();\r\n\r\n        parseOptions(inputInner, function (k, v) {\r\n            switch (k) {\r\n                case 'region':\r\n                    // Find the last region we parsed with the same region id.\r\n                    for (var i = regionList.length - 1; i >= 0; i--) {\r\n                        if (regionList[i].id === v) {\r\n                            settings.set(k, regionList[i].region);\r\n                            break;\r\n                        }\r\n                    }\r\n                    break;\r\n                case 'vertical':\r\n                    settings.alt(k, v, ['rl', 'lr']);\r\n                    break;\r\n                case 'line': {\r\n                    const vals = v.split(',');\r\n                    const vals0 = vals[0];\r\n                    settings.integer(k, vals0);\r\n                    if (settings.percent(k, vals0)) {\r\n                        settings.set('snapToLines', false);\r\n                    }\r\n                    settings.alt(k, vals0, ['auto']);\r\n                    if (vals.length === 2) {\r\n                        settings.alt('lineAlign', vals[1], ['start', center, 'end']);\r\n                    }\r\n                    break;\r\n                }\r\n                case 'position': {\r\n                    const vals = v.split(',');\r\n                    settings.percent(k, vals[0]);\r\n                    if (vals.length === 2) {\r\n                        settings.alt('positionAlign', vals[1], ['start', center, 'end', 'line-left', 'line-right', 'auto']);\r\n                    }\r\n                    break;\r\n                }\r\n                case 'size':\r\n                    settings.percent(k, v);\r\n                    break;\r\n                case 'align':\r\n                    settings.alt(k, v, ['start', center, 'end', 'left', 'right']);\r\n                    break;\r\n                default:\r\n            }\r\n        }, colonDelimRegex, stringDelimRegex);\r\n\r\n        // Apply default values for any missing fields.\r\n        cueInner.region = settings.get('region', null);\r\n        cueInner.vertical = settings.get('vertical', '');\r\n        var line = settings.get('line', 'auto');\r\n        if (line === 'auto' && defaults.line === -1) {\r\n            // set numeric line number for Safari\r\n            line = -1;\r\n        }\r\n        cueInner.line = line;\r\n        cueInner.lineAlign = settings.get('lineAlign', 'start');\r\n        cueInner.snapToLines = settings.get('snapToLines', true);\r\n        cueInner.size = settings.get('size', 100);\r\n        cueInner.align = settings.get('align', center);\r\n        var position = settings.get('position', 'auto');\r\n        if (position === 'auto' && defaults.position === 50) {\r\n            // set numeric position for Safari\r\n            position = cueInner.align === 'start' || cueInner.align === 'left' ? 0 : cueInner.align === 'end' || cueInner.align === 'right' ? 100 : 50;\r\n        }\r\n        cueInner.position = position;\r\n    }\r\n\r\n    function skipWhitespace() {\r\n        input = input.replace(whitespaceRegex, '');\r\n    }\r\n\r\n    // 4.1 WebVTT cue timings.\r\n    skipWhitespace();\r\n    cue.startTime = consumeTimeStamp(); // (1) collect cue start time\r\n    skipWhitespace();\r\n    if (input.substr(0, 3) !== '-->') { // (3) next characters must match '-->'\r\n        throw new Error('Malformed time stamp (time stamps must be separated by \\'-->\\'): ' +\r\n            oInput);\r\n    }\r\n    input = input.substr(3);\r\n    skipWhitespace();\r\n    cue.endTime = consumeTimeStamp(); // (5) collect cue end time\r\n\r\n    // 4.1 WebVTT cue settings list.\r\n    skipWhitespace();\r\n    consumeCueSettings(input, cue);\r\n}\r\n\r\nVTTParser.prototype = {\r\n    parse: function (data, flushing) {\r\n        var self = this;\r\n\r\n        // If there is no data then we won't decode it, but will just try to parse\r\n        // whatever is in buffer already. This may occur in circumstances, for\r\n        // example when flush() is called.\r\n        if (data) {\r\n            // Try to decode the data that we received.\r\n            self.buffer += self.decoder.decode(data, { stream: true });\r\n        }\r\n\r\n        function collectNextLine() {\r\n            var buffer = self.buffer;\r\n            var pos = 0;\r\n            while (pos < buffer.length && buffer[pos] !== '\\r' && buffer[pos] !== '\\n') {\r\n                ++pos;\r\n            }\r\n            var line = buffer.substr(0, pos);\r\n            // Advance the buffer early in case we fail below.\r\n            if (buffer[pos] === '\\r') {\r\n                ++pos;\r\n            }\r\n            if (buffer[pos] === '\\n') {\r\n                ++pos;\r\n            }\r\n            self.buffer = buffer.substr(pos);\r\n            return line;\r\n        }\r\n\r\n        // 3.2 WebVTT metadata header syntax\r\n        // function parseHeader(input) {\r\n        //     parseOptions(input, function (k, v) {\r\n        //         switch (k) {\r\n        //             case 'Region':\r\n        //                 // 3.3 WebVTT region metadata header syntax\r\n        //                 console.log('parse region', v);\r\n        //                 // parseRegion(v);\r\n        //                 break;\r\n        //             default:\r\n        //         }\r\n        //     }, colonDelimRegex);\r\n        // }\r\n\r\n        function errorHandler() {\r\n            // If we are currently parsing a cue, report what we have.\r\n            if (self.state === 'CUETEXT' && self.cue && self.oncue) {\r\n                self.oncue(self.cue);\r\n            }\r\n            self.cue = null;\r\n            // Enter BADWEBVTT state if header was not parsed correctly otherwise\r\n            // another exception occurred so enter BADCUE state.\r\n            self.state = self.state === 'INITIAL' ? 'BADWEBVTT' : 'BADCUE';\r\n        }\r\n\r\n        // 5.1 WebVTT file parsing.\r\n        try {\r\n            var line;\r\n            if (self.state === 'INITIAL') {\r\n                // We can't start parsing until we have the first line.\r\n                if (!fullLineRegex.test(self.buffer)) {\r\n                    return this;\r\n                }\r\n\r\n                line = collectNextLine();\r\n\r\n                var m = line.match(headerRegex);\r\n                if (!m || !m[0]) {\r\n                    throw new Error('Malformed WebVTT signature.');\r\n                }\r\n                self.state = 'HEADER';\r\n            }\r\n        } catch (e) {\r\n            errorHandler();\r\n            return this;\r\n        }\r\n\r\n        var alreadyCollectedLine = false;\r\n        var currentCueBatch = 0;\r\n        function processBuffer() {\r\n            try {\r\n                while (self.buffer && currentCueBatch <= self.maxCueBatch) {\r\n                    // We can't parse a line until we have the full line.\r\n                    if (!fullLineRegex.test(self.buffer)) {\r\n                        self.flush();\r\n                        return this;\r\n                    }\r\n\r\n                    if (!alreadyCollectedLine) {\r\n                        line = collectNextLine();\r\n                    } else {\r\n                        alreadyCollectedLine = false;\r\n                    }\r\n\r\n                    switch (self.state) {\r\n                        case 'HEADER':\r\n                            // 13-18 - Allow a header (metadata) under the WEBVTT line.\r\n                            if (colonDelimRegex.test(line)) {\r\n                                // parseHeader(line);\r\n                            } else if (!line) {\r\n                                // An empty line terminates the header and starts the body (cues).\r\n                                self.state = 'ID';\r\n                            }\r\n                            break;\r\n                        case 'NOTE':\r\n                            // Ignore NOTE blocks.\r\n                            if (!line) {\r\n                                self.state = 'ID';\r\n                            }\r\n                            break;\r\n                        case 'ID':\r\n                            // Check for the start of NOTE blocks.\r\n                            if (noteRegex.test(line)) {\r\n                                self.state = 'NOTE';\r\n                                break;\r\n                            }\r\n                            // 19-29 - Allow any number of line terminators, then initialize new cue values.\r\n                            if (!line) {\r\n                                break;\r\n                            }\r\n                            self.cue = new VTTCue(0, 0, '');\r\n                            self.state = 'CUE';\r\n                            // 30-39 - Check if self line contains an optional identifier or timing data.\r\n                            if (!arrowRegex.test(line)) {\r\n                                self.cue.id = line;\r\n                                break;\r\n                            }\r\n                        // Process line as start of a cue.\r\n                        /* falls through*/\r\n                        case 'CUE':\r\n                            // 40 - Collect cue timings and settings.\r\n                            try {\r\n                                parseCue(line, self.cue, self.regionList);\r\n                            } catch (e) {\r\n                                // In case of an error ignore rest of the cue.\r\n                                self.cue = null;\r\n                                self.state = 'BADCUE';\r\n                                break;\r\n                            }\r\n                            self.state = 'CUETEXT';\r\n                            break;\r\n                        case 'CUETEXT':\r\n                            var hasSubstring = arrowRegex.test(line);\r\n                            // 34 - If we have an empty line then report the cue.\r\n                            // 35 - If we have the special substring '-->' then report the cue,\r\n                            // but do not collect the line as we need to process the current\r\n                            // one as a new cue.\r\n                            if (!line || hasSubstring && (alreadyCollectedLine = true)) {\r\n                                // We are done parsing self cue.\r\n                                if (self.oncue) {\r\n                                    currentCueBatch += 1;\r\n                                    self.oncue(self.cue);\r\n                                }\r\n                                self.cue = null;\r\n                                self.state = 'ID';\r\n                                break;\r\n                            }\r\n                            if (self.cue.text) {\r\n                                self.cue.text += '\\n';\r\n                            }\r\n                            self.cue.text += line;\r\n                            break;\r\n                        case 'BADCUE': // BADCUE\r\n                            // 54-62 - Collect and discard the remaining cue.\r\n                            if (!line) {\r\n                                self.state = 'ID';\r\n                            }\r\n                            break;\r\n                        default:\r\n                    }\r\n                }\r\n\r\n                currentCueBatch = 0;\r\n                if (self.buffer) {\r\n                    requestAnimationFrame(processBuffer);\r\n                } else if (!flushing) {\r\n                    self.flush();\r\n                    return this;\r\n                }\r\n            } catch (e) {\r\n                errorHandler(e);\r\n                return this;\r\n            }\r\n        }\r\n\r\n        // Immediately process some cues\r\n        processBuffer();\r\n    },\r\n    flush: function () {\r\n        var self = this;\r\n        try {\r\n            // Finish decoding the stream.\r\n            self.buffer += self.decoder.decode();\r\n            // Synthesize the end of the current cue or region.\r\n            if (self.cue || self.state === 'HEADER') {\r\n                self.buffer += '\\n\\n';\r\n                self.parse(undefined, true);\r\n            }\r\n            // If we've flushed, parsed, and we're still on the INITIAL state then\r\n            // that means we don't have enough of the stream to parse the first\r\n            // line.\r\n            if (self.state === 'INITIAL') {\r\n                throw new Error('Malformed WebVTT signature.');\r\n            }\r\n        } catch (e) {\r\n            throw e;\r\n        }\r\n        if (self.onflush) {\r\n            self.onflush();\r\n        }\r\n        return this;\r\n    }\r\n};\r\n\r\nexport default VTTParser;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/parsers/captions/vttparser.js"],"sourceRoot":""}