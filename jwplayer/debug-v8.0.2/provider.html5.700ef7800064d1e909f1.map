{"version":3,"sources":["webpack:///./src/js/utils/time-ranges.js","webpack:///./src/js/providers/data-normalizer.js","webpack:///./src/js/providers/video-listener-mixin.js","webpack:///./src/js/providers/video-actions-mixin.js","webpack:///./src/js/providers/video-attached-mixin.js","webpack:///./src/js/providers/tracks-mixin.js","webpack:///./src/js/providers/utils/id3Parser.js","webpack:///./src/js/providers/utils/play-promise.js","webpack:///./src/js/parsers/captions/srt.js","webpack:///./src/js/controller/tracks-loader.js","webpack:///./src/js/controller/tracks-helper.js","webpack:///./src/js/parsers/captions/vttcue.js","webpack:///./src/js/parsers/captions/dfxp.js","webpack:///./src/js/providers/html5.js"],"names":["endOfRange","timeRanges","length","end","qualityLevel","level","bitrate","label","width","height","VideoListenerMixin","canplay","trigger","play","video","paused","state","setState","loadedmetadata","metadata","duration","getDuration","videoHeight","videoWidth","drmUsed","drm","timeupdate","stopStallCheck","_helperLastVideoHeight","adaptation","size","position","getCurrentTime","isNaN","seeking","startStallCheck","timeEventObject","getPtsOffset","ptsOffset","mpegts","click","evt","volumechange","volume","Math","round","mute","muted","seeked","playing","pause","ended","error","currentTime","progress","dur","Infinity","buf","buffered","between","bufferPercent","ratechange","playbackRate","loadeddata","renderNatively","setTextTracks","textTracks","code","message","VideoActionsMixin","container","vol","max","min","removeAttribute","resize","stretching","playerAspectRatio","videoAspectRatio","objectFit","abs","getContainer","setContainer","element","firstChild","insertBefore","remove","stop","destroy","parentNode","removeChild","STALL_DELAY","VideoAttachedMixin","stallCheckTimeout_","lastStalledTime_","NaN","attachMedia","eventsOn_","detachMedia","eventsOff_","clearTimeout","setTimeout","stalledHandler","bind","checkStartTime","atEdgeOfLiveStream","setPlaybackRate","isLive","timeFudge","setAutoplayAttributes","setAttribute","removeAutoplayAttributes","Tracks","_itemTracks","_textTracks","_tracksById","_cuesByTrackId","_cachedVTTCues","_metaCuesByTextTime","_currentTextTrackIndex","_unknownCount","_activeCuePosition","_initTextTracks","addTracksListener","clearTracks","clearCueData","disableTextTrack","enableTextTrack","getSubtitlesTrack","removeTracksListener","addTextTracks","setupSideloadedTracks","setSubtitlesTrack","textTrackChangeHandler","addTrackHandler","addCuesToTrack","addCaptionsCue","addVTTCue","addVTTCuesToTrack","tracks","reject","track","trackId","_id","indexOf","name","nativemetadata","i","len","kind","labelInfo","unknownCount","inuse","mode","oncuechange","_cueChangeHandler","_kindSupported","cue","cues","embedded","loaded","shift","_addCueToTrack","_addTrackToList","call","edge","firefox","safari","itemTracks","alreadyLoaded","_clearSideloadedTextTracks","menuIndex","setCurrentSubtitleTrack","each","currentTrack","cueData","text","begin","trackid","toString","data","cueId","useDTS","source","vttCue","push","type","itemTrack","_createTrack","_cacheVTTCue","captions","cuesToConvert","sort","a","b","vttCues","Array","prototype","apply","eventType","handler","instreamMode","addEventListener","removeEventListener","metadataTrack","_removeCues","inUseTracks","filter","_tracksModified","selectedTextTrackIndex","tracksArray","forEach","textTrackAny","file","reason","textTrack","ie","window","TextTrackCue","addCue","textTrackCue","startTime","endTime","test","removeCue","findWhere","addTextTrack","language","default","nonSideloadedTracks","groupid","e","activeCues","currentTarget","dataCues","value","metadataTime","JSON","parse","id3Data","trackKind","cachedCues","cacheKeyTime","floor","cacheLine","line","cacheValue","cueExists","Uint8Array","join","utf8ArrayToStr","syncSafeInt","parseID3","friendlyNames","TIT2","TT2","WXXX","TPE1","TP1","TALB","TAL","array","startingIndex","c","char2","char3","out","String","fromCharCode","utf16BigEndianArrayToStr","lastDoubleByte","sizeArray","arrayToInt","sizeString","parseInt","reduce","ArrayBuffer","oldCue","arrayLength","key","startPos","firstByte","infoDelimiterPosition","j","info","subarray","ptsIs33Bit","transportStreamTimestamp","encoding","hasOwnProperty","collection","Object","createPlayPromise","resolve","Error","removeEventListeners","listener","Srt","_captions","list","split","entry","_entry","idx","index","substr","slice","loadFile","cancelXhr","convertToVTTCues","successHandler","errorHandler","xhr","ajax","xhrSuccess","onload","onreadystatechange","onerror","abort","map","xmlRoot","responseXML","nextSibling","nodeType","COMMENT_NODE","responseText","loadVttParser","then","parser","VTTParser","oncue","onflush","catch","require","createId","createLabel","tracksCount","prefix","defaulttrack","VTTCue","findDirectionSetting","directionSetting","lr","rl","dir","toLowerCase","findAlignSetting","alignSetting","start","middle","left","right","align","autoKeyword","hasBeenReset","_pauseOnExit","_startTime","_endTime","_text","_region","_vertical","_snapToLines","_line","_lineAlign","_position","_size","_align","defineProperty","enumerable","get","set","TypeError","setting","SyntaxError","displayState","undefined","getCueAsHTML","WebVTT","convertCueToDOMTree","Dfxp","xmlDoc","validate","paragraphs","getElementsByTagName","frameRate","tt","parsedFrameRate","parseFloat","getAttribute","p","breaks","replaceChild","createTextNode","rawText","innerHTML","textContent","replace","parseError","object","MIN_DVR_DURATION","_name","_setupListeners","eventsHash","videoTag","keys","eventName","_removeListeners","VideoProvider","_playerId","_playerConfig","configRenderNatively","iOS","chrome","_this","MediaEvents","checkStaleStream","_positionBeforeSeek","_videotag","_setPositionBeforeSeek","checkVisualQuality","_currentQuality","clearTimeouts","_androidHls","durationchange","_setAudioTracks","audioTracks","_checkDelayedSeek","_canSeek","_setMediaType","version","major","offset","_seekOffset","_delayedSeek","setLoadingState","webkitbeginfullscreen","_fullscreenState","_sendFullscreen","webkitendfullscreen","mixinEventHandler","renderCaptionsNatively","loop","mediaElement","visualQuality","_staleStreamDuration","_levels","_beforeResumeHandler","noop","_audioTracks","_currentAudioTrackIndex","_staleStreamTimeout","_stale","_lastEndOfBuffer","_setAttribute","className","isSDK","sdkplatform","supportsPlaybackRate","_convertTime","_getSeekableEnd","seekableDuration","_getSeekableStart","seek","_getPublicLevels","levels","publicLevels","typeOf","_setLevels","_pickInitialQuality","currentQuality","qualityLabel","_play","_completeLoad","previousSource","src","sourceElement","document","createElement","sourceChanged","_setVideotagSource","load","sendMediaType","_clearVideotagSource","msie","seekable","_audioTrackChangeHandler","off","init","item","sources","preload","starttime","unpausing","isLiveNotDvr","behindLiveEdge","seekPos","_selectedAudioTrackIndex","enabled","_setCurrentAudioTrack","target","jwstate","setVisibility","android","visibility","opacity","styles","fitVideoUsingTransforms","androidNative","x","y","scaleX","ceil","scaleY","top","margin","toFixed","setFullscreen","status","tryCatch","enterFullscreen","webkitEnterFullscreen","webkitEnterFullScreen","getFullScreen","exitFullscreen","webkitExitFullscreen","webkitExitFullScreen","webkitDisplayingFullscreen","setCurrentQuality","quality","time","defaultPlaybackRate","getPlaybackRate","getCurrentQuality","getQualityLevels","getName","setCurrentAudioTrack","getAudioTracks","_getAudioTracks","getCurrentAudioTrack","_getCurrentAudioTrack","_track","mediaType","endOfBuffer","live","checkStreamEnded"],"mappings":"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","file":"provider.html5.js","sourcesContent":["export default function endOfRange(timeRanges) {\r\n    if (!timeRanges || !timeRanges.length) {\r\n        return 0;\r\n    }\r\n\r\n    return timeRanges.end(timeRanges.length - 1);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/time-ranges.js","export function qualityLevel(level) {\r\n    return {\r\n        bitrate: level.bitrate,\r\n        label: level.label,\r\n        width: level.width,\r\n        height: level.height\r\n    };\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/providers/data-normalizer.js","import { STATE_IDLE, STATE_COMPLETE, STATE_STALLED, STATE_LOADING, STATE_PLAYING, STATE_PAUSED,\r\n    PROVIDER_FIRST_FRAME, CLICK, MEDIA_BUFFER_FULL, MEDIA_RATE_CHANGE, MEDIA_ERROR,\r\n    MEDIA_BUFFER, MEDIA_META, MEDIA_TIME, MEDIA_SEEKED, MEDIA_VOLUME, MEDIA_MUTE, MEDIA_COMPLETE\r\n} from 'events/events';\r\nimport utils from 'utils/helpers';\r\n\r\n// This will trigger the events required by jwplayer model to\r\n//  properly follow the state of the video tag\r\n//\r\n// Assumptions\r\n//  1. All functions are bound to the \"this\" of the provider\r\n//  2. The provider has an attribute \"video\" which is the video tag\r\n\r\nconst VideoListenerMixin = {\r\n    canplay() {\r\n        this.trigger(MEDIA_BUFFER_FULL);\r\n    },\r\n\r\n    play() {\r\n        if (!this.video.paused && this.state !== STATE_PLAYING) {\r\n            this.setState(STATE_LOADING);\r\n        }\r\n    },\r\n\r\n    loadedmetadata() {\r\n        var metadata = {\r\n            duration: this.getDuration(),\r\n            height: this.video.videoHeight,\r\n            width: this.video.videoWidth\r\n        };\r\n        var drmUsed = this.drmUsed;\r\n        if (drmUsed) {\r\n            metadata.drm = drmUsed;\r\n        }\r\n        this.trigger(MEDIA_META, metadata);\r\n    },\r\n\r\n    timeupdate() {\r\n        this.stopStallCheck();\r\n        var height = this.video.videoHeight;\r\n        if (height !== this._helperLastVideoHeight) {\r\n            if (this.adaptation) {\r\n                this.adaptation({\r\n                    size: {\r\n                        width: this.video.videoWidth,\r\n                        height: height\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        this._helperLastVideoHeight = height;\r\n\r\n        const position = this.getCurrentTime();\r\n        const duration = this.getDuration();\r\n        if (isNaN(duration)) {\r\n            return;\r\n        }\r\n\r\n        if (!this.seeking && !this.video.paused && (this.state === STATE_STALLED || this.state === STATE_LOADING)) {\r\n            this.startStallCheck();\r\n            this.setState(STATE_PLAYING);\r\n        }\r\n\r\n        var timeEventObject = {\r\n            position: position,\r\n            duration: duration\r\n        };\r\n        if (this.getPtsOffset) {\r\n            var ptsOffset = this.getPtsOffset();\r\n            if (ptsOffset >= 0) {\r\n                timeEventObject.metadata = {\r\n                    mpegts: ptsOffset + position\r\n                };\r\n            }\r\n        }\r\n\r\n        // only emit time events when playing or seeking\r\n        if (this.state === STATE_PLAYING || this.seeking) {\r\n            this.trigger(MEDIA_TIME, timeEventObject);\r\n        }\r\n    },\r\n\r\n    click(evt) {\r\n        this.trigger(CLICK, evt);\r\n    },\r\n\r\n    volumechange() {\r\n        var video = this.video;\r\n\r\n        this.trigger(MEDIA_VOLUME, {\r\n            volume: Math.round(video.volume * 100)\r\n        });\r\n\r\n        this.trigger(MEDIA_MUTE, {\r\n            mute: video.muted\r\n        });\r\n    },\r\n\r\n    seeked() {\r\n        if (!this.seeking) {\r\n            return;\r\n        }\r\n        this.seeking = false;\r\n        this.trigger(MEDIA_SEEKED);\r\n    },\r\n\r\n    playing() {\r\n        if (!this.seeking) {\r\n            this.setState(STATE_PLAYING);\r\n        }\r\n        this.trigger(PROVIDER_FIRST_FRAME);\r\n    },\r\n\r\n    pause() {\r\n        // Sometimes the browser will fire \"complete\" and then a \"pause\" event\r\n        if (this.state === STATE_COMPLETE) {\r\n            return;\r\n        }\r\n        if (this.video.ended) {\r\n            return;\r\n        }\r\n        if (this.video.error) {\r\n            return;\r\n        }\r\n        // If \"pause\" fires before \"complete\", we still don't want to propagate it\r\n        if (this.video.currentTime === this.video.duration) {\r\n            return;\r\n        }\r\n        this.setState(STATE_PAUSED);\r\n    },\r\n\r\n    progress() {\r\n        var dur = this.getDuration();\r\n        if (dur <= 0 || dur === Infinity) {\r\n            return;\r\n        }\r\n        var buf = this.video.buffered;\r\n        if (!buf || buf.length === 0) {\r\n            return;\r\n        }\r\n\r\n        var buffered = utils.between(buf.end(buf.length - 1) / dur, 0, 1);\r\n        this.trigger(MEDIA_BUFFER, {\r\n            bufferPercent: buffered * 100,\r\n            position: this.getCurrentTime(),\r\n            duration: dur\r\n        });\r\n    },\r\n\r\n    ratechange() {\r\n        this.trigger(MEDIA_RATE_CHANGE, { playbackRate: this.video.playbackRate });\r\n    },\r\n\r\n    ended() {\r\n        this.stopStallCheck();\r\n        this._helperLastVideoHeight = 0;\r\n        if (this.state !== STATE_IDLE && this.state !== STATE_COMPLETE) {\r\n            this.trigger(MEDIA_COMPLETE);\r\n        }\r\n    },\r\n    loadeddata () {\r\n        // If we're not rendering natively text tracks will be provided from another source - don't duplicate them here\r\n        if (this.renderNatively) {\r\n            this.setTextTracks(this.video.textTracks);\r\n        }\r\n    },\r\n    error() {\r\n        var code = (this.video.error && this.video.error.code) || -1;\r\n        var message = ({\r\n            1: 'Unknown operation aborted',\r\n            2: 'Unknown network error',\r\n            3: 'Unknown decode error',\r\n            4: 'File could not be played'\r\n        }[code] || 'Unknown');\r\n        this.trigger(MEDIA_ERROR, {\r\n            code: code,\r\n            message: 'Error loading media: ' + message\r\n        });\r\n    }\r\n};\r\n\r\nexport default VideoListenerMixin;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/providers/video-listener-mixin.js","import { style } from 'utils/css';\r\n\r\nconst VideoActionsMixin = {\r\n    container: null,\r\n\r\n    volume: function(vol) {\r\n        vol = Math.max(Math.min(vol / 100, 1), 0);\r\n        this.video.volume = vol;\r\n    },\r\n\r\n    mute: function(state) {\r\n        this.video.muted = !!state;\r\n        if (!this.video.muted) {\r\n            // Remove muted attribute once user unmutes so the video element doesn't get\r\n            // muted by the browser when the src changes or on replay\r\n            this.video.removeAttribute('muted');\r\n        }\r\n    },\r\n\r\n    resize: function(width, height, stretching) {\r\n        if (!width || !height || !this.video.videoWidth || !this.video.videoHeight) {\r\n            return false;\r\n        }\r\n        if (stretching === 'uniform') {\r\n            // snap video to edges when the difference in aspect ratio is less than 9%\r\n            var playerAspectRatio = width / height;\r\n            var videoAspectRatio = this.video.videoWidth / this.video.videoHeight;\r\n            var objectFit = null;\r\n            if (Math.abs(playerAspectRatio - videoAspectRatio) < 0.09) {\r\n                objectFit = 'fill';\r\n            }\r\n            style(this.video, {\r\n                objectFit,\r\n                width: null,\r\n                height: null\r\n            });\r\n        }\r\n        return false;\r\n    },\r\n\r\n    getContainer: function() {\r\n        return this.container;\r\n    },\r\n\r\n    setContainer: function(element) {\r\n        this.container = element;\r\n        if (this.video !== element.firstChild) {\r\n            element.insertBefore(this.video, element.firstChild);\r\n        }\r\n    },\r\n\r\n    remove: function() {\r\n        this.stop();\r\n        this.destroy();\r\n        if (this.container === this.video.parentNode) {\r\n            this.container.removeChild(this.video);\r\n        }\r\n    }\r\n};\r\n\r\nexport default VideoActionsMixin;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/providers/video-actions-mixin.js","import { STATE_LOADING, STATE_STALLED, STATE_ERROR } from 'events/events';\r\nimport endOfRange from 'utils/time-ranges';\r\n\r\nconst STALL_DELAY = 256;\r\n\r\nconst VideoAttachedMixin = {\r\n    stallCheckTimeout_: -1,\r\n    lastStalledTime_: NaN,\r\n\r\n    attachMedia: function() {\r\n        this.eventsOn_();\r\n    },\r\n\r\n    detachMedia: function() {\r\n        this.stopStallCheck();\r\n        this.eventsOff_();\r\n\r\n        return this.video;\r\n    },\r\n\r\n    stopStallCheck: function() {\r\n        clearTimeout(this.stallCheckTimeout_);\r\n    },\r\n\r\n    startStallCheck: function() {\r\n        this.stopStallCheck();\r\n        this.stallCheckTimeout_ = setTimeout(this.stalledHandler.bind(this, this.video.currentTime), STALL_DELAY);\r\n    },\r\n\r\n    stalledHandler: function(checkStartTime) {\r\n        if (checkStartTime !== this.video.currentTime) {\r\n            return;\r\n        }\r\n\r\n        if (this.video.paused || this.video.ended) {\r\n            return;\r\n        }\r\n\r\n        // A stall after loading/error, should just stay loading/error\r\n        if (this.state === STATE_LOADING || this.state === STATE_ERROR) {\r\n            return;\r\n        }\r\n\r\n        // During seek we stay in paused state\r\n        if (this.seeking) {\r\n            return;\r\n        }\r\n\r\n        if (this.atEdgeOfLiveStream()) {\r\n            this.setPlaybackRate(1);\r\n        }\r\n        this.setState(STATE_STALLED);\r\n    },\r\n\r\n    atEdgeOfLiveStream: function() {\r\n        if (!this.isLive()) {\r\n            return false;\r\n        }\r\n\r\n        // currentTime doesn't always get to the end of the buffered range\r\n        const timeFudge = 2;\r\n        return (endOfRange(this.video.buffered) - this.video.currentTime) <= timeFudge;\r\n    },\r\n\r\n    setAutoplayAttributes: function() {\r\n        this.video.setAttribute('autoplay', '');\r\n        this.video.setAttribute('muted', '');\r\n    },\r\n\r\n    removeAutoplayAttributes: function() {\r\n        this.video.removeAttribute('autoplay');\r\n        this.video.removeAttribute('muted');\r\n    }\r\n};\r\n\r\nexport default VideoAttachedMixin;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/providers/video-attached-mixin.js","import { loadFile, cancelXhr, convertToVTTCues } from 'controller/tracks-loader';\r\nimport { createId, createLabel } from 'controller/tracks-helper';\r\nimport { parseID3 } from 'providers/utils/id3Parser';\r\nimport { Browser } from 'environment/environment';\r\nimport { ERROR } from 'events/events';\r\nimport _ from 'utils/underscore';\r\n\r\n/**\r\n * Used across all providers for loading tracks and handling browser track-related events\r\n */\r\nconst Tracks = {\r\n    _itemTracks: null,\r\n    _textTracks: null,\r\n    _tracksById: null,\r\n    _cuesByTrackId: null,\r\n    _cachedVTTCues: null,\r\n    _metaCuesByTextTime: null,\r\n    _currentTextTrackIndex: -1,\r\n    _unknownCount: 0,\r\n    _activeCuePosition: null,\r\n    _initTextTracks: _initTextTracks,\r\n    addTracksListener: addTracksListener,\r\n    clearTracks: clearTracks,\r\n    clearCueData: clearCueData,\r\n    disableTextTrack: disableTextTrack,\r\n    enableTextTrack: enableTextTrack,\r\n    getSubtitlesTrack: getSubtitlesTrack,\r\n    removeTracksListener: removeTracksListener,\r\n    addTextTracks: addTextTracks,\r\n    setTextTracks: setTextTracks,\r\n    setupSideloadedTracks: setupSideloadedTracks,\r\n    setSubtitlesTrack: setSubtitlesTrack,\r\n    textTrackChangeHandler: null,\r\n    addTrackHandler: null,\r\n    addCuesToTrack: addCuesToTrack,\r\n    addCaptionsCue: addCaptionsCue,\r\n    addVTTCue: addVTTCue,\r\n    addVTTCuesToTrack: addVTTCuesToTrack,\r\n    renderNatively: false\r\n};\r\n\r\nfunction setTextTracks(tracks) {\r\n    this._currentTextTrackIndex = -1;\r\n    if (!tracks) {\r\n        return;\r\n    }\r\n\r\n    if (!this._textTracks) {\r\n        this._initTextTracks();\r\n    } else {\r\n        // Remove the 608 captions track that was mutated by the browser\r\n        this._unknownCount = 0;\r\n        this._textTracks = _.reject(this._textTracks, function(track) {\r\n            const trackId = track._id;\r\n            if (this.renderNatively && trackId && trackId.indexOf('nativecaptions') === 0) {\r\n                delete this._tracksById[trackId];\r\n                return true;\r\n            } else if (track.name.indexOf('Unknown') === 0) {\r\n                this._unknownCount++;\r\n            }\r\n        }, this);\r\n\r\n        // Remove the ID3 track from the cache\r\n        delete this._tracksById.nativemetadata;\r\n    }\r\n\r\n    // filter for 'subtitles' or 'captions' tracks\r\n    if (tracks.length) {\r\n        var i = 0;\r\n        var len = tracks.length;\r\n\r\n        for (i; i < len; i++) {\r\n            var track = tracks[i];\r\n            if (!track._id) {\r\n                if (track.kind === 'captions' || track.kind === 'metadata') {\r\n                    track._id = 'native' + track.kind + i;\r\n                    if (!track.label && track.kind === 'captions') {\r\n                        // track label is read only in Safari\r\n                        // 'captions' tracks without a label need a name in order for the cc menu to work\r\n                        var labelInfo = createLabel(track, this._unknownCount);\r\n                        track.name = labelInfo.label;\r\n                        this._unknownCount = labelInfo.unknownCount;\r\n                    }\r\n                } else {\r\n                    track._id = createId(track, this._textTracks.length);\r\n                }\r\n                if (this._tracksById[track._id]) {\r\n                    // tracks without unique ids must not be marked as \"inuse\"\r\n                    continue;\r\n                }\r\n                track.inuse = true;\r\n            }\r\n            if (!track.inuse || this._tracksById[track._id]) {\r\n                continue;\r\n            }\r\n            // setup TextTrack\r\n            if (track.kind === 'metadata') {\r\n                // track mode needs to be \"hidden\", not \"showing\", so that cues don't display as captions in Firefox\r\n                track.mode = 'hidden';\r\n                track.oncuechange = _cueChangeHandler.bind(this);\r\n                this._tracksById[track._id] = track;\r\n            } else if (_kindSupported(track.kind)) {\r\n                var mode = track.mode;\r\n                var cue;\r\n\r\n                // By setting the track mode to 'hidden', we can determine if the track has cues\r\n                track.mode = 'hidden';\r\n\r\n                if (!track.cues.length && track.embedded) {\r\n                    // There's no method to remove tracks added via: video.addTextTrack.\r\n                    // This ensures the 608 captions track isn't added to the CC menu until it has cues\r\n                    continue;\r\n                }\r\n\r\n                track.mode = mode;\r\n\r\n                // Parsed cues may not have been added to this track yet\r\n                if (this._cuesByTrackId[track._id] && !this._cuesByTrackId[track._id].loaded) {\r\n                    var cues = this._cuesByTrackId[track._id].cues;\r\n                    while ((cue = cues.shift())) {\r\n                        _addCueToTrack(this.renderNatively, track, cue);\r\n                    }\r\n                    track.mode = mode;\r\n                    this._cuesByTrackId[track._id].loaded = true;\r\n                }\r\n\r\n                _addTrackToList.call(this, track);\r\n            }\r\n        }\r\n    }\r\n\r\n    if (this.renderNatively) {\r\n        // Only bind and set this.textTrackChangeHandler once so that removeEventListener works\r\n        this.textTrackChangeHandler = this.textTrackChangeHandler || textTrackChangeHandler.bind(this);\r\n        this.addTracksListener(this.video.textTracks, 'change', this.textTrackChangeHandler);\r\n\r\n        if (Browser.edge || Browser.firefox || Browser.safari) {\r\n            // Listen for TextTracks added to the videotag after the onloadeddata event in Edge and Firefox\r\n            this.addTrackHandler = this.addTrackHandler || addTrackHandler.bind(this);\r\n            this.addTracksListener(this.video.textTracks, 'addtrack', this.addTrackHandler);\r\n        }\r\n    }\r\n\r\n    if (this._textTracks.length) {\r\n        this.trigger('subtitlesTracks', { tracks: this._textTracks });\r\n    }\r\n}\r\n\r\nfunction setupSideloadedTracks(itemTracks) {\r\n    // Add tracks if we're starting playback or resuming after a midroll\r\n\r\n    if (!this.renderNatively) {\r\n        return;\r\n    }\r\n    // Determine if the tracks are the same and the embedded + sideloaded count = # of tracks in the controlbar\r\n    var alreadyLoaded = itemTracks === this._itemTracks;\r\n    if (!alreadyLoaded) {\r\n        cancelXhr(this._itemTracks);\r\n    }\r\n    this._itemTracks = itemTracks;\r\n    if (!itemTracks) {\r\n        return;\r\n    }\r\n\r\n    if (!alreadyLoaded) {\r\n        this.disableTextTrack();\r\n        _clearSideloadedTextTracks.call(this);\r\n        this.addTextTracks(itemTracks);\r\n    }\r\n}\r\n\r\nfunction getSubtitlesTrack() {\r\n    return this._currentTextTrackIndex;\r\n}\r\n\r\nfunction setSubtitlesTrack(menuIndex) {\r\n    if (!this.renderNatively) {\r\n        if (this.setCurrentSubtitleTrack) {\r\n            this.setCurrentSubtitleTrack(menuIndex - 1);\r\n        }\r\n        return;\r\n    }\r\n\r\n    if (!this._textTracks) {\r\n        return;\r\n    }\r\n\r\n    // 0 = 'Off'\r\n    if (menuIndex === 0) {\r\n        _.each(this._textTracks, function (track) {\r\n            track.mode = track.embedded ? 'hidden' : 'disabled';\r\n        });\r\n    }\r\n\r\n    // Track index is 1 less than controlbar index to account for 'Off' = 0.\r\n    // Prevent unnecessary track change events\r\n    if (this._currentTextTrackIndex === menuIndex - 1) {\r\n        return;\r\n    }\r\n\r\n    // Turn off current track\r\n    this.disableTextTrack();\r\n\r\n    // Set the provider's index to the model's index, then show the selected track if it exists\r\n    this._currentTextTrackIndex = menuIndex - 1;\r\n\r\n    if (this._textTracks[this._currentTextTrackIndex]) {\r\n        this._textTracks[this._currentTextTrackIndex].mode = 'showing';\r\n    }\r\n\r\n    // Update the model index since the track change may have come from a browser event\r\n    this.trigger('subtitlesTrackChanged', {\r\n        currentTrack: this._currentTextTrackIndex + 1,\r\n        tracks: this._textTracks\r\n    });\r\n}\r\n\r\nfunction addCaptionsCue(cueData) {\r\n    if (!cueData.text || !cueData.begin || !cueData.end) {\r\n        return;\r\n    }\r\n    var trackId = cueData.trackid.toString();\r\n    var track = this._tracksById && this._tracksById[trackId];\r\n    if (!track) {\r\n        track = {\r\n            kind: 'captions',\r\n            _id: trackId,\r\n            data: []\r\n        };\r\n        this.addTextTracks([track]);\r\n        this.trigger('subtitlesTracks', { tracks: this._textTracks });\r\n    }\r\n\r\n    var cueId;\r\n\r\n    if (cueData.useDTS) {\r\n        // There may not be any 608 captions when the track is first created\r\n        // Need to set the source so position is determined from metadata\r\n        if (!track.source) {\r\n            track.source = cueData.source || 'mpegts';\r\n        }\r\n\r\n    }\r\n    cueId = cueData.begin + '_' + cueData.text;\r\n\r\n    var cue = this._metaCuesByTextTime[cueId];\r\n    if (!cue) {\r\n        cue = {\r\n            begin: cueData.begin,\r\n            end: cueData.end,\r\n            text: cueData.text\r\n        };\r\n        this._metaCuesByTextTime[cueId] = cue;\r\n        var vttCue = convertToVTTCues([cue])[0];\r\n        track.data.push(vttCue);\r\n    }\r\n}\r\n\r\nfunction addVTTCue(cueData) {\r\n    if (!this._tracksById) {\r\n        this._initTextTracks();\r\n    }\r\n\r\n    var trackId = cueData.track ? cueData.track : 'native' + cueData.type;\r\n    var track = this._tracksById[trackId];\r\n    var label = cueData.type === 'captions' ? 'Unknown CC' : 'ID3 Metadata';\r\n    var vttCue = cueData.cue;\r\n\r\n    if (!track) {\r\n        var itemTrack = {\r\n            kind: cueData.type,\r\n            _id: trackId,\r\n            label: label,\r\n            embedded: true\r\n        };\r\n\r\n        track = _createTrack.call(this, itemTrack);\r\n\r\n        if (this.renderNatively || track.kind === 'metadata') {\r\n            this.setTextTracks(this.video.textTracks);\r\n        } else {\r\n            addTextTracks.call(this, [track]);\r\n        }\r\n    }\r\n    if (_cacheVTTCue.call(this, track, vttCue)) {\r\n        if (this.renderNatively || track.kind === 'metadata') {\r\n            _addCueToTrack(this.renderNatively, track, vttCue);\r\n        } else {\r\n            track.data.push(vttCue);\r\n        }\r\n    }\r\n}\r\n\r\nfunction addCuesToTrack(cueData) {\r\n    // convert cues coming from the flash provider into VTTCues, then append them to track\r\n    var track = this._tracksById[cueData.name];\r\n    if (!track) {\r\n        return;\r\n    }\r\n\r\n    track.source = cueData.source;\r\n    var cues = cueData.captions || [];\r\n    var cuesToConvert = [];\r\n    var sort = false;\r\n\r\n    for (var i = 0; i < cues.length; i++) {\r\n        var cue = cues[i];\r\n        var cueId = cueData.name + '_' + cue.begin + '_' + cue.end;\r\n        if (!this._metaCuesByTextTime[cueId]) {\r\n            this._metaCuesByTextTime[cueId] = cue;\r\n            cuesToConvert.push(cue);\r\n            sort = true;\r\n        }\r\n    }\r\n    if (sort) {\r\n        cuesToConvert.sort(function(a, b) {\r\n            return a.begin - b.begin;\r\n        });\r\n    }\r\n    var vttCues = convertToVTTCues(cuesToConvert);\r\n    Array.prototype.push.apply(track.data, vttCues);\r\n}\r\n\r\nfunction addTracksListener(tracks, eventType, handler) {\r\n    if (!tracks) {\r\n        return;\r\n    }\r\n    // Always remove existing listener\r\n    removeTracksListener(tracks, eventType, handler);\r\n\r\n    if (this.instreamMode) {\r\n        return;\r\n    }\r\n\r\n    if (tracks.addEventListener) {\r\n        tracks.addEventListener(eventType, handler);\r\n    } else {\r\n        tracks['on' + eventType] = handler;\r\n    }\r\n}\r\n\r\nfunction removeTracksListener(tracks, eventType, handler) {\r\n    if (!tracks) {\r\n        return;\r\n    }\r\n    if (tracks.removeEventListener) {\r\n        tracks.removeEventListener(eventType, handler);\r\n    } else {\r\n        tracks['on' + eventType] = null;\r\n    }\r\n}\r\n\r\nfunction clearTracks() {\r\n    cancelXhr(this._itemTracks);\r\n    var metadataTrack = this._tracksById && this._tracksById.nativemetadata;\r\n    if (this.renderNatively || metadataTrack) {\r\n        _removeCues(this.renderNatively, this.video.textTracks);\r\n        if (metadataTrack) {\r\n            metadataTrack.oncuechange = null;\r\n        }\r\n    }\r\n\r\n    this._itemTracks = null;\r\n    this._textTracks = null;\r\n    this._tracksById = null;\r\n    this._cuesByTrackId = null;\r\n    this._metaCuesByTextTime = null;\r\n    this._unknownCount = 0;\r\n    this._activeCuePosition = null;\r\n    if (this.renderNatively) {\r\n        // Removing listener first to ensure that removing cues does not trigger it unnecessarily\r\n        this.removeTracksListener(this.video.textTracks, 'change', this.textTrackChangeHandler);\r\n        _removeCues(this.renderNatively, this.video.textTracks);\r\n    }\r\n}\r\n\r\n// Clear track cues to prevent duplicates\r\nfunction clearCueData(trackId) {\r\n    if (this._cachedVTTCues[trackId]) {\r\n        this._cachedVTTCues[trackId] = {};\r\n        if (this._tracksById) {\r\n            this._tracksById[trackId].data = [];\r\n        }\r\n    }\r\n}\r\n\r\nfunction disableTextTrack() {\r\n    if (this._textTracks) {\r\n        var track = this._textTracks[this._currentTextTrackIndex];\r\n        if (track) {\r\n            // FF does not remove the active cue from the dom when the track is hidden, so we must disable it\r\n            track.mode = 'disabled';\r\n            const trackId = track._id;\r\n            if (trackId && trackId.indexOf('nativecaptions') === 0) {\r\n                track.mode = 'hidden';\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction enableTextTrack() {\r\n    if (this._textTracks) {\r\n        var track = this._textTracks[this._currentTextTrackIndex];\r\n        if (track) {\r\n            track.mode = 'showing';\r\n        }\r\n    }\r\n}\r\n\r\nfunction textTrackChangeHandler() {\r\n    var textTracks = this.video.textTracks;\r\n    var inUseTracks = _.filter(textTracks, function (track) {\r\n        return (track.inuse || !track._id) && _kindSupported(track.kind);\r\n    });\r\n    if (!this._textTracks || _tracksModified.call(this, inUseTracks)) {\r\n        this.setTextTracks(textTracks);\r\n        return;\r\n    }\r\n    // If a caption/subtitle track is showing, find its index\r\n    var selectedTextTrackIndex = -1;\r\n    for (var i = 0; i < this._textTracks.length; i++) {\r\n        if (this._textTracks[i].mode === 'showing') {\r\n            selectedTextTrackIndex = i;\r\n            break;\r\n        }\r\n    }\r\n\r\n    // Notifying the model when the index changes keeps the current index in sync in iOS Fullscreen mode\r\n    if (selectedTextTrackIndex !== this._currentTextTrackIndex) {\r\n        this.setSubtitlesTrack(selectedTextTrackIndex + 1);\r\n    }\r\n}\r\n\r\n// Used in MS Edge to get tracks from the videotag as they're added\r\nfunction addTrackHandler() {\r\n    this.setTextTracks(this.video.textTracks);\r\n}\r\n\r\nfunction addTextTracks(tracksArray) {\r\n    if (!tracksArray) {\r\n        return;\r\n    }\r\n\r\n    if (!this._textTracks) {\r\n        this._initTextTracks();\r\n    }\r\n\r\n    tracksArray.forEach(itemTrack => {\r\n        // only add valid and supported kinds https://developer.mozilla.org/en-US/docs/Web/HTML/Element/track\r\n        if (itemTrack.kind && !_kindSupported(itemTrack.kind)) {\r\n            return;\r\n        }\r\n        var textTrackAny = _createTrack.call(this, itemTrack);\r\n        _addTrackToList.call(this, textTrackAny);\r\n        if (itemTrack.file) {\r\n            itemTrack.data = [];\r\n            loadFile(itemTrack,\r\n                (vttCues) => {\r\n                    this.addVTTCuesToTrack(textTrackAny, vttCues);\r\n                },\r\n                (error) => {\r\n                    this.trigger(ERROR, {\r\n                        message: 'Captions failed to load',\r\n                        reason: error\r\n                    });\r\n                });\r\n        }\r\n    });\r\n\r\n    if (this._textTracks && this._textTracks.length) {\r\n        this.trigger('subtitlesTracks', { tracks: this._textTracks });\r\n    }\r\n}\r\n\r\nfunction addVTTCuesToTrack(track, vttCues) {\r\n    if (!this.renderNatively) {\r\n        return;\r\n    }\r\n\r\n    var textTrack = this._tracksById[track._id];\r\n    // the track may not be on the video tag yet\r\n    if (!textTrack) {\r\n\r\n        if (!this._cuesByTrackId) {\r\n            this._cuesByTrackId = {};\r\n        }\r\n        this._cuesByTrackId[track._id] = { cues: vttCues, loaded: false };\r\n        return;\r\n    }\r\n    // Cues already added\r\n    if (this._cuesByTrackId[track._id] && this._cuesByTrackId[track._id].loaded) {\r\n        return;\r\n    }\r\n\r\n    var cue;\r\n    this._cuesByTrackId[track._id] = { cues: vttCues, loaded: true };\r\n\r\n    while ((cue = vttCues.shift())) {\r\n        _addCueToTrack(this.renderNatively, textTrack, cue);\r\n    }\r\n}\r\n\r\n// ////////////////////\r\n// //// PRIVATE METHODS\r\n// ////////////////////\r\n\r\nfunction _addCueToTrack(renderNatively, track, vttCue) {\r\n    if (!(Browser.ie && renderNatively) || !window.TextTrackCue) {\r\n        track.addCue(vttCue);\r\n        return;\r\n    }\r\n    // There's no support for the VTTCue interface in IE/Edge.\r\n    // We need to convert VTTCue to TextTrackCue before adding them to the TextTrack\r\n    // This unfortunately removes positioning properties from the cues\r\n    var textTrackCue = new window.TextTrackCue(vttCue.startTime, vttCue.endTime, vttCue.text);\r\n    track.addCue(textTrackCue);\r\n}\r\n\r\nfunction _removeCues(renderNatively, tracks) {\r\n    if (tracks && tracks.length) {\r\n        _.each(tracks, function(track) {\r\n            // Let IE & Edge handle cleanup of non-sideloaded text tracks for native rendering\r\n            if (Browser.ie && renderNatively && /^(native|subtitle|cc)/.test(track._id)) {\r\n                return;\r\n            }\r\n\r\n            // Cues are inaccessible if the track is disabled. While hidden,\r\n            // we can remove cues while the track is in a non-visible state\r\n            // Set to disabled before hidden to ensure active cues disappear\r\n            track.mode = 'disabled';\r\n            track.mode = 'hidden';\r\n            for (var i = track.cues.length; i--;) {\r\n                track.removeCue(track.cues[i]);\r\n            }\r\n            if (!track.embedded) {\r\n                track.mode = 'disabled';\r\n            }\r\n            track.inuse = false;\r\n        });\r\n    }\r\n}\r\n\r\nfunction _kindSupported(kind) {\r\n    return kind === 'subtitles' || kind === 'captions';\r\n}\r\n\r\nfunction _initTextTracks() {\r\n    this._textTracks = [];\r\n    this._tracksById = {};\r\n    this._metaCuesByTextTime = {};\r\n    this._cuesByTrackId = {};\r\n    this._cachedVTTCues = {};\r\n    this._unknownCount = 0;\r\n}\r\n\r\nfunction _createTrack(itemTrack) {\r\n    var track;\r\n    var labelInfo = createLabel(itemTrack, this._unknownCount);\r\n    var label = labelInfo.label;\r\n    this._unknownCount = labelInfo.unknownCount;\r\n\r\n    if (this.renderNatively || itemTrack.kind === 'metadata') {\r\n        var tracks = this.video.textTracks;\r\n        // TextTrack label is read only, so we'll need to create a new track if we don't\r\n        // already have one with the same label\r\n        track = _.findWhere(tracks, { label: label });\r\n\r\n        if (!track) {\r\n            track = this.video.addTextTrack(itemTrack.kind, label, itemTrack.language || '');\r\n        }\r\n\r\n        track.default = itemTrack.default;\r\n        track.mode = 'disabled';\r\n        track.inuse = true;\r\n    } else {\r\n        track = itemTrack;\r\n        track.data = track.data || [];\r\n    }\r\n\r\n    if (!track._id) {\r\n        track._id = createId(itemTrack, this._textTracks.length);\r\n    }\r\n\r\n    return track;\r\n}\r\n\r\nfunction _addTrackToList(track) {\r\n    this._textTracks.push(track);\r\n    this._tracksById[track._id] = track;\r\n}\r\n\r\nfunction _clearSideloadedTextTracks() {\r\n    // Clear VTT textTracks\r\n    if (!this._textTracks) {\r\n        return;\r\n    }\r\n    var nonSideloadedTracks = _.filter(this._textTracks, function (track) {\r\n        return track.embedded || track.groupid === 'subs';\r\n    });\r\n    this._initTextTracks();\r\n    _.each(nonSideloadedTracks, function (track) {\r\n        this._tracksById[track._id] = track;\r\n    });\r\n    this._textTracks = nonSideloadedTracks;\r\n}\r\n\r\nfunction _cueChangeHandler(e) {\r\n    var activeCues = e.currentTarget.activeCues;\r\n    if (!activeCues || !activeCues.length) {\r\n        return;\r\n    }\r\n\r\n    // Get the most recent start time. Cues are sorted by start time in ascending order by the browser\r\n    var startTime = activeCues[activeCues.length - 1].startTime;\r\n    // Prevent duplicate meta events for the same list of cues since the cue change handler fires once\r\n    // for each activeCue in Safari\r\n    if (this._activeCuePosition === startTime) {\r\n        return;\r\n    }\r\n    var dataCues = [];\r\n\r\n    _.each(activeCues, function(cue) {\r\n        if (cue.startTime < startTime) {\r\n            return;\r\n        }\r\n        if (cue.data || cue.value) {\r\n            dataCues.push(cue);\r\n        } else if (cue.text) {\r\n            this.trigger('meta', {\r\n                metadataTime: startTime,\r\n                metadata: JSON.parse(cue.text)\r\n            });\r\n        }\r\n    }, this);\r\n\r\n    if (dataCues.length) {\r\n        var id3Data = parseID3(dataCues);\r\n        this.trigger('meta', {\r\n            metadataTime: startTime,\r\n            metadata: id3Data\r\n        });\r\n    }\r\n    this._activeCuePosition = startTime;\r\n}\r\n\r\nfunction _cacheVTTCue(track, vttCue) {\r\n    var trackKind = track.kind;\r\n    if (!this._cachedVTTCues[track._id]) {\r\n        this._cachedVTTCues[track._id] = {};\r\n    }\r\n    var cachedCues = this._cachedVTTCues[track._id];\r\n    var cacheKeyTime;\r\n\r\n    switch (trackKind) {\r\n        case 'captions':\r\n        case 'subtitles':\r\n            // VTTCues should have unique start and end times, even in cases where there are multiple\r\n            // active cues. This is safer than ensuring text is unique, which may be violated on seek.\r\n            // Captions within .05s of each other are treated as unique to account for\r\n            // quality switches where start/end times are slightly different.\r\n            cacheKeyTime = Math.floor(vttCue.startTime * 20);\r\n            var cacheLine = '_' + vttCue.line;\r\n            var cacheValue = Math.floor(vttCue.endTime * 20);\r\n            var cueExists = cachedCues[cacheKeyTime + cacheLine] || cachedCues[(cacheKeyTime + 1) + cacheLine] || cachedCues[(cacheKeyTime - 1) + cacheLine];\r\n\r\n            if (cueExists && Math.abs(cueExists - cacheValue) <= 1) {\r\n                return false;\r\n            }\r\n\r\n            cachedCues[cacheKeyTime + cacheLine] = cacheValue;\r\n            return true;\r\n        case 'metadata':\r\n            var text = vttCue.data ? new Uint8Array(vttCue.data).join('') : vttCue.text;\r\n            cacheKeyTime = vttCue.startTime + text;\r\n            if (cachedCues[cacheKeyTime]) {\r\n                return false;\r\n            }\r\n\r\n            cachedCues[cacheKeyTime] = vttCue.endTime;\r\n            return true;\r\n        default:\r\n            return false;\r\n    }\r\n}\r\n\r\nfunction _tracksModified(inUseTracks) {\r\n    // Need to add new textTracks coming from the video tag\r\n    if (inUseTracks.length > this._textTracks.length) {\r\n        return true;\r\n    }\r\n\r\n    // Tracks may have changed in Safari after an ad\r\n    for (var i = 0; i < inUseTracks.length; i++) {\r\n        var track = inUseTracks[i];\r\n        if (!track._id || !this._tracksById[track._id]) {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nexport default Tracks;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/providers/tracks-mixin.js","\r\nconst friendlyNames = {\r\n    TIT2: 'title',\r\n    TT2: 'title',\r\n    WXXX: 'url',\r\n    TPE1: 'artist',\r\n    TP1: 'artist',\r\n    TALB: 'album',\r\n    TAL: 'album'\r\n};\r\n\r\nexport function utf8ArrayToStr(array, startingIndex) {\r\n    // Based on code by Masanao Izumo <iz@onicos.co.jp>\r\n    // posted at http://www.onicos.com/staff/iz/amuse/javascript/expert/utf.txt\r\n\r\n    const len = array.length;\r\n    let c;\r\n    let char2;\r\n    let char3;\r\n    let out = '';\r\n    let i = startingIndex || 0;\r\n    while (i < len) {\r\n        c = array[i++];\r\n        // If the character is 3 (END_OF_TEXT) or 0 (NULL) then skip it\r\n        if (c === 0x00 || c === 0x03) {\r\n            continue;\r\n        }\r\n        switch (c >> 4) {\r\n            case 0: case 1: case 2: case 3: case 4: case 5: case 6: case 7:\r\n            // 0xxxxxxx\r\n                out += String.fromCharCode(c);\r\n                break;\r\n            case 12: case 13:\r\n            // 110x xxxx   10xx xxxx\r\n                char2 = array[i++];\r\n                out += String.fromCharCode(((c & 0x1F) << 6) | (char2 & 0x3F));\r\n                break;\r\n            case 14:\r\n                // 1110 xxxx  10xx xxxx  10xx xxxx\r\n                char2 = array[i++];\r\n                char3 = array[i++];\r\n                out += String.fromCharCode(((c & 0x0F) << 12) |\r\n                    ((char2 & 0x3F) << 6) |\r\n                    ((char3 & 0x3F) << 0));\r\n                break;\r\n            default:\r\n        }\r\n    }\r\n    return out;\r\n}\r\n\r\nfunction utf16BigEndianArrayToStr(array, startingIndex) {\r\n    const lastDoubleByte = array.length - 1;\r\n    let out = '';\r\n    let i = startingIndex || 0;\r\n    while (i < lastDoubleByte) {\r\n        if (array[i] === 254 && array[i + 1] === 255) {\r\n            // Byte order mark\r\n        } else {\r\n            out += String.fromCharCode((array[i] << 8) + array[i + 1]);\r\n        }\r\n        i += 2;\r\n    }\r\n    return out;\r\n}\r\n    \r\nexport function syncSafeInt(sizeArray) {\r\n    const size = arrayToInt(sizeArray);\r\n    return (size & 0x0000007F) |\r\n        ((size & 0x00007F00) >> 1) |\r\n        ((size & 0x007F0000) >> 2) |\r\n        ((size & 0x7F000000) >> 3);\r\n}\r\n\r\nfunction arrayToInt(array) {\r\n    let sizeString = '0x';\r\n    for (let i = 0; i < array.length; i++) {\r\n        if (array[i] < 16) {\r\n            sizeString += '0';\r\n        }\r\n        sizeString += array[i].toString(16);\r\n    }\r\n    return parseInt(sizeString);\r\n}\r\n    \r\nexport function parseID3(activeCues = []) {\r\n    return activeCues.reduce(function(data, cue) {\r\n        if (!('value' in cue)) {\r\n            // Cue is not in Safari's key/data format\r\n            if ('data' in cue && cue.data instanceof ArrayBuffer) {\r\n                // EdgeHTML 13.10586 cue point format - contains raw data in an ArrayBuffer.\r\n\r\n                const oldCue = cue;\r\n                const array = new Uint8Array(oldCue.data);\r\n                let arrayLength = array.length;\r\n\r\n                cue = { value: { key: '', data: '' } };\r\n\r\n                let i = 10;\r\n                while (i < 14 && i < array.length) {\r\n                    if (array[i] === 0) {\r\n                        break;\r\n                    }\r\n                    cue.value.key += String.fromCharCode(array[i]);\r\n                    i++;\r\n                }\r\n\r\n                // If the first byte is 3 (END_OF_TEXT) or 0 (NULL) then skip it\r\n                let startPos = 19;\r\n                let firstByte = array[startPos];\r\n                if (firstByte === 0x03 || firstByte === 0x00) {\r\n                    firstByte = array[++startPos];\r\n                    arrayLength--;\r\n                }\r\n\r\n                let infoDelimiterPosition = 0;\r\n                // Find info/value pair delimiter if present.\r\n                // If first byte shows theres utf 16 encoding, there is no info since info cannot be utf 16 encoded\r\n                if (firstByte !== 0x01 && firstByte !== 0x02) {\r\n                    for (let j = startPos + 1; j < arrayLength; j++) {\r\n                        if (array[j] === 0x00) {\r\n                            infoDelimiterPosition = j - startPos;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (infoDelimiterPosition > 0) {\r\n                    const info = utf8ArrayToStr(array.subarray(startPos, startPos += infoDelimiterPosition), 0);\r\n                    if (cue.value.key === 'PRIV') {\r\n                        if (info === 'com.apple.streaming.transportStreamTimestamp') {\r\n                            const ptsIs33Bit = syncSafeInt(array.subarray(startPos, startPos += 4)) & 0x00000001;\r\n                            const transportStreamTimestamp = syncSafeInt(array.subarray(startPos, startPos += 4)) +\r\n                                (ptsIs33Bit ? 0x100000000 : 0);\r\n                            cue.value.data = transportStreamTimestamp;\r\n                        } else {\r\n                            cue.value.data = utf8ArrayToStr(array, startPos + 1);\r\n                        }\r\n                        cue.value.info = info;\r\n                    } else {\r\n                        cue.value.info = info;\r\n                        cue.value.data = utf8ArrayToStr(array, startPos + 1);\r\n                    }\r\n                } else {\r\n                    const encoding = array[startPos];\r\n                    if (encoding === 1 || encoding === 2) {\r\n                        cue.value.data = utf16BigEndianArrayToStr(array, startPos + 1);\r\n                    } else {\r\n                        cue.value.data = utf8ArrayToStr(array, startPos + 1);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // These friendly names mapping provides compatibility with our implementation prior to 7.3\r\n        if (friendlyNames.hasOwnProperty(cue.value.key)) {\r\n            data[friendlyNames[cue.value.key]] = cue.value.data;\r\n        }\r\n        /* The meta event includes a metadata object with flattened cue key/data pairs\r\n         * If a cue also includes an info field, then create a collection of info/data pairs for the cue key\r\n         *   TLEN: 03:50                                        // key: \"TLEN\", data: \"03:50\"\r\n         *   WXXX: {\"artworkURL\":\"http://domain.com/cover.jpg\"} // key: \"WXXX\", info: \"artworkURL\" ...\r\n         */\r\n        if (cue.value.info) {\r\n            let collection = data[cue.value.key];\r\n            if (collection !== Object(collection)) {\r\n                collection = {};\r\n                data[cue.value.key] = collection;\r\n            }\r\n            collection[cue.value.info] = cue.value.data;\r\n        } else {\r\n            data[cue.value.key] = cue.value.data;\r\n        }\r\n        return data;\r\n    }, {});\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/providers/utils/id3Parser.js","import Promise from 'polyfills/promise';\r\n\r\nexport default function createPlayPromise(video) {\r\n    return new Promise(function(resolve, reject) {\r\n        if (video.paused) {\r\n            return reject(new Error('Play refused.'));\r\n        }\r\n        const removeEventListeners = function() {\r\n            video.removeEventListener('playing', listener);\r\n            video.removeEventListener('pause', listener);\r\n            video.removeEventListener('abort', listener);\r\n            video.removeEventListener('error', listener);\r\n        };\r\n        const listener = function(e) {\r\n            removeEventListeners();\r\n            if (e.type === 'playing') {\r\n                resolve();\r\n            } else {\r\n                reject(new Error('The play() request was interrupted by a \"' + e.type + '\" event.'));\r\n            }\r\n        };\r\n\r\n        video.addEventListener('playing', listener);\r\n        video.addEventListener('abort', listener);\r\n        video.addEventListener('error', listener);\r\n        video.addEventListener('pause', listener);\r\n    });\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/providers/utils/play-promise.js","import { seconds, trim } from 'utils/strings';\r\n\r\n// Component that loads and parses an SRT file\r\n\r\nexport default function Srt(data) {\r\n    // Trim whitespace and split the list by returns.\r\n    var _captions = [];\r\n    data = trim(data);\r\n    var list = data.split('\\r\\n\\r\\n');\r\n    if (list.length === 1) {\r\n        list = data.split('\\n\\n');\r\n    }\r\n\r\n    for (var i = 0; i < list.length; i++) {\r\n        if (list[i] === 'WEBVTT') {\r\n            continue;\r\n        }\r\n        // Parse each entry\r\n        var entry = _entry(list[i]);\r\n        if (entry.text) {\r\n            _captions.push(entry);\r\n        }\r\n    }\r\n\r\n    return _captions;\r\n}\r\n\r\n\r\n/** Parse a single captions entry. **/\r\nfunction _entry(data) {\r\n    var entry = {};\r\n    var array = data.split('\\r\\n');\r\n    if (array.length === 1) {\r\n        array = data.split('\\n');\r\n    }\r\n    var idx = 1;\r\n    if (array[0].indexOf(' --> ') > 0) {\r\n        idx = 0;\r\n    }\r\n    if (array.length > idx + 1 && array[idx + 1]) {\r\n        // This line contains the start and end.\r\n        var line = array[idx];\r\n        var index = line.indexOf(' --> ');\r\n        if (index > 0) {\r\n            entry.begin = seconds(line.substr(0, index));\r\n            entry.end = seconds(line.substr(index + 5));\r\n            // Remaining lines contain the text\r\n            entry.text = array.slice(idx + 1).join('\\r\\n');\r\n        }\r\n    }\r\n    return entry;\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/parsers/captions/srt.js","import VTTCue from 'parsers/captions/vttcue';\r\nimport { chunkLoadErrorHandler } from '../api/core-loader';\r\nimport utils from 'utils/helpers';\r\nimport { localName } from 'parsers/parsers';\r\nimport srt from 'parsers/captions/srt';\r\nimport dfxp from 'parsers/captions/dfxp';\r\n\r\nexport function loadFile(track, successHandler, errorHandler) {\r\n    track.xhr = utils.ajax(track.file, function(xhr) {\r\n        xhrSuccess(xhr, track, successHandler, errorHandler);\r\n    }, errorHandler);\r\n}\r\n\r\nexport function cancelXhr(tracks) {\r\n    if (tracks) {\r\n        tracks.forEach(track => {\r\n            var xhr = track.xhr;\r\n            if (xhr) {\r\n                xhr.onload = null;\r\n                xhr.onreadystatechange = null;\r\n                xhr.onerror = null;\r\n                if ('abort' in xhr) {\r\n                    xhr.abort();\r\n                }\r\n            }\r\n            delete track.xhr;\r\n        });\r\n    }\r\n}\r\n\r\nexport function convertToVTTCues(cues) {\r\n    // VTTCue is available natively or polyfilled where necessary\r\n    return cues.map(cue => new VTTCue(cue.begin, cue.end, cue.text));\r\n}\r\n\r\nfunction xhrSuccess(xhr, track, successHandler, errorHandler) {\r\n    var xmlRoot = xhr.responseXML ? xhr.responseXML.firstChild : null;\r\n    var cues;\r\n    var vttCues;\r\n\r\n    // IE9 sets the firstChild element to the root <xml> tag\r\n    if (xmlRoot) {\r\n        if (localName(xmlRoot) === 'xml') {\r\n            xmlRoot = xmlRoot.nextSibling;\r\n        }\r\n        // Ignore all comments\r\n        while (xmlRoot.nodeType === xmlRoot.COMMENT_NODE) {\r\n            xmlRoot = xmlRoot.nextSibling;\r\n        }\r\n    }\r\n\r\n    try {\r\n        if (xmlRoot && localName(xmlRoot) === 'tt') {\r\n            // parse dfxp track\r\n            cues = dfxp(xhr.responseXML);\r\n            vttCues = convertToVTTCues(cues);\r\n            delete track.xhr;\r\n            successHandler(vttCues);\r\n        } else {\r\n            // parse VTT/SRT track\r\n            var responseText = xhr.responseText;\r\n            if (responseText.indexOf('WEBVTT') >= 0) {\r\n                // make VTTCues from VTT track\r\n                loadVttParser().then(VTTParser => {\r\n                    var parser = new VTTParser(window);\r\n                    vttCues = [];\r\n                    parser.oncue = function(cue) {\r\n                        vttCues.push(cue);\r\n                    };\r\n\r\n                    parser.onflush = function() {\r\n                        delete track.xhr;\r\n                        successHandler(vttCues);\r\n                    };\r\n\r\n                    // Parse calls onflush internally\r\n                    parser.parse(responseText);\r\n                }).catch(error => {\r\n                    delete track.xhr;\r\n                    errorHandler(error);\r\n                });\r\n            } else {\r\n                // make VTTCues from SRT track\r\n                cues = srt(responseText);\r\n                vttCues = convertToVTTCues(cues);\r\n                delete track.xhr;\r\n                successHandler(vttCues);\r\n            }\r\n        }\r\n    } catch (error) {\r\n        delete track.xhr;\r\n        errorHandler(error);\r\n    }\r\n}\r\n\r\nfunction loadVttParser() {\r\n    return require.ensure(['parsers/captions/vttparser'], function (require) {\r\n        return require('parsers/captions/vttparser').default;\r\n    }, chunkLoadErrorHandler, 'vttparser');\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/controller/tracks-loader.js","export function createId(track, tracksCount) {\r\n    var trackId;\r\n    var prefix = track.kind || 'cc';\r\n    if (track.default || track.defaulttrack) {\r\n        trackId = 'default';\r\n    } else {\r\n        trackId = track._id || track.file || (prefix + tracksCount);\r\n    }\r\n    return trackId;\r\n}\r\n\r\nexport function createLabel(track, unknownCount) {\r\n    var label = track.label || track.name || track.language;\r\n    if (!label) {\r\n        label = 'Unknown CC';\r\n        unknownCount += 1;\r\n        if (unknownCount > 1) {\r\n            label += ' [' + unknownCount + ']';\r\n        }\r\n    }\r\n    return { label: label, unknownCount: unknownCount };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/controller/tracks-helper.js","/**\r\n * Copyright 2013 vtt.js Contributors\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n*/\r\n\r\nlet VTTCue = window.VTTCue;\r\n\r\nfunction findDirectionSetting(value) {\r\n    if (typeof value !== 'string') {\r\n        return false;\r\n    }\r\n    const directionSetting = {\r\n        '': true,\r\n        lr: true,\r\n        rl: true\r\n    };\r\n    const dir = directionSetting[value.toLowerCase()];\r\n    return dir ? value.toLowerCase() : false;\r\n}\r\n\r\nfunction findAlignSetting(value) {\r\n    if (typeof value !== 'string') {\r\n        return false;\r\n    }\r\n    const alignSetting = {\r\n        start: true,\r\n        middle: true,\r\n        end: true,\r\n        left: true,\r\n        right: true\r\n    };\r\n    const align = alignSetting[value.toLowerCase()];\r\n    return align ? value.toLowerCase() : false;\r\n}\r\n\r\nif (!VTTCue) {\r\n    const autoKeyword = 'auto';\r\n\r\n    VTTCue = function(startTime, endTime, text) {\r\n        const cue = this;\r\n\r\n        /**\r\n         * Shim implementation specific properties. These properties are not in\r\n         * the spec.\r\n         */\r\n\r\n        // Lets us know when the VTTCue's data has changed in such a way that we need\r\n        // to recompute its display state. This lets us compute its display state\r\n        // lazily.\r\n        cue.hasBeenReset = false;\r\n\r\n        /**\r\n         * VTTCue and TextTrackCue properties\r\n         * http://dev.w3.org/html5/webvtt/#vttcue-interface\r\n         */\r\n\r\n        let _id = '';\r\n        let _pauseOnExit = false;\r\n        let _startTime = startTime;\r\n        let _endTime = endTime;\r\n        let _text = text;\r\n        let _region = null;\r\n        let _vertical = '';\r\n        let _snapToLines = true;\r\n        let _line = autoKeyword;\r\n        let _lineAlign = 'start';\r\n        let _position = autoKeyword;\r\n        let _size = 100;\r\n        let _align = 'middle';\r\n\r\n        Object.defineProperty(cue, 'id', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _id;\r\n            },\r\n            set: function (value) {\r\n                _id = '' + value;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'pauseOnExit', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _pauseOnExit;\r\n            },\r\n            set: function (value) {\r\n                _pauseOnExit = !!value;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'startTime', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _startTime;\r\n            },\r\n            set: function (value) {\r\n                if (typeof value !== 'number') {\r\n                    throw new TypeError('Start time must be set to a number.');\r\n                }\r\n                _startTime = value;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'endTime', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _endTime;\r\n            },\r\n            set: function (value) {\r\n                if (typeof value !== 'number') {\r\n                    throw new TypeError('End time must be set to a number.');\r\n                }\r\n                _endTime = value;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'text', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _text;\r\n            },\r\n            set: function (value) {\r\n                _text = '' + value;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'region', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _region;\r\n            },\r\n            set: function (value) {\r\n                _region = value;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'vertical', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _vertical;\r\n            },\r\n            set: function (value) {\r\n                const setting = findDirectionSetting(value);\r\n                // Have to check for false because the setting an be an empty string.\r\n                if (setting === false) {\r\n                    throw new SyntaxError('An invalid or illegal string was specified.');\r\n                }\r\n                _vertical = setting;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'snapToLines', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _snapToLines;\r\n            },\r\n            set: function (value) {\r\n                _snapToLines = !!value;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'line', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _line;\r\n            },\r\n            set: function (value) {\r\n                if (typeof value !== 'number' && value !== autoKeyword) {\r\n                    throw new SyntaxError('An invalid number or illegal string was specified.');\r\n                }\r\n                _line = value;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'lineAlign', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _lineAlign;\r\n            },\r\n            set: function (value) {\r\n                const setting = findAlignSetting(value);\r\n                if (!setting) {\r\n                    throw new SyntaxError('An invalid or illegal string was specified.');\r\n                }\r\n                _lineAlign = setting;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'position', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _position;\r\n            },\r\n            set: function (value) {\r\n                if (value < 0 || value > 100) {\r\n                    throw new Error('Position must be between 0 and 100.');\r\n                }\r\n                _position = value;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'size', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _size;\r\n            },\r\n            set: function (value) {\r\n                if (value < 0 || value > 100) {\r\n                    throw new Error('Size must be between 0 and 100.');\r\n                }\r\n                _size = value;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        Object.defineProperty(cue, 'align', {\r\n            enumerable: true,\r\n            get: function () {\r\n                return _align;\r\n            },\r\n            set: function (value) {\r\n                const setting = findAlignSetting(value);\r\n                if (!setting) {\r\n                    throw new SyntaxError('An invalid or illegal string was specified.');\r\n                }\r\n                _align = setting;\r\n                this.hasBeenReset = true;\r\n            }\r\n        });\r\n\r\n        /**\r\n         * Other <track> spec defined properties\r\n         */\r\n\r\n        // http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#text-track-cue-display-state\r\n        cue.displayState = undefined;\r\n    };\r\n\r\n    /**\r\n     * VTTCue methods\r\n     */\r\n\r\n    VTTCue.prototype.getCueAsHTML = function () {\r\n        // Assume WebVTT.convertCueToDOMTree is on the global.\r\n        const WebVTT = window.WebVTT;\r\n        return WebVTT.convertCueToDOMTree(window, this.text);\r\n    };\r\n}\r\n\r\nexport default VTTCue;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/parsers/captions/vttcue.js","import { seconds, trim } from 'utils/strings';\r\n\r\n// Component that loads and parses an DFXP file\r\n\r\nexport default function Dfxp(xmlDoc) {\r\n    validate(xmlDoc);\r\n    var _captions = [];\r\n    var paragraphs = xmlDoc.getElementsByTagName('p');\r\n    // Default frameRate is 30\r\n    var frameRate = 30;\r\n    var tt = xmlDoc.getElementsByTagName('tt');\r\n    if (tt && tt[0]) {\r\n        var parsedFrameRate = parseFloat(tt[0].getAttribute('ttp:frameRate'));\r\n        if (!isNaN(parsedFrameRate)) {\r\n            frameRate = parsedFrameRate;\r\n        }\r\n    }\r\n    validate(paragraphs);\r\n    if (!paragraphs.length) {\r\n        paragraphs = xmlDoc.getElementsByTagName('tt:p');\r\n        if (!paragraphs.length) {\r\n            paragraphs = xmlDoc.getElementsByTagName('tts:p');\r\n        }\r\n    }\r\n\r\n    for (var i = 0; i < paragraphs.length; i++) {\r\n        var p = paragraphs[i];\r\n\r\n        var breaks = p.getElementsByTagName('br');\r\n        for (var j = 0; j < breaks.length; j++) {\r\n            var b = breaks[j];\r\n            b.parentNode.replaceChild(xmlDoc.createTextNode('\\r\\n'), b);\r\n        }\r\n\r\n        var rawText = (p.innerHTML || p.textContent || p.text || '');\r\n        var text = trim(rawText).replace(/>\\s+</g, '><').replace(/(<\\/?)tts?:/g, '$1').replace(/<br.*?\\/>/g, '\\r\\n');\r\n        if (text) {\r\n            var begin = p.getAttribute('begin');\r\n            var dur = p.getAttribute('dur');\r\n            var end = p.getAttribute('end');\r\n\r\n            var entry = {\r\n                begin: seconds(begin, frameRate),\r\n                text: text\r\n            };\r\n            if (end) {\r\n                entry.end = seconds(end, frameRate);\r\n            } else if (dur) {\r\n                entry.end = entry.begin + seconds(dur, frameRate);\r\n            }\r\n            _captions.push(entry);\r\n        }\r\n    }\r\n    if (!_captions.length) {\r\n        parseError();\r\n    }\r\n    return _captions;\r\n}\r\n\r\nfunction validate(object) {\r\n    if (!object) {\r\n        parseError();\r\n    }\r\n}\r\n\r\nfunction parseError() {\r\n    throw new Error('Invalid DFXP file');\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/parsers/captions/dfxp.js","import { qualityLevel } from 'providers/data-normalizer';\r\nimport { Browser, OS } from 'environment/environment';\r\nimport { isAndroidHls } from 'providers/html5-android-hls';\r\nimport { STATE_IDLE, STATE_PLAYING, MEDIA_META, MEDIA_ERROR,\r\n    MEDIA_LEVELS, MEDIA_LEVEL_CHANGED, MEDIA_SEEK, STATE_LOADING } from 'events/events';\r\nimport VideoEvents from 'providers/video-listener-mixin';\r\nimport VideoAction from 'providers/video-actions-mixin';\r\nimport VideoAttached from 'providers/video-attached-mixin';\r\nimport { style, transform } from 'utils/css';\r\nimport utils from 'utils/helpers';\r\nimport { emptyElement } from 'utils/dom';\r\nimport _ from 'utils/underscore';\r\nimport DefaultProvider from 'providers/default';\r\nimport Events from 'utils/backbone.events';\r\nimport Tracks from 'providers/tracks-mixin';\r\nimport endOfRange from 'utils/time-ranges';\r\nimport createPlayPromise from 'providers/utils/play-promise';\r\n\r\nconst clearTimeout = window.clearTimeout;\r\nconst MIN_DVR_DURATION = 120;\r\nconst _name = 'html5';\r\n\r\nfunction _setupListeners(eventsHash, videoTag) {\r\n    Object.keys(eventsHash).forEach(eventName => {\r\n        videoTag.removeEventListener(eventName, eventsHash[eventName]);\r\n        videoTag.addEventListener(eventName, eventsHash[eventName]);\r\n    });\r\n}\r\n\r\nfunction _removeListeners(eventsHash, videoTag) {\r\n    Object.keys(eventsHash).forEach(eventName => {\r\n        videoTag.removeEventListener(eventName, eventsHash[eventName]);\r\n    });\r\n}\r\n\r\nfunction VideoProvider(_playerId, _playerConfig) {\r\n    // Current media state\r\n    this.state = STATE_IDLE;\r\n\r\n    // Are we buffering due to seek, or due to playback?\r\n    this.seeking = false;\r\n\r\n    // Always render natively in iOS and Safari, where HLS is supported.\r\n    // Otherwise, use native rendering when set in the config for browsers that have adequate support.\r\n    // FF, IE & Edge are excluded due to styling/positioning drawbacks.\r\n    // The following issues need to be addressed before we enable native rendering in Edge:\r\n    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8120475/\r\n    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/12079271/\r\n    function renderNatively (configRenderNatively) {\r\n        if (OS.iOS || Browser.safari) {\r\n            return true;\r\n        }\r\n        return configRenderNatively && Browser.chrome;\r\n    }\r\n\r\n    const _this = this;\r\n\r\n    const MediaEvents = {\r\n        progress() {\r\n            VideoEvents.progress.call(_this);\r\n            checkStaleStream();\r\n        },\r\n        \r\n        timeupdate() {\r\n            if (_positionBeforeSeek !== _videotag.currentTime) {\r\n                _setPositionBeforeSeek(_videotag.currentTime);\r\n                VideoEvents.timeupdate.call(_this);\r\n            }\r\n            checkStaleStream();\r\n            if (_this.state === STATE_PLAYING) {\r\n                checkVisualQuality();\r\n            }\r\n        },\r\n\r\n        ended() {\r\n            _currentQuality = -1;\r\n            clearTimeouts();\r\n            VideoEvents.ended.call(_this);\r\n        },\r\n\r\n        loadedmetadata() {\r\n            let duration = _this.getDuration();\r\n            if (_androidHls && duration === Infinity) {\r\n                duration = 0;\r\n            }\r\n            var metadata = {\r\n                duration: duration,\r\n                height: _videotag.videoHeight,\r\n                width: _videotag.videoWidth\r\n            };\r\n            _this.trigger(MEDIA_META, metadata);\r\n        },\r\n\r\n        durationchange() {\r\n            if (_androidHls) {\r\n                return;\r\n            }\r\n            VideoEvents.progress.call(_this);\r\n        },\r\n\r\n        loadeddata() {\r\n            VideoEvents.loadeddata.call(_this);\r\n            _setAudioTracks(_videotag.audioTracks);\r\n            _checkDelayedSeek(_this.getDuration());\r\n        },\r\n\r\n        canplay() {\r\n            _canSeek = true;\r\n            if (!_androidHls) {\r\n                _setMediaType();\r\n            }\r\n            if (Browser.ie && Browser.version.major === 9) {\r\n                // In IE9, set tracks here since they are not ready\r\n                // on load\r\n                _this.setTextTracks(_this._textTracks);\r\n            }\r\n            VideoEvents.canplay.call(_this);\r\n        },\r\n\r\n        seeking() {\r\n            var offset = _seekOffset !== null ? _seekOffset : _this.getCurrentTime();\r\n            _seekOffset = null;\r\n            _delayedSeek = 0;\r\n            _this.seeking = true;\r\n            _this.trigger(MEDIA_SEEK, {\r\n                position: _positionBeforeSeek,\r\n                offset: offset\r\n            });\r\n            _setPositionBeforeSeek(offset);\r\n            _videotag.removeEventListener('waiting', setLoadingState);\r\n            _videotag.addEventListener('waiting', setLoadingState);\r\n        },\r\n\r\n        seeked() {\r\n            _videotag.removeEventListener('waiting', setLoadingState);\r\n            VideoEvents.seeked.call(_this);\r\n        },\r\n\r\n        webkitbeginfullscreen(e) {\r\n            _fullscreenState = true;\r\n            _sendFullscreen(e);\r\n        },\r\n\r\n        webkitendfullscreen(e) {\r\n            _fullscreenState = false;\r\n            _sendFullscreen(e);\r\n        }\r\n    };\r\n    Object.keys(VideoEvents).forEach(eventName => {\r\n        if (!MediaEvents[eventName]) {\r\n            const mixinEventHandler = VideoEvents[eventName];\r\n            MediaEvents[eventName] = (e) => {\r\n                mixinEventHandler.call(_this, e);\r\n            };\r\n        }\r\n    });\r\n\r\n    Object.assign(this, Events, VideoAction, VideoAttached, Tracks, {\r\n        renderNatively: renderNatively(_playerConfig.renderCaptionsNatively),\r\n        eventsOn_() {\r\n            _setupListeners(MediaEvents, _videotag);\r\n        },\r\n        eventsOff_() {\r\n            _removeListeners(MediaEvents, _videotag);\r\n        },\r\n        detachMedia() {\r\n            VideoAttached.detachMedia.call(_this);\r\n            clearTimeouts();\r\n            // Stop listening to track changes so disabling the current track doesn't update the model\r\n            this.removeTracksListener(_videotag.textTracks, 'change', this.textTrackChangeHandler);\r\n            // Prevent tracks from showing during ad playback\r\n            this.disableTextTrack();\r\n            return _videotag;\r\n        },\r\n        attachMedia() {\r\n            VideoAttached.attachMedia.call(_this);\r\n            _canSeek = false;\r\n            // If we were mid-seek when detached, we want to allow it to resume\r\n            this.seeking = false;\r\n            // In case the video tag was modified while we shared it\r\n            _videotag.loop = false;\r\n            // If there was a showing track, re-enable it\r\n            this.enableTextTrack();\r\n            if (this.renderNatively) {\r\n                this.setTextTracks(this.video.textTracks);\r\n            }\r\n            this.addTracksListener(_videotag.textTracks, 'change', this.textTrackChangeHandler);\r\n        },\r\n        stalledHandler(checkStartTime) {\r\n            // Android HLS doesnt update its times correctly so it always falls in here.  Do not allow it to stall.\r\n            if (_androidHls) {\r\n                return;\r\n            }\r\n            VideoAttached.stalledHandler.call(_this, checkStartTime);\r\n        },\r\n        isLive() {\r\n            return _videotag.duration === Infinity;\r\n        }\r\n    });\r\n\r\n    const _videotag = _this.video = _playerConfig.mediaElement;\r\n    const visualQuality = { level: {} };\r\n    const _staleStreamDuration = 3 * 10 * 1000;\r\n\r\n    let _canSeek = false; // true on valid time event\r\n    let _delayedSeek = 0;\r\n    let _seekOffset = null;\r\n    let _positionBeforeSeek = null;\r\n    let _levels;\r\n    let _currentQuality = -1;\r\n    let _fullscreenState = false;\r\n    let _beforeResumeHandler = utils.noop;\r\n    let _audioTracks = null;\r\n    let _currentAudioTrackIndex = -1;\r\n    let _staleStreamTimeout = -1;\r\n    let _stale = false;\r\n    let _lastEndOfBuffer = null;\r\n    let _androidHls = false;\r\n\r\n    function _setAttribute(name, value) {\r\n        _videotag.setAttribute(name, value || '');\r\n    }\r\n\r\n    _videotag.className = 'jw-video jw-reset';\r\n\r\n    this.isSDK = !!_playerConfig.sdkplatform;\r\n    this.video = _videotag;\r\n    this.supportsPlaybackRate = true;\r\n\r\n    _setupListeners(MediaEvents, _videotag);\r\n\r\n    _setAttribute('disableRemotePlayback', '');\r\n    _setAttribute('webkit-playsinline');\r\n    _setAttribute('playsinline');\r\n\r\n    function checkVisualQuality() {\r\n        const level = visualQuality.level;\r\n        if (level.width !== _videotag.videoWidth ||\r\n            level.height !== _videotag.videoHeight) {\r\n            level.width = _videotag.videoWidth;\r\n            level.height = _videotag.videoHeight;\r\n            _setMediaType();\r\n            if (!level.width || !level.height || _currentQuality === -1) {\r\n                return;\r\n            }\r\n            visualQuality.reason = visualQuality.reason || 'auto';\r\n            visualQuality.mode = _levels[_currentQuality].type === 'hls' ? 'auto' : 'manual';\r\n            visualQuality.bitrate = 0;\r\n            level.index = _currentQuality;\r\n            level.label = _levels[_currentQuality].label;\r\n            _this.trigger('visualQuality', visualQuality);\r\n            visualQuality.reason = '';\r\n        }\r\n    }\r\n\r\n    function setLoadingState() {\r\n        _this.setState(STATE_LOADING);\r\n    }\r\n\r\n    function _setPositionBeforeSeek(position) {\r\n        _positionBeforeSeek = _convertTime(position);\r\n    }\r\n\r\n    _this.getCurrentTime = function() {\r\n        return _convertTime(_videotag.currentTime);\r\n    };\r\n\r\n    function _convertTime(position) {\r\n        if (_this.getDuration() < 0) {\r\n            position -= _getSeekableEnd();\r\n        }\r\n        return position;\r\n    }\r\n\r\n    _this.getDuration = function() {\r\n        var duration = _videotag.duration;\r\n        // Don't sent time event on Android before real duration is known\r\n        if (_androidHls && (duration === Infinity && _videotag.currentTime === 0) || isNaN(duration)) {\r\n            return 0;\r\n        }\r\n        var end = _getSeekableEnd();\r\n        if (_this.isLive() && end) {\r\n            var seekableDuration = end - _getSeekableStart();\r\n            if (seekableDuration !== Infinity && seekableDuration > MIN_DVR_DURATION) {\r\n                // Player interprets negative duration as DVR\r\n                duration = -seekableDuration;\r\n            }\r\n        }\r\n        return duration;\r\n    };\r\n\r\n    function _checkDelayedSeek(duration) {\r\n        // Don't seek when _delayedSeek is set to -1 in _completeLoad\r\n        if (_delayedSeek && _delayedSeek !== -1 && duration && duration !== Infinity) {\r\n            _this.seek(_delayedSeek);\r\n        }\r\n    }\r\n\r\n    function _getPublicLevels(levels) {\r\n        var publicLevels;\r\n        if (utils.typeOf(levels) === 'array' && levels.length > 0) {\r\n            publicLevels = _.map(levels, function(level, i) {\r\n                return {\r\n                    label: level.label || i\r\n                };\r\n            });\r\n        }\r\n        return publicLevels;\r\n    }\r\n\r\n    function _setLevels(levels) {\r\n        _levels = levels;\r\n        _currentQuality = _pickInitialQuality(levels);\r\n    }\r\n\r\n    function _pickInitialQuality(levels) {\r\n        var currentQuality = Math.max(0, _currentQuality);\r\n        var label = _playerConfig.qualityLabel;\r\n        if (levels) {\r\n            for (var i = 0; i < levels.length; i++) {\r\n                if (levels[i].default) {\r\n                    currentQuality = i;\r\n                }\r\n                if (label && levels[i].label === label) {\r\n                    return i;\r\n                }\r\n            }\r\n        }\r\n        visualQuality.reason = 'initial choice';\r\n        visualQuality.level = {};\r\n        return currentQuality;\r\n    }\r\n\r\n    function _play() {\r\n        return _videotag.play() || createPlayPromise(_videotag);\r\n    }\r\n\r\n    function _completeLoad(startTime) {\r\n        _delayedSeek = 0;\r\n        clearTimeouts();\r\n\r\n        const previousSource = _videotag.src;\r\n        const sourceElement = document.createElement('source');\r\n        sourceElement.src = _levels[_currentQuality].file;\r\n        const sourceChanged = (sourceElement.src !== previousSource);\r\n\r\n        if (sourceChanged) {\r\n            _setVideotagSource(_levels[_currentQuality]);\r\n            // Do not call load if src was not set. load() will cancel any active play promise.\r\n            if (previousSource) {\r\n                _videotag.load();\r\n            }\r\n\r\n        } else if (startTime === 0 && _videotag.currentTime > 0) {\r\n            // Load event is from the same video as before\r\n            // restart video without dispatching seek event\r\n            _delayedSeek = -1;\r\n            _this.seek(startTime);\r\n        }\r\n\r\n        if (startTime > 0) {\r\n            _this.seek(startTime);\r\n        }\r\n\r\n        var publicLevels = _getPublicLevels(_levels);\r\n        if (publicLevels) {\r\n            _this.trigger(MEDIA_LEVELS, {\r\n                levels: publicLevels,\r\n                currentQuality: _currentQuality\r\n            });\r\n        }\r\n        if (_levels.length && _levels[0].type !== 'hls') {\r\n            _this.sendMediaType(_levels);\r\n        }\r\n    }\r\n\r\n    function _setVideotagSource(source) {\r\n        _audioTracks = null;\r\n        _currentAudioTrackIndex = -1;\r\n        if (!visualQuality.reason) {\r\n            visualQuality.reason = 'initial choice';\r\n            visualQuality.level = {};\r\n        }\r\n        _canSeek = false;\r\n\r\n        var sourceElement = document.createElement('source');\r\n        sourceElement.src = source.file;\r\n        var sourceChanged = (_videotag.src !== sourceElement.src);\r\n        if (sourceChanged) {\r\n            _videotag.src = source.file;\r\n        }\r\n    }\r\n\r\n    function _clearVideotagSource() {\r\n        if (_videotag) {\r\n            _this.disableTextTrack();\r\n            _videotag.removeAttribute('preload');\r\n            _videotag.removeAttribute('src');\r\n            emptyElement(_videotag);\r\n            style(_videotag, {\r\n                objectFit: ''\r\n            });\r\n            _currentQuality = -1;\r\n            // Don't call load in iE9/10 and check for load in PhantomJS\r\n            if (!Browser.msie && 'load' in _videotag) {\r\n                _videotag.load();\r\n            }\r\n        }\r\n    }\r\n\r\n    function _getSeekableStart() {\r\n        var index = _videotag.seekable ? _videotag.seekable.length : 0;\r\n        var start = Infinity;\r\n\r\n        while (index--) {\r\n            start = Math.min(start, _videotag.seekable.start(index));\r\n        }\r\n        return start;\r\n    }\r\n\r\n    function _getSeekableEnd() {\r\n        var index = _videotag.seekable ? _videotag.seekable.length : 0;\r\n        var end = 0;\r\n\r\n        while (index--) {\r\n            end = Math.max(end, _videotag.seekable.end(index));\r\n        }\r\n        return end;\r\n    }\r\n\r\n    this.stop = function() {\r\n        clearTimeouts();\r\n        _clearVideotagSource();\r\n        this.clearTracks();\r\n        // IE/Edge continue to play a video after changing video.src and calling video.load()\r\n        // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/5383483/ (not fixed in Edge 14)\r\n        if (Browser.ie) {\r\n            _videotag.pause();\r\n        }\r\n        this.setState(STATE_IDLE);\r\n    };\r\n\r\n    this.destroy = function() {\r\n        _beforeResumeHandler = utils.noop;\r\n        _removeListeners(MediaEvents, _videotag);\r\n        this.removeTracksListener(_videotag.audioTracks, 'change', _audioTrackChangeHandler);\r\n        this.removeTracksListener(_videotag.textTracks, 'change', _this.textTrackChangeHandler);\r\n        this.off();\r\n    };\r\n\r\n    this.init = function(item) {\r\n        _setLevels(item.sources);\r\n        const source = _levels[_currentQuality];\r\n        _androidHls = isAndroidHls(source);        \r\n        if (_androidHls) {\r\n            // Playback rate is broken on Android HLS\r\n            _this.supportsPlaybackRate = false;\r\n        }\r\n        // the loadeddata event determines the mediaType for HLS sources\r\n        if (_levels.length && _levels[0].type !== 'hls') {\r\n            this.sendMediaType(_levels);\r\n        }\r\n        visualQuality.reason = '';\r\n    };\r\n\r\n    this.preload = function(item) {\r\n        _setLevels(item.sources);\r\n        const source = _levels[_currentQuality];\r\n        const preload = source.preload || 'metadata';\r\n        if (preload !== 'none') {\r\n            _setAttribute('preload', preload);\r\n            _setVideotagSource(source);\r\n        }\r\n    };\r\n\r\n    this.load = function(item) {\r\n        _setLevels(item.sources);\r\n        _completeLoad(item.starttime || 0, item.duration || 0);\r\n        this.setupSideloadedTracks(item.tracks);        \r\n    };\r\n\r\n    this.play = function() {\r\n        _beforeResumeHandler();\r\n        return _play();\r\n    };\r\n\r\n    this.pause = function() {\r\n        clearTimeouts();\r\n        _beforeResumeHandler = function() {\r\n            var unpausing = _videotag.paused && _videotag.currentTime;\r\n            if (unpausing && _this.isLive()) {\r\n                var end = _getSeekableEnd();\r\n                var seekableDuration = end - _getSeekableStart();\r\n                var isLiveNotDvr = seekableDuration < MIN_DVR_DURATION;\r\n                var behindLiveEdge = end - _videotag.currentTime;\r\n                if (isLiveNotDvr && end && (behindLiveEdge > 15 || behindLiveEdge < 0)) {\r\n                    // resume playback at edge of live stream\r\n                    _seekOffset = Math.max(end - 10, end - seekableDuration);\r\n                    _setPositionBeforeSeek(_videotag.currentTime);\r\n                    _videotag.currentTime = _seekOffset;\r\n                }\r\n\r\n            }\r\n        };\r\n        _videotag.pause();\r\n    };\r\n\r\n    this.seek = function(seekPos) {\r\n        if (seekPos < 0) {\r\n            seekPos += _getSeekableStart() + _getSeekableEnd();\r\n        }\r\n        if (!_canSeek) {\r\n            _canSeek = !!_getSeekableEnd();\r\n        }\r\n        if (_canSeek) {\r\n            _delayedSeek = 0;\r\n            // setting currentTime can throw an invalid DOM state exception if the video is not ready\r\n            try {\r\n                _this.seeking = true;\r\n                _seekOffset = seekPos;\r\n                _setPositionBeforeSeek(_videotag.currentTime);\r\n                _videotag.currentTime = seekPos;\r\n            } catch (e) {\r\n                _this.seeking = false;\r\n                _delayedSeek = seekPos;\r\n            }\r\n        } else {\r\n            _delayedSeek = seekPos;\r\n            // Firefox isn't firing canplay event when in a paused state\r\n            // https://bugzilla.mozilla.org/show_bug.cgi?id=1194624\r\n            if (Browser.firefox && _videotag.paused) {\r\n                _play();\r\n            }\r\n        }\r\n    };\r\n\r\n    function _audioTrackChangeHandler() {\r\n        var _selectedAudioTrackIndex = -1;\r\n        for (var i = 0; i < _videotag.audioTracks.length; i++) {\r\n            if (_videotag.audioTracks[i].enabled) {\r\n                _selectedAudioTrackIndex = i;\r\n                break;\r\n            }\r\n        }\r\n        _setCurrentAudioTrack(_selectedAudioTrackIndex);\r\n    }\r\n\r\n    function _sendFullscreen(e) {\r\n        _this.trigger('fullscreenchange', {\r\n            target: e.target,\r\n            jwstate: _fullscreenState\r\n        });\r\n    }\r\n\r\n    this.setVisibility = function(state) {\r\n        state = !!state;\r\n        if (state || OS.android) {\r\n            // Changing visibility to hidden on Android < 4.2 causes\r\n            // the pause event to be fired. This causes audio files to\r\n            // become unplayable. Hence the video tag is always kept\r\n            // visible on Android devices.\r\n            style(_this.container, {\r\n                visibility: 'visible',\r\n                opacity: 1\r\n            });\r\n        } else {\r\n            style(_this.container, {\r\n                visibility: '',\r\n                opacity: 0\r\n            });\r\n        }\r\n    };\r\n\r\n    this.resize = function(width, height, stretching) {\r\n        if (!width || !height || !_videotag.videoWidth || !_videotag.videoHeight) {\r\n            return false;\r\n        }\r\n        const styles = {\r\n            objectFit: '',\r\n            width: '',\r\n            height: ''\r\n        };\r\n        if (stretching === 'uniform') {\r\n            // snap video to edges when the difference in aspect ratio is less than 9%\r\n            const playerAspectRatio = width / height;\r\n            const videoAspectRatio = _videotag.videoWidth / _videotag.videoHeight;\r\n            if (Math.abs(playerAspectRatio - videoAspectRatio) < 0.09) {\r\n                styles.objectFit = 'fill';\r\n                stretching = 'exactfit';\r\n            }\r\n        }\r\n        // Prior to iOS 9, object-fit worked poorly\r\n        // object-fit is not implemented in IE or Android Browser in 4.4 and lower\r\n        // http://caniuse.com/#feat=object-fit\r\n        // feature detection may work for IE but not for browsers where object-fit works for images only\r\n        const fitVideoUsingTransforms = Browser.ie || (OS.iOS && OS.version.major < 9) || Browser.androidNative;\r\n        if (fitVideoUsingTransforms) {\r\n            // Use transforms to center and scale video in container\r\n            const x = -Math.floor(_videotag.videoWidth / 2 + 1);\r\n            const y = -Math.floor(_videotag.videoHeight / 2 + 1);\r\n            let scaleX = Math.ceil(width * 100 / _videotag.videoWidth) / 100;\r\n            let scaleY = Math.ceil(height * 100 / _videotag.videoHeight) / 100;\r\n            if (stretching === 'none') {\r\n                scaleX = scaleY = 1;\r\n            } else if (stretching === 'fill') {\r\n                scaleX = scaleY = Math.max(scaleX, scaleY);\r\n            } else if (stretching === 'uniform') {\r\n                scaleX = scaleY = Math.min(scaleX, scaleY);\r\n            }\r\n            styles.width = _videotag.videoWidth;\r\n            styles.height = _videotag.videoHeight;\r\n            styles.top = styles.left = '50%';\r\n            styles.margin = 0;\r\n            transform(_videotag,\r\n                'translate(' + x + 'px, ' + y + 'px) scale(' + scaleX.toFixed(2) + ', ' + scaleY.toFixed(2) + ')');\r\n        }\r\n        style(_videotag, styles);\r\n        return false;\r\n    };\r\n\r\n    this.setFullscreen = function(state) {\r\n        state = !!state;\r\n\r\n        // This implementation is for iOS and Android WebKit only\r\n        // This won't get called if the player container can go fullscreen\r\n        if (state) {\r\n            var status = utils.tryCatch(function() {\r\n                var enterFullscreen =\r\n                    _videotag.webkitEnterFullscreen ||\r\n                    _videotag.webkitEnterFullScreen;\r\n                if (enterFullscreen) {\r\n                    enterFullscreen.apply(_videotag);\r\n                }\r\n\r\n            });\r\n\r\n            if (status instanceof utils.Error) {\r\n                // object can't go fullscreen\r\n                return false;\r\n            }\r\n            return _this.getFullScreen();\r\n        }\r\n\r\n        var exitFullscreen =\r\n            _videotag.webkitExitFullscreen ||\r\n            _videotag.webkitExitFullScreen;\r\n        if (exitFullscreen) {\r\n            exitFullscreen.apply(_videotag);\r\n        }\r\n\r\n        return state;\r\n    };\r\n\r\n    _this.getFullScreen = function() {\r\n        return _fullscreenState || !!_videotag.webkitDisplayingFullscreen;\r\n    };\r\n\r\n    this.setCurrentQuality = function(quality) {\r\n        if (_currentQuality === quality) {\r\n            return;\r\n        }\r\n        if (quality >= 0) {\r\n            if (_levels && _levels.length > quality) {\r\n                _currentQuality = quality;\r\n                visualQuality.reason = 'api';\r\n                visualQuality.level = {};\r\n                this.trigger(MEDIA_LEVEL_CHANGED, {\r\n                    currentQuality: quality,\r\n                    levels: _getPublicLevels(_levels)\r\n                });\r\n\r\n                // The playerConfig is not updated automatically, because it is a clone\r\n                // from when the provider was first initialized\r\n                _playerConfig.qualityLabel = _levels[quality].label;\r\n\r\n                const time = _videotag.currentTime || 0;\r\n                const duration = _this.getDuration();\r\n                _completeLoad(time, duration);\r\n                _play();\r\n            }\r\n        }\r\n    };\r\n\r\n    this.setPlaybackRate = function(playbackRate) {\r\n        // Set defaultPlaybackRate so that we do not send ratechange events when setting src\r\n        _videotag.playbackRate = _videotag.defaultPlaybackRate = playbackRate;\r\n    };\r\n\r\n    this.getPlaybackRate = function() {\r\n        return _videotag.playbackRate;\r\n    };\r\n\r\n    this.getCurrentQuality = function() {\r\n        return _currentQuality;\r\n    };\r\n\r\n    this.getQualityLevels = function() {\r\n        return _.map(_levels, level => qualityLevel(level));\r\n    };\r\n\r\n    this.getName = function() {\r\n        return { name: _name };\r\n    };\r\n    this.setCurrentAudioTrack = _setCurrentAudioTrack;\r\n\r\n    this.getAudioTracks = _getAudioTracks;\r\n\r\n    this.getCurrentAudioTrack = _getCurrentAudioTrack;\r\n\r\n    function _setAudioTracks(tracks) {\r\n        _audioTracks = null;\r\n        if (!tracks) {\r\n            return;\r\n        }\r\n        if (tracks.length) {\r\n            for (var i = 0; i < tracks.length; i++) {\r\n                if (tracks[i].enabled) {\r\n                    _currentAudioTrackIndex = i;\r\n                    break;\r\n                }\r\n            }\r\n            if (_currentAudioTrackIndex === -1) {\r\n                _currentAudioTrackIndex = 0;\r\n                tracks[_currentAudioTrackIndex].enabled = true;\r\n            }\r\n            _audioTracks = _.map(tracks, function(track) {\r\n                var _track = {\r\n                    name: track.label || track.language,\r\n                    language: track.language\r\n                };\r\n                return _track;\r\n            });\r\n        }\r\n        _this.addTracksListener(tracks, 'change', _audioTrackChangeHandler);\r\n        if (_audioTracks) {\r\n            _this.trigger('audioTracks', { currentTrack: _currentAudioTrackIndex, tracks: _audioTracks });\r\n        }\r\n    }\r\n\r\n    function _setCurrentAudioTrack(index) {\r\n        if (_videotag && _videotag.audioTracks && _audioTracks &&\r\n            index > -1 && index < _videotag.audioTracks.length && index !== _currentAudioTrackIndex) {\r\n            _videotag.audioTracks[_currentAudioTrackIndex].enabled = false;\r\n            _currentAudioTrackIndex = index;\r\n            _videotag.audioTracks[_currentAudioTrackIndex].enabled = true;\r\n            _this.trigger('audioTrackChanged', { currentTrack: _currentAudioTrackIndex,\r\n                tracks: _audioTracks });\r\n        }\r\n    }\r\n\r\n    function _getAudioTracks() {\r\n        return _audioTracks || [];\r\n    }\r\n\r\n    function _getCurrentAudioTrack() {\r\n        return _currentAudioTrackIndex;\r\n    }\r\n\r\n    function _setMediaType() {\r\n        // Send mediaType when format is HLS. Other types are handled earlier by default.js.\r\n        if (_levels[0].type === 'hls') {\r\n            var mediaType = 'video';\r\n            if (_videotag.videoHeight === 0) {\r\n                mediaType = 'audio';\r\n            }\r\n            _this.trigger('mediaType', { mediaType: mediaType });\r\n        }\r\n    }\r\n\r\n    // If we're live and the buffer end has remained the same for some time, mark the stream as stale and check if the stream is over\r\n    function checkStaleStream() {\r\n        var endOfBuffer = endOfRange(_videotag.buffered);\r\n        var live = _this.isLive();\r\n\r\n        // Don't end if we have noting buffered yet, or cannot get any information about the buffer\r\n        if (live && endOfBuffer && _lastEndOfBuffer === endOfBuffer) {\r\n            if (_staleStreamTimeout === -1) {\r\n                _staleStreamTimeout = setTimeout(function () {\r\n                    _stale = true;\r\n                    checkStreamEnded();\r\n                }, _staleStreamDuration);\r\n            }\r\n        } else {\r\n            clearTimeouts();\r\n            _stale = false;\r\n        }\r\n\r\n        _lastEndOfBuffer = endOfBuffer;\r\n    }\r\n\r\n    function checkStreamEnded() {\r\n        if (_stale && _this.atEdgeOfLiveStream()) {\r\n            _this.trigger(MEDIA_ERROR, {\r\n                message: 'The live stream is either down or has ended'\r\n            });\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    function clearTimeouts() {\r\n        clearTimeout(_staleStreamTimeout);\r\n        _staleStreamTimeout = -1;\r\n    }\r\n}\r\n\r\nObject.assign(VideoProvider.prototype, DefaultProvider);\r\n\r\nVideoProvider.getName = function() {\r\n    return { name: 'html5' };\r\n};\r\n\r\nexport default VideoProvider;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/providers/html5.js"],"sourceRoot":""}